----bd_day租户脚本----
DROP TABLE IF EXISTS NG3.TW_PERS_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_USR_D (
   USR_NBR    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   NET_TYP    STRING,
   BRND_CD    SMALLINT,
   USR_NAM    STRING,
   BASS_PRDCT_CD    STRING,
   INNET_TYP    STRING,
   MOB_USE_TYP_CD    STRING,
   OWE_CHNL_CD    STRING,
   START_DT    INT,
   USR_TYP    STRING,
   PAY_TYP_CD    STRING,
   OWE_STOP_IND    STRING,
   FORCE_STOP_IND    STRING,
   HIGH_STOP_IND    STRING,
   APPLY_STOP_IND    STRING,
   LOST_STOP_IND    STRING,
   EFF_STOP_IND    STRING,
   USR_STS_CD    STRING,
   USR_STS_DT    INT,
   USR_STS_TIM    STRING,
   CUST_CHG_DT    INT,
   USR_OUTNET_DT    INT,
   CMCC_BRANCH_CD    STRING,
   PKG_CD    SMALLINT,
   IUSR_TYP_CD    INT,
   UPDT_DT    INT,
   OSS_NAM    STRING,
   NEW_USR_IND    STRING,
   MON_NEW_USR_IND    STRING,
   INNET_USR_IND    STRING,
   IMEI    STRING,
   SETL_DT    INT,
   IMSI    STRING,
   SIM_CD    STRING,
   START_TIM    STRING,
   REG_DT    INT
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TS_PERS_USR_D;
CREATE EXTERNAL TABLE NG3.TS_PERS_USR_D (
   USR_NBR    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   NET_TYP    STRING,
   BRND_CD    SMALLINT,
   USR_NAM    STRING,
   BASS_PRDCT_CD    STRING,
   INNET_TYP    STRING,
   MOB_USE_TYP_CD    STRING,
   OWE_CHNL_CD    STRING,
   START_DT    INT,
   USR_TYP    STRING,
   PAY_TYP_CD    STRING,
   OWE_STOP_IND    STRING,
   FORCE_STOP_IND    STRING,
   HIGH_STOP_IND    STRING,
   APPLY_STOP_IND    STRING,
   LOST_STOP_IND    STRING,
   EFF_STOP_IND    STRING,
   USR_STS_CD    STRING,
   USR_STS_DT    INT,
   USR_STS_TIM    STRING,
   CUST_CHG_DT    INT,
   USR_OUTNET_DT    INT,
   CMCC_BRANCH_CD    STRING,
   PKG_CD    SMALLINT,
   IUSR_TYP_CD    INT,
   UPDT_DT    INT,
   OSS_NAM    STRING,
   NEW_USR_IND    STRING,
   MON_NEW_USR_IND    STRING,
   INNET_USR_IND    STRING,
   IMEI    STRING,
   SETL_DT    INT,
   IMSI    STRING,
   SIM_CD    STRING,
   START_TIM    STRING,
   REG_DT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_USR_PKG_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_USR_PKG_D (
   USR_NBR    STRING,
   PKG_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   USR_ID    STRING,
   UPDT_DT    INT,
   PKG_DTL_CD    INT,
   ORDER_BRND_CD    SMALLINT,
   ORDER_PKG_CD    SMALLINT,
   ORDER_PKG_DTL_CD    INT,
   N_BASS_PRDCT_CD    STRING,
   ORDER_BASS_PRDCT_CD    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TS_PERS_USR_PKG_D;
CREATE EXTERNAL TABLE NG3.TS_PERS_USR_PKG_D (
   USR_NBR    STRING,
   PKG_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   USR_ID    STRING,
   UPDT_DT    INT,
   PKG_DTL_CD    INT,
   ORDER_BRND_CD    SMALLINT,
   ORDER_PKG_CD    SMALLINT,
   ORDER_PKG_DTL_CD    INT,
   N_BASS_PRDCT_CD    STRING,
   ORDER_BASS_PRDCT_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TO_PERS_USIM_D;
CREATE EXTERNAL TABLE NG3.TO_PERS_USIM_D (
   USR_NBR    STRING,
   USIM_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   STRT_DT    INT,
   STRT_TM    STRING,
   STOP_DT    INT,
   STOP_TM    STRING,
   BOSS_CHNL_CD    STRING,
   OPER_CD    STRING,
   SIMCRD_TYP    STRING,
   USIM_USE_STS    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TS_PERS_USIM_D;
CREATE EXTERNAL TABLE NG3.TS_PERS_USIM_D (
   USR_NBR    STRING,
   USIM_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   STRT_DT    INT,
   STRT_TM    STRING,
   STOP_DT    INT,
   STOP_TM    STRING,
   BOSS_CHNL_CD    STRING,
   OPER_CD    STRING,
   SIMCRD_TYP    STRING,
   USIM_USE_STS    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_USR_BAL_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_USR_BAL_D (
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   USR_ID    STRING,
   BRND_CD    SMALLINT,
   USR_STS_CD    STRING,
   BASE_ACCT_AMT    DECIMAL(16,2),
   GIFT_ACCT_AMT    DECIMAL(16,2),
   AVL_TOT_ACCT_AMT    DECIMAL(16,2),
   PRE_NEFF_ACCT_AMT    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT    DECIMAL(16,2),
   TOT_ACCT_AMT    DECIMAL(16,2),
   MO_RTN_AMT    DECIMAL(16,2),
   MO_GIFT_AMT    DECIMAL(16,2),
   OSS_NAM    STRING,
   NEFF_GIFT_BAL_MAX_RTN_DT    INT,
   NEFF_BASE_BAL_MAX_RTN_DT    INT,
   STAT_DT    INT,
   BASE_NEFF_ACCT_AMT1    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT2    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT3    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT4    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT5    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT6    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT7    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT8    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT9    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT10    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT11    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT12    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT_UP12    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT1    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT2    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT3    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT4    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT5    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT6    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT7    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT8    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT9    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT10    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT11    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT12    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT_UP12    DECIMAL(16,2),
   BASE_CASH_ACCT_AMT    DECIMAL(16,2),
   BASE_CARD_ACCT_AMT    DECIMAL(16,2),
   BASE_PRINCIPAL_ACCT_AMT    DECIMAL(16,2),
   BASE_OFFSET_ACCT_AMT    DECIMAL(16,2),
   BASE_BOND_ACCT_AMT    DECIMAL(16,2),
   GIFT_GENERAL_ACCT_AMT    DECIMAL(16,2),
   GIFT_NB_ACCT_AMT    DECIMAL(16,2),
   GIFT_LABOR_ACCT_AMT    DECIMAL(16,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_OUTNET_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_OUTNET_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PKG_CD    INT,
   QUIT_IND    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   START_DT    INT,
   BASS_PRDCT_CD    STRING,
   MOB_USE_TYP_CD    STRING,
   OWE_CHNL_CD    STRING,
   OSS_NAM    STRING,
   PKG_DTL_CD    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USR_OTH_PAY_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_OTH_PAY_DAY (
   STAT_DT    INT,
   USR_MOB_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   A_BRND_CD    SMALLINT,
   DF_FEE    DECIMAL(16,3),
   MODF_FN_FEE    DECIMAL(16,3),
   WLAN_TIME_CARD_FEE    DECIMAL(16,3),
   DNT_FEE    DECIMAL(16,3),
   GLB_BOTTOM_FEE    DECIMAL(16,3),
   FORCE_BOTTOM_FEE    DECIMAL(16,3),
   TOP_FEE    DECIMAL(16,3),
   DISC_FEE    DECIMAL(16,3),
   GIFT_FEE    DECIMAL(16,3),
   WAP172_FEE    DECIMAL(16,3)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USR_DF_PAY_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_DF_PAY_DAY (
   STAT_DT    INT,
   USR_MOB_NBR    STRING,
   B_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   A_BRND_CD    SMALLINT,
   B_CMCC_BRANCH_CD    STRING,
   B_BRND_CD    SMALLINT,
   DF_FEE    DECIMAL(16,3),
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USR_PRDCT_FIXFEE_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_PRDCT_FIXFEE_DAY (
   STAT_DT    INT,
   USR_MOB_NBR    STRING,
   BILL_ACCT_CD    STRING,
   BASS_PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   A_BRND_CD    SMALLINT,
   FIX_FEE    DECIMAL(16,3)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USR_PRDCT_VOC_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_PRDCT_VOC_DAY (
   STAT_DT    INT,
   USR_MOB_NBR    STRING,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   CMCC_BRANCH_CD    STRING,
   A_BRND_CD    SMALLINT,
   LLO_MOB_DUR    INT,
   LPO_MOB_DUR    INT,
   LGO_MOB_DUR    INT,
   LIO_MOB_DUR    INT,
   LLT_MOB_DUR    INT,
   LPT_MOB_DUR    INT,
   LGT_MOB_DUR    INT,
   LIT_MOB_DUR    INT,
   PO_MOB_DUR    INT,
   PT_MOB_DUR    INT,
   GO_MOB_DUR    INT,
   GT_MOB_DUR    INT,
   IO_MOB_DUR    INT,
   IT_MOB_DUR    INT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT,
   DISC_MOB_FEE    DECIMAL(16,3),
   DISC_TOLL_FEE    DECIMAL(8,3),
   DISC_INF_FEE    DECIMAL(16,3)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USR_PRDCT_WLAN_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_PRDCT_WLAN_DAY (
   STAT_DT    INT,
   USR_MOB_NBR    STRING,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   CMCC_BRANCH_CD    STRING,
   A_BRND_CD    SMALLINT,
   WLAN_TOT_DUR    INT,
   DUR_RAT_DUR    INT,
   FLUX_RAT_DUR    INT,
   WLAN_TOT_FLUX    BIGINT,
   DUR_RAT_FLUX    BIGINT,
   FLUX_RAT_FLUX    BIGINT,
   WLAN_PHONE_DUR    INT,
   WLAN_CARD_DUR    INT,
   WLAN_COLLG_DUR    INT,
   WLAN_E_CARD_DUR    INT,
   WLAN_AUTO_AUTH_DUR    INT,
   WLAN_PHONE_FLUX    BIGINT,
   WLAN_CARD_FLUX    BIGINT,
   WLAN_COLLG_FLUX    BIGINT,
   WLAN_E_CARD_FLUX    BIGINT,
   WLAN_AUTO_AUTH_FLUX    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT,
   DISC_MOB_FEE    DECIMAL(16,3),
   DISC_TOLL_FEE    DECIMAL(16,3),
   DISC_INF_FEE    DECIMAL(16,3)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USR_PRDCT_GPRS_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_PRDCT_GPRS_DAY (
   STAT_DT    INT,
   USR_MOB_NBR    STRING,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   CMCC_BRANCH_CD    STRING,
   A_BRND_CD    SMALLINT,
   IPRVC_NTD_FLUX    BIGINT,
   IPRVC_TD_FLUX    BIGINT,
   IPRVC_TDLTE_FLUX    BIGINT,
   OUTPRVC_NTD_FLUX    BIGINT,
   OUTPRVC_TD_FLUX    BIGINT,
   OUTPRVC_TDLTE_FLUX    BIGINT,
   INTNTL_NTD_FLUX    BIGINT,
   INTNTL_TD_FLUX    BIGINT,
   INTNTL_TDLTE_FLUX    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT,
   DISC_MOB_FEE    DECIMAL(16,3),
   DISC_TOLL_FEE    DECIMAL(16,3),
   DISC_INF_FEE    DECIMAL(16,3)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CDR_USR_GPRS_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_CDR_USR_GPRS_BUSI_D (
   DEBET_DT    INT,
   CALL_DT    INT,
   USR_NBR    STRING,
   EVENT_FORMAT_YTP_CD    STRING,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_TYP_CD    STRING,
   CALL_AREA_CD    STRING,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   XD_TYP_CD    STRING,
   RESERVE    STRING,
   RESERVE2    STRING,
   RESERVE3    STRING,
   DUR_VOL_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   EVENT_TYP_CD    STRING,
   SPECIAL_TYP_CD    STRING,
   FILE_TYP    STRING,
   IMEI    STRING,
   NET_TYP_CD    STRING,
   A_USR_TYP_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOB_FEE    DECIMAL(16,3),
   TOLL_FEE    DECIMAL(16,3),
   INF_FEE    DECIMAL(16,3),
   CALL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   UP_CALL_FLUX    BIGINT,
   DOWN_CALL_FLUX    BIGINT,
   INTR_UP_FLUX    BIGINT,
   INTR_DOWN_FLUX    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_CDR_USR_WLAN_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_CDR_USR_WLAN_BUSI_D (
   DEBET_DT    INT,
   CALL_DT    INT,
   USR_NBR    STRING,
   EVENT_FORMAT_YTP_CD    STRING,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_TYP_CD    STRING,
   CALL_AREA_CD    STRING,
   FILE_TYP    STRING,
   CDR_SRC_CD    SMALLINT,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   XD_TYP_CD    STRING,
   RESERVE    STRING,
   RESERVE2    STRING,
   RESERVE3    STRING,
   DUR_VOL_TYP_CD    STRING,
   CDR_ROAM_TYP_CD    STRING,
   NAS_ID    STRING,
   NAS_PORT_ID    STRING,
   AUTH_TYP_CD    STRING,
   BUSI_FLAG    STRING,
   TERM_TYP_CD    STRING,
   TERM_OS_TYP    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOB_FEE    DECIMAL(16,3),
   TOLL_FEE    DECIMAL(16,3),
   INF_FEE    DECIMAL(16,3),
   CALL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   UP_CALL_FLUX    BIGINT,
   DOWN_CALL_FLUX    BIGINT,
   INTR_UP_FLUX    BIGINT,
   INTR_DOWN_FLUX    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CDR_USRCALL_D;
CREATE EXTERNAL TABLE NG3.TW_CDR_USRCALL_D (
   DEBET_DT    INT,
   CALL_DT    INT,
   USR_NBR    STRING,
   EVENT_FORMAT_YTP_CD    STRING,
   XD_TYP_CD    STRING,
   FREE_IND    STRING,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_TYP_CD    STRING,
   BILL_ACCT_CD    STRING,
   RATE_TYP_CD    STRING,
   CARRY_TYP_CD    STRING,
   ICP_STAT_CD    STRING,
   SPECIAL_TYP_CD    STRING,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   TOLL_TYP_CD    SMALLINT,
   CALL_AREA_CD    STRING,
   FILE_TYP    STRING,
   NET_TYP_CD    STRING,
   A_USR_TYP_CD    STRING,
   VPMN_IND    STRING,
   B_AREA_CD    STRING,
   B_BRND_CD    SMALLINT,
   B_OPER_CD    STRING,
   B_USR_TYP_CD    STRING,
   CNCT_NBR    STRING,
   IMEI    STRING,
   RESERVE    STRING,
   RESERVE3    STRING,
   DUR_VOL_TYP_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOB_FEE    DECIMAL(16,3),
   TOLL_FEE    DECIMAL(16,3),
   INF_FEE    DECIMAL(16,3),
   CALL_DUR    BIGINT,
   DEBET_TOLL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   UP_CALL_FLUX    BIGINT,
   DOWN_CALL_FLUX    BIGINT,
   INTR_UP_FLUX    BIGINT,
   INTR_DOWN_FLUX    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT,
   CDR_CNT    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_CDR_USR_VOC_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_CDR_USR_VOC_BUSI_D (
   DEBET_DT    INT,
   CALL_DT    INT,
   USR_NBR    STRING,
   EVENT_FORMAT_YTP_CD    STRING,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_TYP_CD    STRING,
   CALL_AREA_CD    STRING,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   XD_TYP_CD    STRING,
   RESERVE    STRING,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   TOLL_TYP_CD    SMALLINT,
   EVENT_TYP_CD    STRING,
   FILE_TYP    STRING,
   REL_TYP_CD    STRING,
   NET_TYP_CD    STRING,
   CDR_CALL_TYP_CD    STRING,
   IMEI    STRING,
   CNCT_NBR    STRING,
   VPMN_IND    STRING,
   B_OPER_CD    STRING,
   B_BRND_CD    SMALLINT,
   B_USR_TYP_CD    STRING,
   B_AREA_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOB_FEE    DECIMAL(16,3),
   TOLL_FEE    DECIMAL(16,3),
   INF_FEE    DECIMAL(16,3),
   CALL_DUR    BIGINT,
   DEBET_TOLL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CHNL_INF_D;
CREATE EXTERNAL TABLE NG3.TW_CHNL_INF_D (
   CHNL_CD    STRING,
   UNIQUE_CHNL_CD    STRING,
   PROVINCE_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   CMCC_CNTY_CD    STRING,
   SECTION    STRING,
   TOWN    STRING,
   CHNL_NAM    STRING,
   CHNL_ADR_NAM    STRING,
   CHNL_CNTCT_NAM    STRING,
   CNTCT_TEL_NBR    STRING,
   CHNL_TYP_CD    STRING,
   CHNL_SUBTYP_CD    STRING,
   BI_CHNL_TYP_CD    SMALLINT,
   BI_CHNL_SUBTYP_CD    SMALLINT,
   RUN_MOD    SMALLINT,
   IS_EXC    SMALLINT,
   ADR_TYP_CD    SMALLINT,
   BUZ_TYP_CD    SMALLINT,
   CHNL_RUNSTS_CD    SMALLINT,
   ET_TYP_CD    SMALLINT,
   IF_MOBILEMALL    SMALLINT,
   PRT_SOURCE    SMALLINT,
   STAR_LVL_CD    SMALLINT,
   CATE_ATTR    SMALLINT,
   CNSTR_STOP_DT    INT,
   HOUSE_ID    STRING,
   LAND_ID    STRING,
   BUS_ENROL_ID    STRING,
   CNSTR_COST    DECIMAL(14,2),
   RENT_START_DT    INT,
   RENT_END_DT    INT,
   AVG_RENT_FEE    DECIMAL(14,2),
   CNSTR_AREA    DECIMAL(10,2),
   USE_AREA    DECIMAL(10,2),
   FRONT_AREA    DECIMAL(10,2),
   SEAT_CNT    INT,
   EMP_NUM    INT,
   SECU_NUM    INT,
   CLEAN_NUM    INT,
   HAS_WAITMACH    SMALLINT,
   HAS_POSMACH    SMALLINT,
   HAS_24MALL    SMALLINT,
   HAS_VIP_SEAT    SMALLINT,
   HAS_VIP_ROOM    SMALLINT,
   PRINTER_NUM    INT,
   SH_NUM    INT,
   G3_AREA    DECIMAL(16,2),
   TV_NUM    INT,
   NEW_OPER_MALL_NUM    INT,
   THINK_MALL_NUM    INT,
   NET_MALL_NUM    INT,
   STOREFRONY_AREA    DECIMAL(16,2),
   GMCC_AREA    DECIMAL(16,2),
   ISP_CONNECT_TYP    SMALLINT,
   IS_KZCZ    SMALLINT,
   FIX_TOTAL_FEE    DECIMAL(16,2),
   EQUIP_TOTAL_FEE    DECIMAL(16,2),
   FITMENT_FEE    DECIMAL(16,2),
   BUSI_START_TIME    STRING,
   BUSI_END_TIME    STRING,
   LONGITUDE    DECIMAL(10,5),
   LATITUDE    DECIMAL(10,5),
   FRIEND_CHNL_CD    STRING,
   IS_TIETONG    SMALLINT,
   COMPACT_BEGIN_DT    INT,
   COMPACT_END_DT    INT,
   CLAC_MONTH    INT,
   UPDT_DT    INT,
   CHK_CD    STRING,
   TOP_CD    STRING,
   OPR_DT    INT,
   OPR_TIM    STRING,
   CHAIN_HEAD_CD    STRING,
   BOSS_CHNL_CD    STRING,
   SUB_RUN_MOD    INT,
   CMOP_CNTY_CD    STRING,
   DATA_SOURCE    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_TERM_IMEI_SEQ_D;
CREATE EXTERNAL TABLE NG3.TW_TERM_IMEI_SEQ_D (
   USR_NBR    STRING,
   IMEI    STRING,
   EFF_DT    INT,
   EFF_TM    STRING,
   INVALID_DT    INT,
   INVALID_TM    STRING,
   STS_IND    STRING,
   CMCC_BRANCH_CD    STRING,
   TAC    STRING,
   CM_DEBET_DUR    INT,
   CM_CALL_CNT    INT,
   CM_TOT_FEE    DECIMAL(16,2),
   LAST_CALL_DT    INT,
   LAST_CALL_TM    STRING,
   CM_GPRS_FLUX    BIGINT,
   FRST_EFF_DT    INT
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_USR_NBUSE_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_NBUSE_DAY (
   TM_INTRVL_CD    INT,
   USR_NBR    STRING,
   NEW_BUSI_CD    INT,
   CO_TYP_CD    INT,
   DIR_TYP_CD    STRING,
   SP_CODE    STRING,
   SP_SERV_CD    STRING,
   SP_SUBBUSI_CD    STRING,
   SP_BUSICLASS_CD    STRING,
   TAOCAN_IND    STRING,
   CALL_AREA_CD    STRING,
   B_OPER_CD    STRING,
   B_AREA_CD    STRING,
   NET_TYP_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   BASE_DAY_RENT    DECIMAL(7,2),
   BASE_MONTH_RENT    DECIMAL(10,2),
   MOB_FEE    DECIMAL(10,2),
   TOLL_FEE    DECIMAL(10,2),
   PER_INF_FEE    DECIMAL(10,2),
   MON_INF_FEE    DECIMAL(10,2),
   CALL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   GPRS_FLUX    BIGINT,
   MMS_GPRS_FLUX    BIGINT,
   DEBT1_DAY_RENT    DECIMAL(7,2),
   DEBT1_MONTH_RENT    DECIMAL(10,2),
   DEBT1_MOB_FEE    DECIMAL(10,2),
   DEBT1_TOLL_FEE    DECIMAL(10,2),
   DEBT1_PER_INF_FEE    DECIMAL(10,2),
   DEBT1_MON_INF_FEE    DECIMAL(10,2),
   PKG_CD    SMALLINT,
   CDR_CNT    INT,
   IS_SMS_TAOCAN_USR    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_BUSI_FEE_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_BUSI_FEE_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ACTV_IND    STRING,
   LLO_MOB_DUR    INT,
   LPO_MOB_DUR    INT,
   LGO_MOB_DUR    INT,
   LIO_MOB_DUR    INT,
   LLT_MOB_DUR    INT,
   LPT_MOB_DUR    INT,
   LGT_MOB_DUR    INT,
   LIT_MOB_DUR    INT,
   PO_MOB_DUR    INT,
   PT_MOB_DUR    INT,
   GO_MOB_DUR    INT,
   GT_MOB_DUR    INT,
   IO_MOB_DUR    INT,
   IT_MOB_DUR    INT,
   L_GPRS_FLUX    BIGINT,
   P_GPRS_FLUX    INT,
   G_GPRS_FLUX    INT,
   SMS_UP_CNT    INT,
   MMS_UP_CNT    INT,
   V_MOB_DUR    INT,
   LLO_FEE    DECIMAL(10,2),
   LPO_FEE    DECIMAL(10,2),
   LGO_FEE    DECIMAL(10,2),
   LIO_FEE    DECIMAL(10,2),
   LLT_FEE    DECIMAL(10,2),
   LPT_FEE    DECIMAL(10,2),
   LGT_FEE    DECIMAL(10,2),
   LIT_FEE    DECIMAL(10,2),
   PO_FEE    DECIMAL(10,2),
   PT_FEE    DECIMAL(10,2),
   GO_FEE    DECIMAL(10,2),
   GT_FEE    DECIMAL(10,2),
   IO_FEE    DECIMAL(10,2),
   IT_FEE    DECIMAL(10,2),
   L_GPRS_FEE    DECIMAL(10,2),
   P_GPRS_FEE    DECIMAL(10,2),
   G_GPRS_FEE    DECIMAL(10,2),
   SMS_FEE    DECIMAL(10,2),
   MMS_FEE    DECIMAL(10,2),
   V_CALL_FEE    DECIMAL(10,2),
   GSM_GPRS_FLUX    BIGINT,
   T_GPRS_FLUX    INT,
   TDLTE_GPRS_FLUX    BIGINT,
   GSM_ACTV_MOB_DUR    INT,
   GSM_BYCALL_MOB_DUR    INT,
   T_ACTV_MOB_DUR    INT,
   T_BYCALL_MOB_DUR    INT,
   AMT_FEE    DECIMAL(10,2),
   FIX_FEE    DECIMAL(10,2),
   NB_L_GPRS_FLUX    INT,
   NB_P_GPRS_FLUX    INT,
   NB_G_GPRS_FLUX    INT,
   NB_L_GPRS_FEE    DECIMAL(10,2),
   NB_P_GPRS_FEE    DECIMAL(10,2),
   NB_G_GPRS_FEE    DECIMAL(10,2),
   NB_TD_GPRS_FLUX    INT,
   NB_GSM_GPRS_FLUX    INT,
   SMS_DOWN_CNT    INT,
   ACTVCALL_CNT    INT,
   BYCALL_CNT    INT,
   YJ_ACTV_CMNCT_IND    STRING,
   YJ_ACTVCALL_CNT    INT,
   YJ_MOB_DUR    INT,
   YJ_SMS_CNT    INT,
   ACTV_FREE_DEBET_DUR    INT,
   LACTV_FREE_DEBET_DUR    INT,
   PACTV_FREE_DEBET_DUR    INT,
   GACTV_FREE_DEBET_DUR    INT,
   VOC_CDR_FEE    DECIMAL(10,2),
   NORM_VOC_CDR_FEE    DECIMAL(10,2),
   ACTVCALL_FEE    DECIMAL(10,2),
   BYCALL_FEE    DECIMAL(10,2),
   INPKG_DEBET_DUR    INT,
   OUTPKG_DEBET_DUR    INT,
   INPKG_CALL_CNT    INT,
   OUTPKG_CALL_CNT    INT,
   WLAN_FLUX    BIGINT,
   ACTV_CMNCT_IND    STRING,
   MWSMS_UP_CNT    INT,
   MWMMS_UP_CNT    INT,
   NFREE_SMS_UP_CNT    INT,
   NFREE_MMS_UP_CNT    INT,
   NFREE_MWSMS_UP_CNT    INT,
   NFREE_MWMMS_UP_CNT    INT,
   NFREE_ACTVCALL_CNT    INT,
   BACK_FEE    DECIMAL(14,2),
   GPRS_UP_FLUX    INT,
   GPRS_DOWN_FLUX    INT,
   ACT_CMNCT_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_BNDCARD_ORDER_REL_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_BNDCARD_ORDER_REL_D (
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   CHG_DT    INT,
   ORDER_CMPT_DT    INT,
   CHNL_CD    STRING,
   CHNL_TYP    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USRCALL_STICK_DAY;
CREATE EXTERNAL TABLE NG3.TW_USRCALL_STICK_DAY (
   TM_INTRVL_CD    INT,
   USR_MOB_NBR    STRING,
   B_NBR    STRING,
   HR_CD    SMALLINT,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   BILL_TYP_CD    STRING,
   CARRY_TYP_CD    STRING,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   B_AREA_CD    STRING,
   B_OPER_CD    STRING,
   B_BRND_CD    SMALLINT,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   CALL_CNT    BIGINT,
   DEBET_DUR    INT,
   MOB_FEE    DECIMAL(10,2),
   TOLL_FEE    DECIMAL(10,2),
   INF_FEE    DECIMAL(10,2),
   CALL_DUR    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_FAMHOME_VNL_CALL_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_FAMHOME_VNL_CALL_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   VNL_ACTCALL_DEBET_DUR    INT,
   VNL_BYCALL_DEBET_DUR    INT,
   VNL_ACTCALL_CNT    INT,
   VNL_BYCALL_CNT    INT,
   VNL_LACTCALL_DEBET_DUR    INT,
   VNL_IPACTCALL_DEBET_DUR    INT,
   VNL_OPACTCALL_DEBET_DUR    INT,
   VNL_LBYCALL_DEBET_DUR    INT,
   VNL_IPBYCALL_DEBET_DUR    INT,
   VNL_OPBYCALL_DEBET_DUR    INT,
   VNL_ALLOP_CALL_DUR    INT,
   VNL_ALLOP_CALL_CNT    INT,
   VNL_LACTCALL_CNT    INT,
   VNL_LBYCALL_CNT    INT,
   VNL_IPACTCALL_CNT    INT,
   VNL_IPBYCALL_CNT    INT,
   VNL_OPACTCALL_CNT    INT,
   VNL_OPBYCALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_FAMHOME_MBR_INF_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_FAMHOME_MBR_INF_D (
   SUB_NBR    STRING,
   MASTER_NBR    STRING,
   SHORT_NBR    STRING,
   SUB_SHORT_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   SUB_CMCC_BRANCH_CD    STRING,
   SUB_BRND_CD    SMALLINT,
   ADD_DT    INT,
   SUB_STS_CD    SMALLINT,
   DEL_DT    INT,
   SUB_BASS_PRDCT_CD    STRING,
   SUB_PKG_CD    SMALLINT,
   NEW_ADD_IND    STRING,
   SHORT_NBR_TYP    SMALLINT,
   CMPT_USR_IND    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TS_PERS_FAMHOME_MBR_INF_D;
CREATE EXTERNAL TABLE NG3.TS_PERS_FAMHOME_MBR_INF_D (
   SUB_NBR    STRING,
   MASTER_NBR    STRING,
   SHORT_NBR    STRING,
   SUB_SHORT_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   SUB_CMCC_BRANCH_CD    STRING,
   SUB_BRND_CD    SMALLINT,
   ADD_DT    INT,
   SUB_STS_CD    SMALLINT,
   DEL_DT    INT,
   SUB_BASS_PRDCT_CD    STRING,
   SUB_PKG_CD    SMALLINT,
   NEW_ADD_IND    STRING,
   SHORT_NBR_TYP    SMALLINT,
   CMPT_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_FAMHOME_INF_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_FAMHOME_INF_D (
   MASTER_NBR    STRING,
   SHORT_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    INT,
   REG_DT    INT,
   STS_CD    SMALLINT,
   INVALID_DT    INT,
   BASS_PRDCT_CD    STRING,
   PKG_CD    SMALLINT,
   SHORT_NBR_TYP    SMALLINT,
   FEE_TYP_CD    SMALLINT,
   PAY_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_4G_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_4G_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   IMEI    STRING,
   TERM_TYP_CD    SMALLINT,
   TERM_KIND    SMALLINT,
   A4G_TERM_USR_IND    STRING,
   A4G_NET_USE_IND    STRING,
   A4G_USR_IND    STRING,
   A4G_KPI_USR_IND    STRING,
   A2G_NET_USE_IND    STRING,
   A3G_NET_USE_IND    STRING,
   USR_TYP_CD    SMALLINT,
   TERM_BRND_NAM    STRING,
   TERM_DEVICE_NAM    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_4G_USR_BUSI_ATTR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_4G_USR_BUSI_ATTR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   COMMON_IMEI    STRING,
   A4G_BRND_PRDCT_CD    STRING,
   A4G_PRDCT_CD    STRING,
   USE_USIM_IND    STRING,
   OPEN_4G_FUNC_IND    STRING,
   A4G_PKG_USR_IND    STRING,
   A4G_POTENTIAL_USR_IND    STRING,
   A4G_PHONE_PKG_USR_IND    STRING,
   A4G_MIXPKG_USR_IND    STRING,
   A4G_BZ20_USR_IND    STRING,
   A4G_DZ30_USR_IND    STRING,
   A4G_58_MIXPKG_USR_IND    STRING,
   A4G_LLW_USR_IND    STRING,
   A4G_DZK_USR_IND    STRING,
   A4G_WIFI_USR_IND    STRING,
   A4G_MNEW_PKG_USR_IND    STRING,
   EFF_DT    INT,
   CHA_USIM_DT    INT,
   ORDR_N_USR_IND    STRING,
   ORDR_N_BASS_PRDCT_CD    STRING,
   ORDR_N_NEW_CHNL_CD    STRING,
   ORDR_N_HANDLE_TIM    STRING,
   CMCC_BRANCH_CD    STRING,
   CHG_USIM_CHNL_CD    STRING,
   USIMCRD_TYP    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_TERM_SELL_STS_D;
CREATE EXTERNAL TABLE NG3.TW_TERM_SELL_STS_D (
   IMEI    STRING,
   SELL_STS_CD    SMALLINT,
   SELL_STS_DT    INT,
   SELL_STS_TIM    STRING,
   TRML_PRDCT_ID    STRING,
   HALL_CD    STRING,
   PLAT_CD    STRING,
   SELL_KIND    STRING,
   ACT_SELL_PRC    DECIMAL(12,2),
   TRML_PROTO_PRC    DECIMAL(12,2),
   MARK_PLAN_CD    STRING,
   MARK_MOB_NBR    STRING,
   BIND_MOB_NBR    STRING,
   PRESENT_MOB_NBR    STRING,
   STAT_DT    INT,
   IMEI_TYP_CD    STRING,
   ECHNL_TYP_CD    SMALLINT,
   DS_CD    SMALLINT,
   SUB_IMEI    STRING,
   SUB_BIND_MOB_NBR    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_GPRS_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_GPRS_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   GPRS_NEW_USR_IND    STRING,
   GPRS_USE_USR_IND    STRING,
   GPRS_PAY_USR_IND    STRING,
   GPRS_UP_FLUX    BIGINT,
   GPRS_DOWN_FLUX    BIGINT,
   GPRS_TD_FLUX    BIGINT,
   TDLTE_GPRS_FLUX    BIGINT,
   GPRS_NTD_FLUX    BIGINT,
   LOC_CMPWAP_FLUX    BIGINT,
   IPRVC_CMWAP_FLUX    BIGINT,
   OPRVC_CMWAP_FLUX    BIGINT,
   CMWAP_FLUX    BIGINT,
   LOC_CMNET_FLUX    BIGINT,
   IPRVC_CMNET_FLUX    BIGINT,
   OPRVC_CMNET_FLUX    BIGINT,
   CMNET_FLUX    BIGINT,
   LOC_GDMOB_FLUX    BIGINT,
   IRPVC_GDMOB_FLUX    BIGINT,
   OPRVC_GDMOB_FLUX    BIGINT,
   GDMOB_FLUX    BIGINT,
   LOC_OTHAPN_FLUX    BIGINT,
   IPRVC_OTHAPN_FLUX    BIGINT,
   OPRVC_OTHAPN_FLUX    BIGINT,
   OTHAPN_FLUX    BIGINT,
   LOC_FLUX    BIGINT,
   IPRVC_FLUX    BIGINT,
   OPRVC_FLUX    BIGINT,
   GPRS_FEE    DECIMAL(14,2),
   GPRS_FLUX    BIGINT,
   GPRS_PKG_FEE    DECIMAL(14,2),
   GPRS_MOB_FEE    DECIMAL(14,2),
   GPRS_MO_PKG_FEE    DECIMAL(14,2),
   BRND_CD    SMALLINT,
   EFF_STD_PKG_CD    STRING,
   ORDR_STD_PKG_CD    STRING,
   INTNTL_ROAM_GPRS_USR_IND    STRING,
   INTNTL_ROAM_GPRS_FLUX    BIGINT,
   INTNTL_ROAM_GPRS_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_CELL_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_CELL_USR_D (
   STAT_DT    INT,
   CALL_DT    INT,
   USR_NBR    STRING,
   LOCAL_CD    STRING,
   CELL_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ROAM_TYP_CD    SMALLINT,
   CALL_CNT    INT,
   DEBET_MOB_DUR    INT,
   DEBET_TOLL_DUR    INT,
   CALL_DUR    INT,
   ACTVCALL_CNT    INT,
   ACTVCALL_MOB_DUR    INT,
   ACTVCALL_CALL_DUR    INT,
   BYCALL_CNT    INT,
   BYCALL_MOB_DUR    INT,
   BYCALL_CALL_DUR    INT,
   GPRS_UP_FLUX    BIGINT,
   GPRS_DOWN_FLUX    BIGINT,
   GPRS_UP_CNT    INT,
   GPRS_DOWN_CNT    INT,
   DISC_MOB_FEE    DECIMAL(14,2),
   DISC_TOLL_FEE    DECIMAL(14,2),
   DISC_INF_FEE    DECIMAL(14,2),
   GPRS_FEE    DECIMAL(14,2),
   OTHER_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_CMNCT_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_CMNCT_USR_D (
   USR_MOB_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PKG_CD    SMALLINT,
   MUM_3MON_IND    STRING,
   FIRST_CALL_DT    INT,
   LAST_CALL_DT    INT,
   FIRST_LOCAL_CD    STRING,
   FIRST_CELL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TS_PERS_CMNCT_USR_D;
CREATE EXTERNAL TABLE NG3.TS_PERS_CMNCT_USR_D (
   USR_MOB_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PKG_CD    SMALLINT,
   MUM_3MON_IND    STRING,
   FIRST_CALL_DT    INT,
   LAST_CALL_DT    INT,
   FIRST_LOCAL_CD    STRING,
   FIRST_CELL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_TERM_IMEI_INV_SEQ_Y;
CREATE EXTERNAL TABLE NG3.TW_TERM_IMEI_INV_SEQ_Y (
   USR_NBR    STRING,
   IMEI    STRING,
   EFF_DT    INT,
   EFF_TM    STRING,
   INVALID_DT    INT,
   INVALID_TM    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   TAC    STRING,
   LAST_CALL_DT    INT,
   LAST_CALL_TM    STRING
)
PARTITIONED BY (branch STRING,year INT,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_IMEI_STS_D;
CREATE EXTERNAL TABLE NG3.TW_IMEI_STS_D (
   IMEI    STRING,
   FRST_EFF_DT    INT,
   FRST_EFF_TM    STRING,
   FRST_USR_NBR    STRING,
   FRST_CMCC_BRANCH_CD    STRING,
   LAST_CALL_DT    INT,
   LAST_CALL_TM    STRING,
   LAST_USR_NBR    STRING,
   LAST_CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_3G_TYJUSR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_3G_TYJUSR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   IMEI    STRING,
   TD_TYP_CD    SMALLINT,
   BRND_CD    SMALLINT,
   TD_NB_IND    SMALLINT,
   TD_NB_IMEI    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_GPRS_BUSI_SUP_D;
CREATE EXTERNAL TABLE NG3.TW_NB_GPRS_BUSI_SUP_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   HR0_1_FLUX    BIGINT,
   HR1_2_FLUX    BIGINT,
   HR2_3_FLUX    BIGINT,
   HR3_4_FLUX    BIGINT,
   HR4_5_FLUX    BIGINT,
   HR5_6_FLUX    BIGINT,
   HR6_7_FLUX    BIGINT,
   HR7_8_FLUX    BIGINT,
   HR8_9_FLUX    BIGINT,
   HR9_10_FLUX    BIGINT,
   HR10_11_FLUX    BIGINT,
   HR11_12_FLUX    BIGINT,
   HR12_13_FLUX    BIGINT,
   HR13_14_FLUX    BIGINT,
   HR14_15_FLUX    BIGINT,
   HR15_16_FLUX    BIGINT,
   HR16_17_FLUX    BIGINT,
   HR17_18_FLUX    BIGINT,
   HR18_19_FLUX    BIGINT,
   HR19_20_FLUX    BIGINT,
   HR20_21_FLUX    BIGINT,
   HR21_22_FLUX    BIGINT,
   HR22_23_FLUX    BIGINT,
   HR23_24_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CS_12580_USR_USE_D;
CREATE EXTERNAL TABLE NG3.TW_CS_12580_USR_USE_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   BRND_CD    SMALLINT,
   COOPR_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   VOC_USR_IND    STRING,
   SMS_USR_IND    STRING,
   WAP_USR_IND    STRING,
   CLIENT_USR_IND    STRING,
   OUT_CALL_IND    STRING,
   ELIFE_USE_IND    STRING,
   FWDPRDCT_USR_IND    STRING,
   CALL_12580_IND    STRING,
   CALL_114_IND    STRING,
   CALL_160_IND    STRING,
   CALL_BUSI_IND    STRING,
   CALL_12580_CNT    INT,
   SMS_12580_CNT    INT,
   CALL_12580_DUR    INT,
   GPRS_12580_FLUX    INT,
   CALL_114_CNT    INT,
   CALL_114_DUR    INT,
   CALL_160_CNT    INT,
   CALL_160_DUR    INT,
   CALL_BUSI_CNT    INT,
   CALL_BUSI_DUR    INT,
   HTL_SETL_CNT    INT,
   HTL_ORDER_IND    STRING,
   HTL_ORDER_CNT    INT,
   AIRPTKT_SALE_CNT    INT,
   AIRPTKT_CANCEL_CNT    INT,
   AIRPTKT_BACK_CNT    INT,
   AIRPTKT_SELT_CNT    INT,
   AIRPTKT_SALE_FEE    DECIMAL(14,2),
   AIRPTKT_CANCEL_FEE    DECIMAL(14,2),
   AIRPTKT_BACK_FEE    DECIMAL(14,2),
   AIRPTKT_SELT_FEE    DECIMAL(14,2),
   CALL_12580_VOC_FEE    DECIMAL(14,2),
   FRONT_FEE_USR_IND    STRING,
   FRONT_FEE    DECIMAL(14,2),
   SMS_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CORP_CUST_BAS_D;
CREATE EXTERNAL TABLE NG3.TW_CORP_CUST_BAS_D (
   GROUP_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   CMCC_CNTRY_CD    STRING,
   CMCC_TOWN_CD    STRING,
   DTGRP_AB_CD    STRING,
   DTGRP_AB_CD_2016    STRING,
   CORP_TYP_CD    INT,
   INDUS_TYP_CD    INT,
   INDUS_TYP2_CD    INT,
   VOCATION_TYP1_CD    STRING,
   PRVCGRP_TYP_CD    SMALLINT,
   NATGRP_TYP_CD    SMALLINT,
   PROF_TYP_CD    SMALLINT,
   SRV_OFC_CD    SMALLINT,
   YJ_VLD_IND    STRING,
   CMLBRB_GRP_IND    STRING,
   CUST_STS_CD    STRING,
   CUST_INNET_DT    INT,
   CUST_CHG_DT    INT,
   MRKT_CHNL_CD    STRING,
   HST_CD    STRING,
   CUST_ID    STRING,
   PAR_GROUP_ID    STRING,
   CUST_MGR_ID    STRING,
   UPDT_DT    INT,
   GRPORG_TYP_CD    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CS_12580_VIST_USR_D;
CREATE EXTERNAL TABLE NG3.TW_CS_12580_VIST_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   VIST_TYP_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   COOPR_CD    INT,
   CALL_CNT    INT,
   SMS_CNT    INT,
   DEBET_DUR    INT,
   GPRS_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_CHRG_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_CHRG_USR_D (
   USR_NBR    STRING,
   TRADE_TYP    SMALLINT,
   CHRG_DT    INT,
   CHRG_TIM    STRING,
   CHRG_AMT    DECIMAL(10,2),
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   CHRG_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_FAM_PAY_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_FAM_PAY_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   MAIN_NBR_IND    STRING,
   MAIN_NBR    STRING,
   FAM_MBR_CNT    SMALLINT
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TS_PERS_4G_USR_BUSI_D;
CREATE EXTERNAL TABLE NG3.TS_PERS_4G_USR_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PKG_DTL_CD    INT,
   A4G_BRND_PRDCT_CD    STRING,
   GPRS_STD_PRDCT_CD    STRING,
   COMMON_IMEI    STRING,
   TERM_BRND    STRING,
   TERM_DEVICE_NAM    STRING,
   TERM_TYP_CD    STRING,
   TERM_SYS    SMALLINT,
   TERM_SELL_KIND    SMALLINT,
   INTELL_TERM_IND    STRING,
   A3G_KPI_USR_IND    STRING,
   A4G_KPI_USR_IND    STRING,
   USE_USIM_IND    STRING,
   OPEN_4G_FUNC_IND    STRING,
   A4G_ORDR_USR_IND    STRING,
   A4G_POTENTIAL_USR_IND    STRING,
   A4G_PKG_USR_IND    STRING,
   A4G_TERM_USR_IND    STRING,
   A2G_NET_USE_IND    STRING,
   A3G_NET_USE_IND    STRING,
   A4G_NET_USE_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_3G_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_3G_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   IMEI    STRING,
   TERM_TYP_CD    STRING,
   TERM_INTEL_IND    STRING,
   A3G_TERM_USR_IND    STRING,
   A3G_NET_USE_IND    STRING,
   A3G_NET_USE_D_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_HOMEBRB_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_HOMEBRB_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   USR_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PKG_CYC_CD    SMALLINT,
   PKG_SPEED_CD    SMALLINT,
   PKG_TYP_CD    SMALLINT,
   NEW_USR_IND    STRING,
   START_DT    INT,
   BRB_TYP_CD    SMALLINT,
   CUST_TYP_CD    SMALLINT,
   MRKT_CHNL_CD    STRING,
   BASS_PRDCT_CD    STRING,
   SUBSPROD_ID    STRING,
   PKG_SUBSPROD_ID    STRING,
   PKG_BASS_PRDCT_CD    STRING,
   PKG_EFF_DT    INT,
   PKG_END_DT    INT,
   MON_NEW_USR_IND    STRING,
   USR_STS_IND    SMALLINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_REAL_NAME_INFO_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_REAL_NAME_INFO_D (
   USR_ID    STRING,
   CUST_ID    STRING,
   USR_NBR    STRING,
   USR_ID_TYP_CD    STRING,
   USR_ID_NBR    STRING,
   USR_NAM    STRING,
   USR_ADDRESS    STRING,
   ACCT_ID_TYP_CD    STRING,
   ACCT_ID_NBR    STRING,
   ACCT_NAM    STRING,
   ACCT_ADDRESS    STRING,
   OPE_ID_TYP_CD    STRING,
   OPE_ID_NBR    STRING,
   OPE_NAM    STRING,
   OPE_ADDRESS    STRING,
   REAL_NAME_DEC    STRING,
   ACCOUNT_TYP    STRING,
   UPDT_DT    INT,
   MON_DATA_IND    STRING,
   REAL_NAME_CD    STRING,
   GDR_TYP_CD    SMALLINT,
   AGE_CNT    INT,
   BIRTH_DT    INT,
   ZODIAC_NAM    STRING,
   ID_HOME_PROV    STRING,
   ID_HOME_CITY    STRING,
   CMCC_BRANCH_CD    STRING,
   ACPT_DT    INT,
   ACPT_TIM    INT,
   ACPT_CHNL_CD    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_CMPTUSR_CNTY_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_CMPTUSR_CNTY_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   CMCC_CNTY_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_USR_CNTY_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_USR_CNTY_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_CNTY_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_HOMEBRB_OUTNET_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_HOMEBRB_OUTNET_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   USR_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PKG_CYC_CD    SMALLINT,
   PKG_SPEED_CD    SMALLINT,
   START_DT    INT,
   BRB_TYP_CD    SMALLINT,
   CUST_TYP_CD    SMALLINT,
   MRKT_CHNL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_SECUR_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_SECUR_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   SECUR_QRY_IND    STRING,
   SECUR_QRY_NEW_IND    STRING,
   SECUR_QRY_CANC_IND    STRING,
   SECUR_TRD_IND    STRING,
   SECUR_TRD_NEW_IND    STRING,
   SECUR_TRD_CANC_IND    STRING,
   SECUR_IND    STRING,
   SECUR_NEW_IND    STRING,
   SECUR_CANC_IND    STRING,
   SECUR_CHRG_QRY_IND    STRING,
   SECUR_CHRG_TRD_IND    STRING,
   SECUR_CHRG_COMB_IND    STRING,
   SECUR_CHRG_CNSTR_IND    STRING,
   SECUR_CHRG_IND    STRING,
   CM_SECUR_CHRG_QRY_IND    STRING,
   CM_SECUR_CHRG_TRD_IND    STRING,
   CM_SECUR_CHRG_COMB_IND    STRING,
   CM_SECUR_CHRG_CNSTR_ND    STRING,
   CM_SECUR_CHRG_IND    STRING,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TS_NB_GPRS_USR_PRDCT_ORDR_D;
CREATE EXTERNAL TABLE NG3.TS_NB_GPRS_USR_PRDCT_ORDR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   BASS_PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   ORDR_CNT    INT,
   EFF_DT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_WLAN_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_WLAN_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   WLAN_TOT_DUR    INT,
   WLAN_OVER_PKG_DUR    INT,
   AUTO_AUTH_PLAT_DUR    INT,
   EWLAN_DUR    INT,
   MOB_WLAN_DUR    INT,
   PC_WLAN_DUR    INT,
   TABLET_WLAN_DUR    INT,
   MOB_ANDROID_DUR    INT,
   MOB_APPLE_MAC_DUR    INT,
   MOB_APPLE_ISO_DUR    INT,
   MOB_WINDOWS_DUR    INT,
   MOB_WINDOWS_MOBILE_DUR    INT,
   MOB_WINDOWS_PHONE_DUR    INT,
   MOB_BLACKBERRY_DUR    INT,
   MOB_SYMBIAN_DUR    INT,
   CALL_DUR    BIGINT,
   FREE_DUR    BIGINT,
   WLAN_TOT_FLUX    BIGINT,
   WLAN_OVER_PKG_FLUX    BIGINT,
   AUTO_AUTH_PLAT_FLUX    BIGINT,
   EWLAN_FLUX    BIGINT,
   MOB_WLAN_FLUX    BIGINT,
   PC_WLAN_FLUX    BIGINT,
   TABLET_WLAN_FLUX    BIGINT,
   MOB_ANDROID_FLUX    BIGINT,
   MOB_APPLE_MAC_FLUX    BIGINT,
   MOB_APPLE_ISO_FLUX    BIGINT,
   MOB_WINDOWS_FLUX    BIGINT,
   MOB_WINDOWS_MOBILE_FLUX    BIGINT,
   MOB_WINDOWS_PHONE_FLUX    BIGINT,
   MOB_BLACKBERRY_FLUX    BIGINT,
   MOB_SYMBIAN_FLUX    BIGINT,
   WLAN_MOB_FEE    DECIMAL(12,2),
   AUTO_AUTH_PLAT_LOGIN_CNT    INT,
   EWLAN_LOGIN_CNT    INT,
   LOGIN_CNT    INT,
   ACTV_USR_IND    STRING,
   COLLG_USR_IND    STRING,
   REG_IND    STRING,
   D_REG_IND    STRING,
   PROV_SPCL_IND    STRING,
   EWLAN_CHRG_DUR    BIGINT,
   EWLAN_FREE_DUR    BIGINT,
   EWLAN_FEE    DECIMAL(14,2),
   NORMAL_PKG_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_GPRS_FLUX_MARKET_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_GPRS_FLUX_MARKET_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   DOUBT_TDNET_LOCK_IND    STRING,
   FLUX_PKG_TYP    STRING,
   GPRS_SPKG_TYP_CD    SMALLINT,
   ADDUP_GPRS_FLUX    BIGINT,
   PKG_GPRS_FLUX    BIGINT,
   SETL_DT    INT,
   LAB_MO    INT,
   GPRS_DJPKG_ORDR_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBNGTN_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBNGTN_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   IS_PAY_MO    SMALLINT,
   IS_PAY_CNT    SMALLINT,
   IS_FREE    SMALLINT,
   IS_ORDER    SMALLINT,
   IS_CANC    SMALLINT,
   PAY_MO_CNT    INT,
   PAY_TIME_CNT    INT,
   FREE_USE_CNT    INT,
   PAY_MO_SOURCE    SMALLINT,
   PAY_TIME_SOURCE    SMALLINT,
   FERR_USE_SOURCE    SMALLINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBTB_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBTB_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOBTB_USR_IND    STRING,
   ACTV_CARD_CNT    INT,
   ACTV_USR_IND    STRING,
   NEW_ACTV_USR_IND    STRING,
   CANC_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_COM139_CDR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_COM139_CDR_D (
   STAT_DT    INT,
   SER_NO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   CALL_DT    INT,
   CALL_TM    STRING,
   B_NBR    STRING,
   IMEI    STRING,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   TOLL_TYP_CD    SMALLINT,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   BILL_TYP_CD    STRING,
   CALL_DUR    INT,
   TOT_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBREAD_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBREAD_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   INFO_FEE    DECIMAL(14,2),
   PCK_USR_IND    STRING,
   ACSS_USR_IND    STRING,
   WAP_ACSS_USR_IND    STRING,
   CLI_ACSS_USR_IND    STRING,
   FST_ACSS_USR_IND    STRING,
   ORD_USR_IND    STRING,
   NEW_PCK_USR_IND    STRING,
   NEW_ACSS_USR_IND    STRING,
   PAY_USR_IND    STRING,
   PCK3_USR_IND    STRING,
   PCK5_USR_IND    STRING,
   ACT_USR_IND    STRING,
   WHL_ORD_USR_IND    STRING,
   WORD_ORD_USR_IND    STRING,
   BK_DWN_USR_IND    STRING,
   FREE_CHPT_PV_CNT    INT,
   PAY_CHPT_PV_CNT    INT,
   WAP_PLT_ORD_CNT    INT,
   WWW_PLT_ORD_CNT    INT,
   G3_PLT_ORD_CNT    INT,
   CLI_PLT_ORD_CNT    INT,
   SRVR_PLT_ORD_CNT    INT,
   BOSS_PLT_ORD_CNT    INT,
   SMS_PLT_ORD_CNT    INT,
   MM_PLT_ORD_CNT    INT,
   ALL_PLT_ORD_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBREAD_ASCC_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBREAD_ASCC_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   NEW_USR_IND    STRING,
   TOT_LOGIN_CNT    INT,
   WAP_LOGIN_CNT    INT,
   CLI_LOGIN_CNT    INT,
   FST_LOGIN_CNT    INT,
   PV_CNT    INT,
   WAP_PV_CNT    INT,
   CLI_PV_CNT    INT,
   FST_PV_CNT    INT,
   PAY_AMT    DECIMAL(14,2),
   WAP_PAY_AMT    DECIMAL(14,2),
   CLI_PAY_AMT    DECIMAL(14,2),
   FST_PAY_AMT    DECIMAL(14,2),
   BOOK_ORDR_CNT    INT,
   WORD_ORDR_CNT    INT,
   MO_ORDR_CNT    INT,
   BOOK_PAY_AMT    DECIMAL(14,2),
   WORD_PAY_AMT    DECIMAL(14,2),
   MO_PAY_AMT    DECIMAL(14,2),
   TOT_READ_CHPT_CNT    INT,
   WAP_CHPT_READ_CNT    INT,
   MOBREAD_CHPT_READ_CNT    INT,
   CLI_CHPT_READ_CNT    INT,
   SER_FREE_CHPT_CNT    INT,
   BOOK_FREE_CHPT_CNT    INT,
   SER_PAY_CHPT_CNT    INT,
   BOOK_PAY_CHPT_CNT    INT,
   BOOK_DWNLOAD_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBNEWS_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBNEWS_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   SP_CODE    STRING,
   SP_SUBBUSI_CD    STRING,
   NEWS_CLASS_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   NEW_USR_IND    STRING,
   PAY_USR_IND    STRING,
   CANC_USR_IND    STRING,
   SUCC_RECV_IND    STRING,
   FREE_USR_IND    STRING,
   ORDR_USR_IND    STRING,
   PAY_AMT    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBNEWS_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBNEWS_D (
   STAT_DT    INT,
   CMCC_BRACH_CD    STRING,
   BRND_CD    SMALLINT,
   SP_CODE    STRING,
   SP_SUBBUSI_CD    STRING,
   NEWS_CLASS_CD    STRING,
   SEND_SUCC_CNT    INT,
   SEND_FAIL_CNT    INT,
   SUCC_RECV_CNT    INT,
   ISUSE_CNT    INT,
   INCM_FEE    DECIMAL(14,2),
   ORDR_CNT    INT,
   CANC_CNT    INT,
   SEND_USRCNT    INT,
   ORDR_USRCNT    INT,
   SUCC_RECV_USRCNT    INT,
   FEE_USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MM_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MM_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   PRTL_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   TERM_MDL_ID    INT,
   ACTV_USR_IND    STRING,
   REG_USR_IND    STRING,
   USE_USR_IND    STRING,
   SBJ_DLOAD_CNT    INT,
   SOFT_DLOAD_CNT    INT,
   GAME_DLOAD_CNT    INT,
   FREE_APP_DLOAD_CNT    INT,
   PAY_APP_DLOAD_CNT    INT,
   OTH_APP_DLOAD_CNT    INT,
   MUSIC_ORDR_CNT    INT,
   MUSIC_ORDR_AMT    DECIMAL(14,2),
   MUSIC_USE_CNT    INT,
   READ_ORDR_CNT    INT,
   READ_ORDR_AMT    DECIMAL(14,2),
   READ_USE_CNT    INT,
   GAME_ORDR_CNT    INT,
   GAME_ORDR_AMT    DECIMAL(14,2),
   GAME_USE_CNT    INT,
   VIDEO_ORDR_CNT    INT,
   VIDEO_ORDR_AMT    DECIMAL(14,2),
   VIDEO_USE_CNT    INT,
   WAPHALL_USE_CNT    INT,
   LOGIN_CNT    INT,
   ACSS_CNT    INT,
   APP_DLOAD_PAY_AMT    DECIMAL(14,2),
   CLI_DLOAD_CNT    INT,
   MOBNEWS_ORDR_CNT    INT,
   MOBFLASH_ORDR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_WETHER_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_WETHER_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   SP_SUBBUSI_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   NEW_USR_IND    STRING,
   CANC_USR_IND    STRING,
   PAY_USR_IND    STRING,
   MOR_REACH_CNT    INT,
   EVEN_REACH_CNT    INT,
   REC_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_CPRINT_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_CPRINT_BUSI_D (
   USR_NBR    STRING,
   USR_TYP    STRING,
   STAT_DT    INT,
   BUSI_TYP    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   CPRINT_USR_IND    STRING,
   NEW_USR_IND    STRING,
   LOST_USR_IND    STRING,
   FEE    DECIMAL(10,2)
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TO_NB_CPRINT_USR_ORDR_D;
CREATE EXTERNAL TABLE NG3.TO_NB_CPRINT_USR_ORDR_D (
   USR_NBR    STRING,
   PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   EFF_DT    INT,
   STS_CD    STRING,
   INV_DT    INT,
   STAT_DT    INT,
   OPER_DT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_PCA_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_PCA_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   USR_TYP    STRING,
   BUSI_TYP    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   PCA_USR_IND    STRING,
   NEW_USR_IND    STRING,
   LOST_USR_IND    STRING,
   FEE    DECIMAL(10,2),
   USE_FUNC_IND    STRING,
   GFT_CNT    INT,
   DEMAND_CNT    INT,
   PRDCT_CD    STRING,
   BRND_CD    SMALLINT,
   EFF_DT    INT,
   INV_DT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_PCA_USR_ORDR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_PCA_USR_ORDR_D (
   USR_NBR    STRING,
   PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   EFF_DT    INT,
   STS_CD    STRING,
   INV_DT    INT,
   STAT_DT    INT,
   ORDR_CHNL_CD    STRING,
   CANC_CHNL_CD    STRING,
   CURR_DAY_IND    STRING,
   BUSI_TYP    SMALLINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MM_USR_STS_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MM_USR_STS_D (
   USR_NBR    STRING,
   LOGIN_TYP    STRING,
   LOGIN_CD    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   FIRST_LOGIN_DT    INT,
   FIRST_LOGIN_TIM    STRING,
   LAST_LOGIN_DT    INT,
   LAST_LOGIN_TIM    STRING,
   LOGIN_CNT    INT,
   TERM_DEVC_CD    STRING,
   TERM_PLTFM_CD    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MAIL139_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MAIL139_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   MAIL_SRVC_TYP_CD    SMALLINT,
   MAIL_TYP_CD    SMALLINT,
   REG_TYP_CD    SMALLINT,
   ORDR_DT    INT,
   MAIL139_TOT_FEE    DECIMAL(14,2),
   ORDR_CHNL_TYP_CD    SMALLINT,
   NCKNAM_IND    SMALLINT,
   ACTV_CNT_IND    SMALLINT,
   READ_MAIL_IND    STRING,
   NEW_REG_USR_IND    STRING,
   PUSHMAIL_SBSCR_IND    SMALLINT,
   FRZ_IND    STRING,
   CANC_USR_IND    STRING,
   USE_ADDBUSI_IND    STRING,
   OPEN_PRTN_IND    STRING,
   USE_PRTN_IND    STRING,
   USE_SMS_MNG_IND    STRING,
   LOG_CNT    INT,
   WEB_LOGON_CNT    INT,
   WAP_LOGON_CNT    INT,
   RTN_W_CNT    INT,
   SMS_MT_CNT    INT,
   SMS_MO_CNT    INT,
   MMS_MT_CNT    INT,
   SMTP_CNCT_CNT    INT,
   POP_CNCT_CNT    INT,
   LSMS_MT_CNT    INT,
   SMSIN_MT_CNT    INT,
   MMSIN_MT_CNT    INT,
   ADR_USE_CNT    INT,
   RSS_USE_CNT    INT,
   DISK_USE_CNT    INT,
   FAX_USE_CNT    INT,
   USE_ADDVAL_BUSI_CNT    INT,
   USE_SMS_MNG_CNT    INT,
   NEWMAIL_NTC_CNT    INT,
   READ_MAIL_CNT    INT,
   MAIL_SEND_CNT    INT,
   WEB_SEND_MAIL_CNT    INT,
   SMS_SEND_MAIL_CNT    INT,
   SMTP_SEND_MAIL_CNT    INT,
   EXTRNL_MAIL_SEND_CNT    INT,
   INTRNL_MAIL_SEND_CNT    INT,
   MAIL_RECV_CNT    INT,
   EXTRNL_MAIL_RECV_CNT    INT,
   INTRNL_MAIL_RECV_CNT    INT,
   POP_RECV_MAIL_CNT    INT,
   IMAP_RECV_MAIL_CNT    INT,
   RW_RECV_MAIL_CNT    INT,
   SMS_MO_CNT2    INT,
   IMAP4_CNT    INT,
   PUSHMAIL_DOWN_CNT    INT,
   PUSHMAIL_UP_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MAIL139_USR_STS_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MAIL139_USR_STS_D (
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MAIL_SRVC_TYP_CD    SMALLINT,
   ORDR_CHNL_TYP_CD    SMALLINT,
   ORDR_DT    INT,
   CANC_DT    INT,
   CHG_DT    INT,
   USR_STS_CD    SMALLINT,
   USR_NCKNM    STRING,
   NEW_ACTV_DT    INT
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_FETION_USR_HIS_D;
CREATE EXTERNAL TABLE NG3.TW_NB_FETION_USR_HIS_D (
   USR_MOB_NBR    STRING,
   FETION_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   FST_USE_DT    INT,
   LAST_USE_DT    INT,
   CONT_USE_DAY    SMALLINT,
   FST_OPEN_DT    INT,
   USR_STS_CD    STRING,
   OPEN_REQSRS_CD    STRING,
   CLOSE_REQSRS_CD    STRING,
   FRD_STS_CD    INT,
   FRD_OPEN_DT    INT,
   FRD_CLOSE_DT    INT,
   FRD_LAST_USE_DT    INT,
   FRD_LAST_DEBT_DT    INT
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USRCALL_SPLSRVR_DAY;
CREATE EXTERNAL TABLE NG3.TW_USRCALL_SPLSRVR_DAY (
   USR_NBR    STRING,
   B_NBR    STRING,
   UPD_DT    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   CURRMON_CALL_CNT    INT,
   CURRMON_DEBET_DUR    INT,
   DAY1_CALL_CNT    INT,
   DAY2_CALL_CNT    INT,
   DAY3_CALL_CNT    INT,
   DAY4_CALL_CNT    INT,
   DAY5_CALL_CNT    INT,
   DAY6_CALL_CNT    INT,
   DAY7_CALL_CNT    INT,
   DAY8_CALL_CNT    INT,
   DAY9_CALL_CNT    INT,
   DAY10_CALL_CNT    INT,
   DAY11_CALL_CNT    INT,
   DAY12_CALL_CNT    INT,
   DAY13_CALL_CNT    INT,
   DAY14_CALL_CNT    INT,
   DAY15_CALL_CNT    INT,
   DAY16_CALL_CNT    INT,
   DAY17_CALL_CNT    INT,
   DAY18_CALL_CNT    INT,
   DAY19_CALL_CNT    INT,
   DAY20_CALL_CNT    INT,
   DAY21_CALL_CNT    INT,
   DAY22_CALL_CNT    INT,
   DAY23_CALL_CNT    INT,
   DAY24_CALL_CNT    INT,
   DAY25_CALL_CNT    INT,
   DAY26_CALL_CNT    INT,
   DAY27_CALL_CNT    INT,
   DAY28_CALL_CNT    INT,
   DAY29_CALL_CNT    INT,
   DAY30_CALL_CNT    INT,
   DAY31_CALL_CNT    INT,
   DAY1_DEBET_DUR    INT,
   DAY2_DEBET_DUR    INT,
   DAY3_DEBET_DUR    INT,
   DAY4_DEBET_DUR    INT,
   DAY5_DEBET_DUR    INT,
   DAY6_DEBET_DUR    INT,
   DAY7_DEBET_DUR    INT,
   DAY8_DEBET_DUR    INT,
   DAY9_DEBET_DUR    INT,
   DAY10_DEBET_DUR    INT,
   DAY11_DEBET_DUR    INT,
   DAY12_DEBET_DUR    INT,
   DAY13_DEBET_DUR    INT,
   DAY14_DEBET_DUR    INT,
   DAY15_DEBET_DUR    INT,
   DAY16_DEBET_DUR    INT,
   DAY17_DEBET_DUR    INT,
   DAY18_DEBET_DUR    INT,
   DAY19_DEBET_DUR    INT,
   DAY20_DEBET_DUR    INT,
   DAY21_DEBET_DUR    INT,
   DAY22_DEBET_DUR    INT,
   DAY23_DEBET_DUR    INT,
   DAY24_DEBET_DUR    INT,
   DAY25_DEBET_DUR    INT,
   DAY26_DEBET_DUR    INT,
   DAY27_DEBET_DUR    INT,
   DAY28_DEBET_DUR    INT,
   DAY29_DEBET_DUR    INT,
   DAY30_DEBET_DUR    INT,
   DAY31_DEBET_DUR    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_WLC_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_WLC_BUSI_D (
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   JOIN_DT    INT,
   LAST_PAY_DT    INT,
   LAST_BUY_CR_DT    INT,
   CURRMO_MON_FEE    DECIMAL(10,2)
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBLOT_USE_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBLOT_USE_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   BUY_CNT    INT,
   BUY_AMT    DECIMAL(14,2),
   MO_FEE    DECIMAL(16,2),
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_MOBGAME_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_MOBGAME_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   TOT_INC    DECIMAL(14,2),
   PKG_INC    DECIMAL(14,2),
   PKG_GAME_PLAYER_INC    DECIMAL(14,2),
   PKG_INDP_INC    DECIMAL(14,2),
   NETWORK_INC    DECIMAL(14,2),
   GNA_INC    DECIMAL(14,2),
   PICWORD_INC    DECIMAL(14,2),
   OTHR_INC    DECIMAL(14,2),
   ACTV_USR_IND    STRING,
   PKG_ACTV_USR_IND    STRING,
   GAME_PLAYER_ACTV_USR_IND    STRING,
   INDP_ACTV_USR_IND    STRING,
   OTHR_ACTV_USR_IND    STRING,
   PICWORD_USE_IND    STRING,
   PKG_NEW_ORDR_USR_IND    STRING,
   PKG_CANC_USR_IND    STRING,
   PGK_ORDR_USR_IND    STRING,
   PKG_DOWNLOAD_CNT    INT,
   NETWORK_LOGIN_CNT    INT,
   GNA_DOWNLOAD_CNT    INT,
   NETWORK_PAY_CNT    INT,
   GNA_PAY_CNT    INT,
   ORDR_USR_IND    STRING,
   MOBGAME_USE_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_COM139_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_COM139_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   WEB_NEW_REG_IND    STRING,
   WAP_NEW_REG_IND    STRING,
   MOB_NEW_REG_IND    STRING,
   OTHR_NEW_REG_IND    STRING,
   ACTV_IND    STRING,
   G3_PKG_CD    STRING,
   G3_PKG_EFF_DT    INT,
   G3_PKG_EFF_TM    STRING,
   G3_PKG_INV_DT    INT,
   G3_PKG_INV_TM    STRING,
   WEB_LOGIN_CNT    INT,
   WAP_LOGIN_CNT    INT,
   MOB_LOGIN_CNT    INT,
   OTHR_LOGIN_CNT    INT,
   WEB_WEIBO_RLSE_CNT    INT,
   WAP_WEIBO_RLSE_CNT    INT,
   MOB_WEIBO_RLSE_CNT    INT,
   OTHR_WEIBO_RLSE_CNT    INT,
   WEB_WEIBO_RPLY_CNT    INT,
   WAP_WEIBO_RPLY_CNT    INT,
   MOB_WEIBO_RPLY_CNT    INT,
   OTHR_WEIBO_RPLY_CNT    INT,
   WEB_WEIBO_FWD_CNT    INT,
   WAP_WEIBO_FWD_CNT    INT,
   MOB_WEIBO_FWD_CNT    INT,
   OTHR_WEIBO_FWD_CNT    INT,
   G3_CALL_FEE    DECIMAL(16,2),
   G3_CALL_PKG_FEE    DECIMAL(16,2),
   G3_CALL_DUR    INT,
   G3_DEBET_DUR    INT,
   G3_SMS_CNT    INT,
   G3_MMS_CNT    INT,
   DISK_UP_CNT    INT,
   DISK_DOWN_CNT    INT,
   DISK_SHARE_CNT    INT,
   DISK_RLSE_CNT    INT,
   ICNTC_UP_CNT    INT,
   ICNTC_DOWN_CNT    INT,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBPAY_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBPAY_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   MOBPAY_USR_IND    STRING,
   MOBBAG_USR_IND    STRING,
   CARD_USR_IND    STRING,
   MOBPAY_NEW_USR_IND    STRING,
   MOBBAG_NEW_USR_IND    STRING,
   CARD_NEW_USR_IND    STRING,
   MOBPAY_ACTV_USR_IND    STRING,
   MOBBAG_ACTV_USR_IND    STRING,
   CARD_ACTV_USR_IND    STRING,
   LOC_TRD_CNT    INT,
   LOC_TRD_AMT    DECIMAL(14,2),
   REMO_TRD_CNT    INT,
   REMO_TRD_AMT    DECIMAL(14,2),
   FWD_CNT    INT,
   FWD_AMT    DECIMAL(14,2),
   PROV_CASH_CNT    INT,
   PROV_CASH_AMT    DECIMAL(14,2),
   CASH_CHRG_CNT    INT,
   CASH_CHRG_AMT    DECIMAL(14,2),
   CARD_CHRG_CNT    INT,
   CARD_CHRG_AMT    DECIMAL(14,2),
   MOBBAG_CARD_CNSM_AMT    DECIMAL(14,2),
   MOBBAG_CARD_CHRG_CNT    INT,
   MOBBAG_CARD_CHRG_AMT    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBGAME_DOWN_NAM_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBGAME_DOWN_NAM_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   SP_CODE    STRING,
   SP_SERV_CD    STRING,
   SP_NAM    STRING,
   SP_SERV_NAM    STRING,
   DATA_SRC_CD    SMALLINT,
   GAME_DOWN_CNT    INT,
   GAME_DOWN_UNIQ_USRCNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBREAD_PV_BOOK_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBREAD_PV_BOOK_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   BOOK_ID    STRING,
   BOOK_NAM    STRING,
   CHARGE_TYPE    STRING,
   BOOK_TYPE    STRING,
   CLASS_ID    STRING,
   CLASS_NAME    STRING,
   PV_CNT    INT,
   FREE_CHPTPV_CNT    INT,
   PAID_CHPTPV_CNT    INT,
   FREE_CHPT_CNT    INT,
   DIS_USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MNG_PLNTFM_DOWN_WSONG_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MNG_PLNTFM_DOWN_WSONG_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ORD_CD    STRING,
   WSONG_CD    STRING,
   WSONG_NAM    STRING,
   WSONG_FEE    DECIMAL(16,2),
   CP_NAM    STRING,
   TOT_WSONG_FEE    DECIMAL(16,2),
   WSONG_DWN_CNT    INT,
   WSONG_DWN_DIS_USRCNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MM_APP_DOWN_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MM_APP_DOWN_D (
   STAT_DT    INT,
   AP_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   APP_DOWN_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_FETION_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_FETION_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   FETION_ACTV_USR_IND    STRING,
   FETION_PC_ACTV_USR_IND    STRING,
   FETION_PHONE_ACTV_USR_IND    STRING,
   FETION_SMS_ACTV_USR_IND    STRING,
   FETION_IVR_ACTV_USR_IND    STRING,
   FETION_139_ACTV_USR_IND    STRING,
   FRD_CNT    INT,
   ONLINE_DUR    INT,
   CM_PC_ACTV_USR_IND    STRING,
   CM_PC_ACTV_DUR    INT,
   CM_PC_ACTV_DAYS    INT,
   CM_SMS_ACTV_USR_IND    STRING,
   CM_IVR_ACTV_USR_IND    STRING,
   WAP_ACTV_USR_IND    STRING,
   CM_WAP_ACTV_USR_IND    STRING,
   CM_MOB_ACTV_USR_IND    STRING,
   CM_MOB_ACTV_DUR    INT,
   CM_MOB_ACTV_DAYS    INT,
   CM_ACTV_USR_IND    STRING,
   LOW_ACTV_USR_IND    STRING,
   HI_ACTV_USR_IND    STRING,
   MOB_GPRSFLUX_UND50K_USR_IND    STRING,
   MOB_GPRSFLUX_UND0K_USR_IND    STRING,
   UP_SMS_CNT    INT,
   UP_SMS_USR_IND    STRING,
   DOWN_SMS_CNT    INT,
   DOWN_SMS_USR_IND    STRING,
   SMS_USR_IND    STRING,
   DEBET_DUR    INT,
   PCMOB_ACTV_USR_IND    STRING,
   ACCU_PCMOB_ACTV_USR_IND    STRING,
   PC_ACT_DUR    INT,
   MOB_ACT_DUR    INT,
   IVR_ACT_DUR    INT,
   SMS_12520_UP_CNT    INT,
   SMS_12520_UP_FEE    DECIMAL(10,2),
   VOC_12520_DUR    INT,
   VOC_12520_FEE    DECIMAL(10,2),
   FRD_FEE    DECIMAL(10,2),
   QQ_FEE    DECIMAL(10,2),
   PP_FEE    DECIMAL(10,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_CR_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_CR_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   VALID_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MNG_PLNTFM_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MNG_PLNTFM_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   CLUB_HUSR_IND    STRING,
   WSONG_USR_IND    STRING,
   WSONG_DWN_CNT    INT,
   WSONG_INF_FEE    DECIMAL(16,2),
   CLUB_SUSR_IND    STRING,
   CLUB_SUSR_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_SMS_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_SMS_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   LOC_INNER_P2PSMS_UP_CNT    INT,
   IPRVC_INNER_P2PSMS_UP_CNT    INT,
   OPRVC_INNER_P2PSMS_UP_CNT    INT,
   INNER_P2PSMS_UP_CNT    INT,
   TELCOM_OUTER_P2PSMS_CNT    INT,
   UNICOM_OUTER_P2PSMS_CNT    INT,
   OUTER_P2PSMS_UP_CNT    INT,
   INTNTL_P2PSMS_UP_CNT    INT,
   LOC_P2PSMS_UP_CNT    INT,
   IPRVC_P2PSMS_UP_CNT    INT,
   P2PSMS_UP_CNT    INT,
   PKG_INNER_P2PSMS_CNT    INT,
   MWSMS_UP_CNT    INT,
   MWSMS_DOWN_CNT    INT,
   MWSMS_PER_CHRG_DOWN_CNT    INT,
   MWSMS_MON_CHRG_CDR_CNT    INT,
   LOC_INNER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   IPRVC_INNER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   OPRVC_INNER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   OPRVC_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   LOC_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   IPRVC_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   INNER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   DX_OUTER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   LT_OUTER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   OUTER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   INTNTL_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   MWSMS_UP_CMNCT_FEE    DECIMAL(12,2),
   MWSMS_MON_INF_FEE    DECIMAL(12,2),
   MWSMS_PER_INF_FEE    DECIMAL(12,2),
   MWSMS_DIV_INF_FEE    DECIMAL(12,2),
   MWSMS_GMCC_INCOME    DECIMAL(12,2),
   P2PSMS_PKG_FEE    DECIMAL(12,2),
   SMS_FEE    DECIMAL(12,2),
   LOC_INNER_P2PSMS_IND    STRING,
   IPRVC_INNER_P2PSMS_IND    STRING,
   OPRVC_INNER_P2PSMS_IND    STRING,
   INNER_P2PSMS_IND    STRING,
   DX_OUTER_P2PSMS_IND    STRING,
   LT_OUTER_P2PSMS_IND    STRING,
   OUTER_P2PSMS_IND    STRING,
   INTNTL_P2PSMS_IND    STRING,
   P2PSMS_UP_IND    STRING,
   MWSMS_ORD_IND    STRING,
   MWSMS_UP_IND    STRING,
   MWSMS_DOWN_IND    STRING,
   MWSMS_PAY_IND    STRING,
   MWSMS_IND    STRING,
   SMS_PKG_NEW_IND    STRING,
   SMS_SPKG_ORD_USR_IND    STRING,
   INTNTL_ROAM_SMS_USR_IND    STRING,
   INTNTL_ROAM_SMS_CNT    INT,
   INTNTL_ROAM_SMS_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MMS_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MMS_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   INNER_P2PMMS_UP_CNT    INT,
   OUTER_P2PMMS_UP_CNT    INT,
   INTNTL_P2PMMS_UP_CNT    INT,
   P2PMMS_UP_CNT    INT,
   INNER_P2PMMS_DOWN_CNT    INT,
   OUTER_P2PMMS_DOWN_CNT    INT,
   INTNTL_P2PMMS_DOWN_CNT    INT,
   P2PMMS_DOWN_CNT    INT,
   MWMMS_UP_CNT    INT,
   MWMMS_DOWN_CNT    INT,
   INNER_P2PMMS_CMNCT_FEE    DECIMAL(12,2),
   OUTER_P2PMMS_CMNCT_FEE    DECIMAL(12,2),
   INTNTL_P2PMMS_CMNCT_FEE    DECIMAL(12,2),
   P2PMMS_CMNCT_FEE    DECIMAL(12,2),
   P2PMMS_PKG_FEE    DECIMAL(12,2),
   MWMMS_PKG_FEE    DECIMAL(12,2),
   MWMMS_UP_CMNCT_FEE    DECIMAL(12,2),
   MWMMS_MON_INF_FEE    DECIMAL(12,2),
   MWMMS_PER_INF_FEE    DECIMAL(12,2),
   MWMMS_DIV_INF_FEE    DECIMAL(12,2),
   MWMMS_GMCC_INCOME    DECIMAL(12,2),
   MMS_FEE    DECIMAL(12,2),
   INNER_P2PMMS_UP_IND    STRING,
   OUTER_P2PMMS_UP_IND    STRING,
   INTNTL_P2PMMS_UP_IND    STRING,
   INNER_P2PMMS_DOWN_IND    STRING,
   OUTER_P2PMMS_DOWN_IND    STRING,
   INTNTL_P2PMMS_DOWN_IND    STRING,
   P2PMMS_UP_IND    STRING,
   P2PMMS_DOWN_IND    STRING,
   MWMMS_ORD_IND    STRING,
   MWMMS_UP_IND    STRING,
   MWMMS_IND    STRING,
   MAILMMS_UP_IND    STRING,
   MAILMMS_CMNCT_FEE    DECIMAL(12,2),
   MAILMMS_MON_INF_FEE    DECIMAL(12,2),
   MAILMMS_PER_INF_FEE    DECIMAL(12,2),
   MWMMS_DOWN_IND    STRING,
   INTNTL_ROAM_MMS_USR_IND    STRING,
   INTNTL_ROAM_MMS_CNT    INT,
   INTNTL_ROAM_MMS_FEE    DECIMAL(14,2),
   INTNTL_ROAM_SMS_USR_IND    STRING,
   INTNTL_ROAM_SMS_CNT    INT,
   INTNTL_ROAM_SMS_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_VOICEMAIL_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_VOICEMAIL_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   PN_ORDR_USR_IND    STRING,
   PZ_ORDR_USR_IND    STRING,
   PS_ORDR_USR_IND    STRING,
   PH_ORDR_USR_IND    STRING,
   PW_ORDR_USR_IND    STRING,
   PN_NEW_USR_IND    STRING,
   PZ_NEW_USR_IND    STRING,
   PS_NEW_USR_IND    STRING,
   PH_NEW_USR_IND    STRING,
   PW_NEW_USR_IND    STRING,
   PN_CANC_USR_IND    STRING,
   PZ_CANC_USR_IND    STRING,
   PS_CANC_USR_IND    STRING,
   PH_CANC_USR_IND    STRING,
   PW_CANC_USR_IND    STRING,
   PAY_USR_IND    STRING,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBFLASH_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBFLASH_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ORDR_USR_IND    STRING,
   FEE_USR_IND    STRING,
   INF_FEE    DECIMAL(14,2),
   DEMAND_ORDR_USR_IND    STRING,
   MONTHLY_ORDR_USR_IND    STRING,
   DEMAND_FEE_USR_IND    STRING,
   MONTHLY_FEE_USR_IND    STRING,
   DEMAND_FEE    DECIMAL(14,2),
   MONTHLY_FEE    DECIMAL(14,2),
   S_ORDR_USR_IND    STRING,
   S_DEMAND_ORDR_USR_IND    STRING,
   S_MONTHLY_ORDR_USR_IND    STRING,
   MAGA_N_ORDR_CNT    INT,
   MAGA_O_ORDR_CNT    INT,
   MAGA_E_ORDR_USR_IND    STRING,
   S_MAGA_E_ORDR_CNT    INT,
   S_MAGA_E_ORDR_USR_IND    STRING,
   MAGE_FEE_USR_IND    STRING,
   MAGA_FEE    DECIMAL(14,2),
   S_MAGA_FEE    DECIMAL(14,2),
   MONTHLY_N_ORDR_CNT    INT,
   MONTHLY_O_ORDR_CNT    INT,
   S_MONTHLY_E_ORDR_CNT    INT,
   S_MONTHLY_FEE    DECIMAL(14,2),
   S_DEMAND_FEE_USR_IND    STRING,
   DEMAND_FEE_CNT    INT,
   S_DEMAND_FEE_CNT    INT,
   S_DEMAND_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_MOBVEDIO_USR_D;
CREATE EXTERNAL TABLE NG3.TW_NB_MOBVEDIO_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOBVEDIO_USR_IND    STRING,
   MOBVEDIO_FEE_IND    STRING,
   INF_FEE    DECIMAL(14,2),
   FREE_ORDR_USR_IND    STRING,
   DEMAND_ORDR_USR_IND    STRING,
   MONTHLY_ORDR_USR_IND    STRING,
   DEMAND_FEE_USR_IND    STRING,
   MONTHLY_FEE_USR_IND    STRING,
   DEMAND_FEE    DECIMAL(14,2),
   MONTHLY_FEE    DECIMAL(14,2),
   S_ORDR_USR_IND    STRING,
   S_FREE_ORDR_USR_IND    STRING,
   S_DEMAND_ORDR_USR_IND    STRING,
   S_MONTHLY_ORDR_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_GMCC_USR_VEST_JSSC_D;
CREATE EXTERNAL TABLE NG3.TW_GMCC_USR_VEST_JSSC_D (
   TM_INTRVL_CD    INT,
   USR_NBR    STRING,
   VEST_TYP_CD    STRING,
   VEST_LVL1_CD    STRING,
   VEST_LVL2_CD    STRING,
   VEST_LVL3_CD    STRING,
   VEST_LVL4_CD    STRING,
   VEST_LVL5_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CORP_CUST_DELEGATE_INF_D;
CREATE EXTERNAL TABLE NG3.TW_CORP_CUST_DELEGATE_INF_D (
   CUST_ID    STRING,
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   DELEGATE_NAM    STRING,
   DELEGATE_ADDR    STRING,
   DELEGATE_ID_TYP    STRING,
   DELEGATE_ID    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_ACTV_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_ACTV_USR_D (
   USR_MOB_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   ACTV_USR_IND    SMALLINT,
   CM_ACTV_DAYS    INT,
   FST_ACTV_DT    INT,
   LAST_ACTV_DT    INT
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TS_PERS_ACTV_USR_D;
CREATE EXTERNAL TABLE NG3.TS_PERS_ACTV_USR_D (
   USR_MOB_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   ACTV_USR_IND    SMALLINT,
   CM_ACTV_DAYS    INT,
   FST_ACTV_DT    INT,
   LAST_ACTV_DT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CMPT_CALL_D;
CREATE EXTERNAL TABLE NG3.TW_CMPT_CALL_D (
   STAT_DT    INT,
   COOPR_NBR    STRING,
   COOPR_CD    STRING,
   COOPR_BRND_CD    SMALLINT,
   COOPR_AREA_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   A_CMCC_BRANCH_CD    STRING,
   A_BRND_CD    SMALLINT,
   A_MOB_NBR    STRING,
   AGGREGATE_SEQ    SMALLINT,
   AGGREGATE_DT    INT,
   DEBET_DT    INT,
   ACTVCALL_CNT    INT,
   ACTVCALL_DUR    INT,
   BYCALL_CNT    INT,
   BYCALL_DUR    INT,
   SMS_UP_CNT    INT,
   SMS_DOWN_CNT    INT,
   FORWARD_CNT    INT,
   FORWARD_DUR    INT,
   ACTVCALL_SEC_DUR    INT,
   BYCALL_SEC_DUR    INT,
   FORWARD_SEC_DUR    INT,
   FIRST_CALL_DT    INT,
   FIRST_CALL_TIM    INT,
   FIRST_LOCAL_CD    STRING,
   FIRST_CELL_CD    STRING,
   FIRST_CALL_DUR    INT,
   FIRST_DEBT1_FEE    DECIMAL(10,2),
   FIRST_DEBT2_FEE    DECIMAL(10,2),
   MMS_UP_CNT    INT,
   MMS_DOWN_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USRCALL_DAY;
CREATE EXTERNAL TABLE NG3.TW_USRCALL_DAY (
   CALL_DT    INT,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   CNCT_NBR    STRING,
   HR_CD    SMALLINT,
   AGGREGATE_SEQ    SMALLINT,
   AGGREGATE_DT    INT,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   TOLL_TYP_CD    SMALLINT,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   RATE_TYP_CD    STRING,
   BILL_TYP_CD    STRING,
   CARRY_TYP_CD    STRING,
   ICP_STAT_CD    STRING,
   B_AREA_CD    STRING,
   B_BRND_CD    SMALLINT,
   B_OPER_CD    STRING,
   DEBET_DT    INT,
   CALL_AREA_CD    STRING,
   FILE_TYP    STRING,
   PKG_CD    SMALLINT,
   NET_TYP_CD    STRING,
   B_USR_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_ACCT_CD    STRING,
   A_USR_TYP_CD    STRING,
   TM_INTRVL_CD    INT,
   CALL_CNT    INT,
   CALL_DUR    BIGINT,
   CALL_FLUX    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEBET_MOB_DUR    INT,
   DEBET_TOLL_DUR    INT,
   MOB_FEE    DECIMAL(10,2),
   TOLL_FEE    DECIMAL(10,2),
   INF_FEE    DECIMAL(10,2),
   MOB_DEBET1_FEE    DECIMAL(10,2),
   TOLL_DEBET1_FEE    DECIMAL(10,2),
   INF_DEBET1_FEE    DECIMAL(10,2),
   USR_CNT    INT,
   VPMN_IND    STRING,
   FEE_DISCOUNT_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_FAMHOME_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_FAMHOME_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MAIN_NBR    STRING,
   VNS_ACTCALL_CNT    INT,
   VNS_BYCALL_CNT    INT,
   VNL_ACTCALL_CNT    INT,
   VNL_BYCALL_CNT    INT,
   VNS_ACTCALL_DEBET_DUR    INT,
   VNS_BYCALL_DEBET_DUR    INT,
   VNL_ACTCALL_DEBET_DUR    INT,
   VNL_BYCALL_DEBET_DUR    INT,
   ACTCALL_550_DEBET_DUR    INT,
   ACTCALL_550_CNT    INT,
   BYCALL_550_DEBET_DUR    INT,
   BYCALL_550_CNT    INT,
   VNSL_ACTVCALL_DUR    INT,
   VNSL_BYCALL_DUR    INT,
   VNL_ALLOP_CALL_DUR    INT,
   VNL_ALLOP_CALL_CNT    INT,
   VNS_ALLOP_CALL_DUR    INT,
   VNS_ALLOP_CALL_CNT    INT,
   VNL_LACTCALL_DEBET_DUR    INT,
   VNL_LBYCALL_DEBET_DUR    INT,
   VNL_LACTCALL_CNT    INT,
   VNL_LBYCALL_CNT    INT,
   VNL_IPACTCALL_DEBET_DUR    INT,
   VNL_IPBYCALL_DEBET_DUR    INT,
   VNL_IPACTCALL_CNT    INT,
   VNL_IPBYCALL_CNT    INT,
   VNL_OPACTCALL_DEBET_DUR    INT,
   VNL_OPBYCALL_DEBET_DUR    INT,
   VNL_OPACTCALL_CNT    INT,
   VNL_OPBYCALL_CNT    INT,
   VNS_LACTCALL_CNT    INT,
   VNS_LBYCALL_CNT    INT,
   VNS_IPACTCALL_DEBET_DUR    INT,
   VNS_IPBYCALL_DEBET_DUR    INT,
   VNS_IPACTCALL_CNT    INT,
   VNS_IPBYCALL_CNT    INT,
   VNS_OPACTCALL_DEBET_DUR    INT,
   VNS_OPBYCALL_DEBET_DUR    INT,
   VNS_OPACTCALL_CNT    INT,
   VNS_OPBYCALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CMPT_USR_D;
CREATE EXTERNAL TABLE NG3.TW_CMPT_USR_D (
   CMPT_NBR    STRING,
   AREA_CD    STRING,
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   CMPT_OPER_CD    STRING,
   CMPT_BRND_CD    SMALLINT,
   PKG_CD    SMALLINT,
   USR_STS_CD    STRING,
   NEW_USR_IND    STRING,
   ACTV_CMNCT_USR_IND    STRING,
   CM_NEW_USR_IND    STRING,
   CM_ACTV_CMNCT_USR_IND    STRING,
   ACTV_USR_IND    STRING,
   CM_ACTV_DAYS    INT,
   FST_CALL_DT    INT,
   FST_CALL_TIM    INT,
   LAST_CALL_DT    INT,
   INNET_DT    INT,
   OUTNET_DT    INT,
   OUTNET_USR_IND    STRING,
   CM_OUTNET_USR_IND    STRING,
   FST_LOCAL_CD    STRING,
   FST_CELL_CD    STRING,
   FST_DEBET1_FEE    DECIMAL(10,2),
   FST_DEBET2_FEE    DECIMAL(10,2),
   FST_CALL_DUR    INT,
   ACTVCALL_DUR    INT,
   BYCALL_DUR    INT,
   FWD_BYCALL_DUR    INT,
   ACTVCALL_CNT    INT,
   BYCALL_CNT    INT,
   SMS_UP_CNT    INT,
   SMS_DOWN_CNT    INT,
   FWD_BYCALL_CNT    INT,
   CM_ACTVCALL_DUR    INT,
   CM_ACTVCALL_CNT    INT,
   CM_BYCALL_DUR    INT,
   CM_BYCALL_CNT    INT,
   CM_FWD_BYCALL_DUR    INT,
   CM_FWD_BYCALL_CNT    INT,
   CM_SMS_UP_CNT    INT,
   CM_SMS_DOWN_CNT    INT,
   INNET_MO_CNT    INT,
   DIST_D_LOCAL_CD    STRING,
   DIST_D_CELL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_FAMHOME_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_FAMHOME_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   SHORT_NBR    STRING,
   EFF_DT    INT,
   INVALID_DT    INT,
   BASS_PRDCT_CD    STRING,
   MAIN_NBR    STRING,
   MAIN_CMCC_BRANCH_CD    STRING,
   MAIN_BRND_CD    SMALLINT,
   MAIN_SHORT_NBR    STRING,
   FAMHOME_REACH_FAM_IND    STRING,
   FAMHOME_NEW_FAM_IND    STRING,
   FAMHOME_REACH_MBR_IND    STRING,
   FAMHOME_NEW_MBR_IND    STRING,
   FAMHOME_MAINSUB_CD    SMALLINT,
   FAMHOME_FAM_TYP_CD    SMALLINT,
   FEE_TYP_CD    SMALLINT,
   PAY_TYP_CD    SMALLINT,
   CMPT_USR_IND    STRING,
   FAMHOME_SMS_IND    STRING,
   FAMHOME_SMS_NEW_IND    STRING,
   FAMHOME_SMS_LOST_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_HOMEBRB_FLUX_USEAGE_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_HOMEBRB_FLUX_USEAGE_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   LOGIN_ACCOUNT    STRING,
   DAY_ONNET_DUR    BIGINT,
   DAY_USE_FLUX    BIGINT,
   DAY_LOGIN_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CORP_PRDCT_MBR_D;
CREATE EXTERNAL TABLE NG3.TW_CORP_PRDCT_MBR_D (
   USR_NBR    STRING,
   GUSR_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   GROUP_ID    STRING,
   GRP_AB_CD    STRING,
   GCUST_ID    STRING,
   CORP_PRDCT_NBR    STRING,
   CORP_PRDCT_CODE    STRING,
   CORP_USR_NBR    STRING,
   BRND_CD    SMALLINT,
   USR_SHORTNBR    STRING,
   REG_DT    INT,
   MBR_STS_CD    SMALLINT,
   STS_DT    INT
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TO_P_GCUST_D;
CREATE EXTERNAL TABLE NG3.TO_P_GCUST_D (
   CUST_ID    STRING,
   AREA_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   GROUP_ID    STRING,
   PAR_GROUP_ID    STRING,
   CUST_NAM    STRING,
   CORP_REP    STRING,
   CORP_TYP    STRING,
   INDUS_TYP_CD    STRING,
   INDUS_TYP2_CD    STRING,
   CORP_TYP_CD    STRING,
   CORP_PAY_TYP_CD    STRING,
   SRV_DEPT    STRING,
   MAIN_PRDCT    STRING,
   EMP_CNT    INT,
   MGR_CNT    INT,
   NRML_EMP_CNT    INT,
   REG_NO    STRING,
   AREA_TYP_CD    SMALLINT,
   CORP_SIZE_TYP_CD    STRING,
   INNET_CHNL_CD    STRING,
   INNET_DT    INT,
   BUDGET_AMT    DECIMAL(18,2),
   MBR_LMT    INT,
   CORP_MOB_CNT    INT,
   CORP_CMCC_MOB_CNT    INT,
   CORP_CDMA_CNT    INT,
   CORP_UNICOM_GSM_CNT    INT,
   CORP_PAS_USR_CNT    INT,
   GOTONE_USR_CNT    INT,
   EASYOWN_USR_CNT    INT,
   EASYOWN_PUB_USR_CNT    INT,
   MZONE_USR_CNT    INT,
   REG_FUND    DECIMAL(18,2),
   MNG    STRING,
   SRV_RNK_CD    STRING,
   DIS_SAME_TYP    STRING,
   INVC_PRT_TYP    STRING,
   INVC_NAM    STRING,
   CMPT_STS_CD    STRING,
   CROS_BUSI_TYP    STRING,
   PRE_MGR_NAM    STRING,
   CUST_LVL    STRING,
   COMMEMORATE_DT    INT,
   PROJ_MGR    STRING,
   NO_MOB_USR_CNT    INT,
   CONTR_ID    STRING,
   SMALL_CORP_TYP    STRING,
   CORP_UNIT_CD    STRING,
   CREATE_TM    INT,
   YEAR_SALE_AMT    DECIMAL(18,2),
   YEAR_PROF_AMT    DECIMAL(18,2),
   LAST_YEAR_INC    DECIMAL(18,2),
   VIP_CNT    INT,
   RMRK    STRING,
   FIN_CD    STRING,
   RSPN_PERS_CO    STRING,
   VPMN_CD_CTY    STRING,
   FUND_TYP    STRING,
   FUND_CO    STRING,
   CUST_CHG_DT    INT,
   DEST_CUST_IND    STRING,
   UNIT_ADDR    STRING,
   RESP_MOB_NBR    STRING,
   RESP_WORK_TEL    STRING,
   DEPUTY_EMP_ID    STRING,
   CMCC_CNTRY_CD    STRING,
   CMCC_TOWN_CD    STRING,
   SNAP_CORP_TYP    STRING,
   DVLP_EMP_ID    STRING,
   DVLP_CHNL_TYP_CD    STRING,
   INDUS_TYP    STRING,
   CUSTM_INDUS_TYP    STRING,
   UNIT_KIND_CD    STRING,
   CO_SIZE_CD    STRING,
   DYN_CORP_TYP    STRING,
   HOST_PRVC    STRING,
   HOST_CTY    STRING,
   CROS_PRVC_GROUP_IND    STRING,
   GROUP_CUST_TYP    STRING,
   GROUP_CUST_IMP_TYP    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_FREE_RES_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_FREE_RES_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   GPRS_PKG_FLUX    BIGINT,
   GPRS_LEFT_FLUX    BIGINT,
   GPRS_ROLLOVER_FLUX    BIGINT,
   GPRS_USE_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'=',','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_12593_USR_DAY;
CREATE EXTERNAL TABLE NG3.TW_12593_USR_DAY (
   TM_INTRVL_CD    INT,
   USR_MOB_NBR    STRING,
   HR_IND    STRING,
   TOLL_TYP_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   DEBET_DUR    INT,
   DEBET_FEE    DECIMAL(12,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_FORWARD_189_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_FORWARD_189_D (
   USR_MOB_NBR    STRING,
   A_BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   B_NBR    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USR_PRVC_ACTCALL_MO_TMP_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_PRVC_ACTCALL_MO_TMP_DAY (
   USR_NBR    STRING,
   CALL_AREA_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    INT,
   ACTCALL_DAYS    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_SPLAN_USR_4G_FLUX_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_SPLAN_USR_4G_FLUX_D (
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   CALL_DT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_SPLAN_USR_4G_FLUX_EXPED_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_SPLAN_USR_4G_FLUX_EXPED_D (
   USR_NBR    STRING,
   USR_ID    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_USR_INTRCRS_MO_TMP_DAY;
CREATE EXTERNAL TABLE NG3.TW_USR_INTRCRS_MO_TMP_DAY (
   TM_INTRVL_CD    INT,
   USR_NBR    STRING,
   B_NBR    STRING,
   B_AREA_CD    STRING,
   BRND_CD    INT,
   CMCC_BRANCH_CD    STRING,
   ACTVCALL_CNT    INT,
   BYCALL_CNT    INT,
   ACTVCALL_FEE    STRING,
   BYCALL_FEE    STRING,
   ACTVCALL_DUR    INT,
   ACTVCALL_DEBET_DUR    INT,
   BYCALL_DUR    INT,
   BYCALL_DEBET_DUR    INT,
   ROAM_ACTVCALL_CNT    INT,
   ROAM_BYCALL_CNT    INT,
   ROAM_ACTVCALL_DUR    INT,
   ROAM_ACTVCALL_DEBET_DUR    INT,
   ROAM_BYCALL_DUR    INT,
   ROAM_BYCALL_DEBET_DUR    INT,
   B_BRND_CD    INT,
   SMS_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_IMEI_USRCALL_MO_TMP_DAY;
CREATE EXTERNAL TABLE NG3.TW_IMEI_USRCALL_MO_TMP_DAY (
   TM_INTRVL_CD    INT,
   USR_NBR    STRING,
   IMEI    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    INT,
   VOCCALL_CNT    INT,
   VOCCALL_DUR    INT,
   DEBET_DUR    INT,
   GPRS_FLUX    BIGINT,
   TOT_FEE    STRING,
   NET2G_VOCCALL_CNT    INT,
   NET2G_VOCCALL_DUR    INT,
   NET2G_DEBET_DUR    INT,
   NET2G_GPRS_FLUX    BIGINT,
   NET2G_TOT_FEE    STRING,
   NET3G_VOCCALL_CNT    INT,
   NET3G_DEBET_DUR    INT,
   NET3G_VOCCALL_DUR    INT,
   NET3G_GPRS_FLUX    BIGINT,
   NET3G_TOT_FEE    STRING,
   NET4G_VOCCALL_CNT    INT,
   NET4G_DEBET_DUR    INT,
   NET4G_VOCCALL_DUR    INT,
   NET4G_GPRS_FLUX    BIGINT,
   NET4G_TOT_FEE    STRING,
   PROV_VOCCALL_CNT    INT,
   PROV_VOCDEBET_DUR    INT,
   ACTCALL_DAYS    INT,
   T_GPRS_CALLCNT    INT,
   G_GPRS_CALLCNT    INT,
   TDLTE_GPRS_CALLCNT    INT,
   PROV_GPRS_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TO_P_234G_LACI_D;
CREATE EXTERNAL TABLE NG3.TO_P_234G_LACI_D (
   HOUR_ID    INT,
   MSISDN    STRING,
   STAT_DT    INT,
   TOP1_INDATE    INT,
   TOP1_LACI_NAME    STRING,
   TOP1_LACI    STRING,
   TOP1_TYPE    STRING,
   TOP2_INDATE    INT,
   TOP2_LACI_NAME    STRING,
   TOP2_LACI    STRING,
   TOP2_TYPE    STRING,
   TOP3_INDATE    INT,
   TOP3_LACI_NAME    STRING,
   TOP3_LACI    STRING,
   TOP3_TYPE    STRING,
   MOCTCMOMTSMSMM_MSC_C_006    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'=',','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TS_PERS_USR_BAL_D;
CREATE EXTERNAL TABLE NG3.TS_PERS_USR_BAL_D (
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   USR_ID    STRING,
   BRND_CD    SMALLINT,
   USR_STS_CD    STRING,
   BASE_ACCT_AMT    DECIMAL(16,2),
   GIFT_ACCT_AMT    DECIMAL(16,2),
   AVL_TOT_ACCT_AMT    DECIMAL(16,2),
   PRE_NEFF_ACCT_AMT    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT    DECIMAL(16,2),
   TOT_ACCT_AMT    DECIMAL(16,2),
   MO_RTN_AMT    DECIMAL(16,2),
   MO_GIFT_AMT    DECIMAL(16,2),
   OSS_NAM    STRING,
   NEFF_GIFT_BAL_MAX_RTN_DT    INT,
   NEFF_BASE_BAL_MAX_RTN_DT    INT,
   STAT_DT    INT,
   BASE_NEFF_ACCT_AMT1    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT2    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT3    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT4    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT5    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT6    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT7    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT8    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT9    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT10    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT11    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT12    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT_UP12    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT1    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT2    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT3    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT4    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT5    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT6    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT7    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT8    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT9    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT10    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT11    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT12    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT_UP12    DECIMAL(16,2),
   BASE_CASH_ACCT_AMT    DECIMAL(16,2),
   BASE_CARD_ACCT_AMT    DECIMAL(16,2),
   BASE_PRINCIPAL_ACCT_AMT    DECIMAL(16,2),
   BASE_OFFSET_ACCT_AMT    DECIMAL(16,2),
   BASE_BOND_ACCT_AMT    DECIMAL(16,2),
   GIFT_GENERAL_ACCT_AMT    DECIMAL(16,2),
   GIFT_NB_ACCT_AMT    DECIMAL(16,2),
   GIFT_LABOR_ACCT_AMT    DECIMAL(16,2)
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PRDCT_FREE_RES_D;
CREATE EXTERNAL TABLE NG3.TW_PRDCT_FREE_RES_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   BASS_PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   PKG_VALUE    DECIMAL(20,2),
   PKG_LEFT_VALUE    DECIMAL(20,2),
   PKG_ROLLOVER_VALUE    DECIMAL(20,2),
   RESOURCE_TYPE    SMALLINT,
   USR_FREE_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TO_PERS_BRND_D;
CREATE EXTERNAL TABLE NG3.TO_PERS_BRND_D (
   USR_NBR    STRING,
   START_DT    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PRDCT_CD    SMALLINT,
   END_DT    INT,
   GBRND_IND    SMALLINT
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TR_GSMTDLTE_CELL;
CREATE EXTERNAL TABLE NG3.TR_GSMTDLTE_CELL (
   CELL_CGI    STRING,
   RES_NE_ID    STRING,
   NE_NAM    STRING,
   NE_FULL_NAM    STRING,
   NCKNM    STRING,
   OMC_NE_CNAM    STRING,
   CORP_NAM    STRING,
   CORP_ENAM    STRING,
   NE_STS    STRING,
   NE_INNET_DT    STRING,
   MAINTEGERAIN_DDLN_DT    STRING,
   NET_CLASS_LVL1    STRING,
   NET_CLASS_LVL2    STRING,
   NET_LAYER    STRING,
   NE_TYP    STRING,
   MANF_NAM    STRING,
   DEVC_TYP_NO    STRING,
   DEVC_SC_NO    STRING,
   AST_CD    STRING,
   HARDWE_VER    STRING,
   SFTWE_VER    STRING,
   PROVINCE_NAM    STRING,
   CITY_NAM    STRING,
   SITE_NAM    STRING,
   ROOM_NAM    STRING,
   ROOM_ID    STRING,
   CABINET    STRING,
   PROJ_CYC    STRING,
   CMCC_MNG    STRING,
   CTY_BRANCH_MNG    STRING,
   REMARK    STRING,
   DIST_NAM    STRING,
   VIP_BTS    STRING,
   COV_SCENE    STRING,
   INPV_CELL_IND    STRING,
   BELONGS_RNC_ID    STRING,
   BELONGS_OMC    STRING,
   BELONGS_NODEB_ID    STRING,
   CELL_LAC    INT,
   CELL_CI    INT,
   UARFCN    STRING,
   MKT_AREA_LVL1    STRING,
   MKT_AREA_LVL2    STRING,
   OUTPV_CELL_IND    STRING,
   COV_NEBY_AREA    STRING,
   COV_NEBY_AREA_NO    STRING,
   COV_NEBY_AREA_LAC    STRING,
   DTLIMIT_LIST    STRING,
   AREA_LIST    STRING,
   CELL_SAC    STRING,
   SEC_SYNC_CHNL_POWER    STRING,
   SCH_CHNL_POWER    STRING,
   TRX_NBR    STRING,
   VIP_BTS_TYP    STRING,
   UP_FREQ    STRING,
   DOWN_FREQ    STRING,
   UTRAN_LIST    STRING,
   MIN_RECV_OFF    STRING,
   DPCH_CNT    STRING,
   DWPCH_POWER    STRING,
   HSDPA_ACT_FLAG    STRING,
   HSDPA_FLAG    STRING,
   HCS_PRRT    STRING,
   MAX_FACH_CHNL_POWER    STRING,
   BRDCST_CHNL_POWER    STRING,
   CELL_MDE    STRING,
   CELL_PARAM_ID    STRING,
   CELL_LVL    STRING,
   MAIN_SYNC_CHNL_POWER    STRING,
   MAIN_TROUBLE_NBR    STRING,
   MAIN_CHNL_POWER    STRING,
   PCH_CHNL_POWER    STRING,
   PUNISH_TM    STRING,
   MAIN_CCPCH_POWER    STRING,
   HCS_LVL    STRING,
   FUNC_LIST    STRING,
   CELL_INTEGERRVL_TM    STRING,
   MIN_RECV    STRING,
   CELL_RAC    STRING,
   SFB_INCTOR    STRING,
   LCL_CELL_ID    INT,
   MAX_UP_SEND_POWER    STRING,
   MICH_CHNL_CNT    STRING,
   MAX_SEND_POWER    STRING,
   CELL_MBMS_FLAG    STRING,
   CELL_MBM_CNT    STRING,
   CELL_LATITUDE    STRING,
   CELL_LONGITUDE    STRING,
   MAST_PROV    STRING,
   INSIDE_ID    STRING,
   CELL_IUB    STRING,
   BRUUP_NBR    STRING,
   BRUDL_NBR    STRING,
   COV_CTY    STRING,
   COV_DIST    STRING,
   COV_TOWN    STRING,
   SCHL_NAM    STRING,
   AREA_TYP    STRING,
   INDP_CELL_IND    STRING,
   COV_TYP    STRING,
   BORDER_CELL_TYP    STRING,
   CHNL_PT    STRING,
   BUSI_PORT    STRING,
   TIME_STAMP    STRING,
   DT_CELL_LATITUDE    STRING,
   DT_CELL_LONGITUDE    STRING,
   INDP_COV_DIST    STRING,
   MA_OR_MI_CELL    STRING,
   BTS_ID    INT,
   BAK_BSC_ID    INT,
   BSC_ID    INT,
   COV_AREA    STRING,
   BUSI_PORT1    STRING,
   BUSI_PORT2    STRING,
   GW_CNT    INT,
   CELL_RBLT    STRING,
   CELL_TYP    STRING,
   FREQ_SECTION    STRING,
   CNAM_FLAG    STRING,
   CELL_LAI    STRING,
   CELL_RAI    STRING,
   CELL_BCCHNO    STRING,
   CELL_TCH    STRING,
   CELL_SDCCH    STRING,
   CELL_TG    STRING,
   CELL_RSITE    STRING,
   SUPP_EGPRS_IND    STRING,
   GPRS_DYN_CNFG_CNT    INT,
   GPRS_STATIC_CNFG_CNT    INT,
   FUSPD_TCH_CNT    INT,
   G900_G1800_CARRIER_FRE_CNT    INT,
   G900_CARRIER_FRE_CNT    INT,
   MCELL    STRING,
   COV_CELL_IND    STRING,
   COV_RADIUS    STRING,
   FIBER_BASE_IND    STRING,
   INCLUDE_REPEATER_IND    STRING,
   REPEATER_TYP    STRING,
   SYS_FLAG    STRING,
   PULL_CELL_IND    STRING,
   UP_DOWN_F    STRING,
   SPCL_F_TS    STRING,
   CENTER_CFN_ID    STRING,
   E_NODEB    STRING,
   TRANS_RRU    STRING,
   TRANS_ANT    STRING,
   USER_CFN    STRING,
   USER_CFN_CNT    STRING,
   CFN_CNT    INT,
   CELL_TAC    INT,
   PCI    INT,
   BS_TYP    STRING,
   LOCAL_CD    STRING,
   CELL_CD    STRING
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TO_NET_CS_2G_3G_CDR_D;
CREATE EXTERNAL TABLE NG3.TO_NET_CS_2G_3G_CDR_D (
   BTIME    STRING,
   ETIME    STRING,
   SERVICE_TYPE    SMALLINT,
   NI    SMALLINT,
   ACCESS_TYPE    SMALLINT,
   OPC    INT,
   DPC    INT,
   LAC    INT,
   CI    INT,
   OLAC    INT,
   OCI    INT,
   DLAC    INT,
   DCI    INT,
   FIRSTLAC    INT,
   FIRSTCI    INT,
   LASTLAC    INT,
   LASTCI    INT,
   USR_NBR    STRING,
   B_NBR    STRING,
   CALLINGIMSI    STRING,
   CALLEDIMSI    STRING,
   CALLINGIMEI    STRING,
   CALLEDIMEI    STRING,
   SRVSTAT    SMALLINT,
   HANDOUTREQUIRECAUSE    INT,
   HANDOUTOFFSET    INT,
   HANDOUTRSPOFFSET    INT,
   HANDINOFFSET    INT,
   HANDINRSPOFFSET    INT,
   ALERT_TIME    BIGINT,
   CONN_TIME    BIGINT,
   CALL_DUR    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NET_CONT_PARSE_D;
CREATE EXTERNAL TABLE NG3.TW_NET_CONT_PARSE_D (
   HOUR_ID    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   PARSE_1    STRING,
   PARSE_2    STRING,
   PARSE_3    STRING,
   CONT_CATE_LV1    STRING,
   CONT_CATE_LV2    STRING,
   CONT_CATE_LV3    STRING,
   CONT_CATE_LV4    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NET_KEYWD_D;
CREATE EXTERNAL TABLE NG3.TW_NET_KEYWD_D (
   HOUR_ID    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   KEYWD    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NET_SITE_D;
CREATE EXTERNAL TABLE NG3.TW_NET_SITE_D (
   HOUR_ID    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   SITE_TYP_ID    INT,
   SITE_TYP_NAM    STRING,
   SITE_ID    INT,
   SITE_NAM    STRING,
   SITE_CATEGO_ID    INT,
   SITE_CATEGO_NAM    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT,
   CONT_CATE_TYP_NAM    STRING,
   CONT_CATE_NAM    STRING,
   CONT_NAM    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='UTF-8');

DROP TABLE IF EXISTS NG3.TW_NET_SR_D;
CREATE EXTERNAL TABLE NG3.TW_NET_SR_D (
   HOUR_ID    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   SR_ENTER_ID    INT,
   SR_ENTER_NAM    STRING,
   SR_SERVER_ID    INT,
   SR_SERVER_NAM    STRING,
   SR_SOURCE_ID    INT,
   SR_SOURCE_NAM    STRING,
   SR_CONT_TYP_ID    INT,
   SR_CONT_TYP_NAM    STRING,
   SR_SP_ID    INT,
   SR_SP_NAM    STRING,
   SR_IS_FREE_BUS    STRING,
   SR_ACTION_ID    INT,
   SR_ACTION_NAM    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT,
   NETPLAY_DUR    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_P_234G_LACI_D;
CREATE EXTERNAL TABLE NG3.TW_P_234G_LACI_D (
   HOUR_ID    INT,
   USR_NBR    STRING,
   IMEI    STRING,
   STAT_DT    INT,
   TOP1_INDATE    INT,
   TOP1_LACI_NAME    STRING,
   TOP1_LACI    STRING,
   TOP1_TYPE    STRING,
   TOP2_INDATE    INT,
   TOP2_LACI_NAME    STRING,
   TOP2_LACI    STRING,
   TOP2_TYPE    STRING,
   TOP3_INDATE    INT,
   TOP3_LACI_NAME    STRING,
   TOP3_LACI    STRING,
   TOP3_TYPE    STRING,
   MOCTCMOMTSMSMM_MSC_C_006    INT,
   IMSI    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='UTF-8');

DROP TABLE IF EXISTS NG3.TW_PERS_TOPN_APP_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_TOPN_APP_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   TOP1_APP_CD    STRING,
   TOP1_APP_NAM    STRING,
   TOP1_APP_FLUX    BIGINT,
   TOP2_APP_CD    STRING,
   TOP2_APP_NAM    STRING,
   TOP2_APP_FLUX    BIGINT,
   TOP3_APP_CD    STRING,
   TOP3_APP_NAM    STRING,
   TOP3_APP_FLUX    BIGINT,
   TOP4_APP_CD    STRING,
   TOP4_APP_NAM    STRING,
   TOP4_APP_FLUX    BIGINT,
   TOP5_APP_CD    STRING,
   TOP5_APP_NAM    STRING,
   TOP5_APP_FLUX    BIGINT,
   TOP6_APP_CD    STRING,
   TOP6_APP_NAM    STRING,
   TOP6_APP_FLUX    BIGINT,
   TOP7_APP_CD    STRING,
   TOP7_APP_NAM    STRING,
   TOP7_APP_FLUX    BIGINT,
   TOP8_APP_CD    STRING,
   TOP8_APP_NAM    STRING,
   TOP8_APP_FLUX    BIGINT,
   TOP9_APP_CD    STRING,
   TOP9_APP_NAM    STRING,
   TOP9_APP_FLUX    BIGINT,
   TOP10_APP_CD    STRING,
   TOP10_APP_NAM    STRING,
   TOP10_APP_FLUX    BIGINT,
   TOP11_APP_CD    STRING,
   TOP11_APP_NAM    STRING,
   TOP11_APP_FLUX    BIGINT,
   TOP12_APP_CD    STRING,
   TOP12_APP_NAM    STRING,
   TOP12_APP_FLUX    BIGINT,
   TOP13_APP_CD    STRING,
   TOP13_APP_NAM    STRING,
   TOP13_APP_FLUX    BIGINT,
   TOP14_APP_CD    STRING,
   TOP14_APP_NAM    STRING,
   TOP14_APP_FLUX    BIGINT,
   TOP15_APP_CD    STRING,
   TOP15_APP_NAM    STRING,
   TOP15_APP_FLUX    BIGINT,
   TOP16_APP_CD    STRING,
   TOP16_APP_NAM    STRING,
   TOP16_APP_FLUX    BIGINT,
   TOP17_APP_CD    STRING,
   TOP17_APP_NAM    STRING,
   TOP17_APP_FLUX    BIGINT,
   TOP18_APP_CD    STRING,
   TOP18_APP_NAM    STRING,
   TOP18_APP_FLUX    BIGINT,
   TOP19_APP_CD    STRING,
   TOP19_APP_NAM    STRING,
   TOP19_APP_FLUX    BIGINT,
   TOP20_APP_CD    STRING,
   TOP20_APP_NAM    STRING,
   TOP20_APP_FLUX    BIGINT,
   OTH_APP_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_TRACK_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_TRACK_D (
   STAT_DT    INT,
   IN_TIME    STRING,
   USR_NBR    STRING,
   OLAC_ID    STRING,
   OCELL_ID    STRING,
   NLAC_ID    STRING,
   NCELL_ID    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='UTF-8');

DROP TABLE IF EXISTS NG3.TW_PERS_RESIDENCE_TIME_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_RESIDENCE_TIME_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   LAC_ID    STRING,
   CELL_ID    STRING,
   IN_TIME    STRING,
   OUT_TIME    STRING,
   RESIDENCE_DUR    INT,
   CALL_CNT    INT,
   IMSI    STRING,
   IMEI    STRING,
   LOCAL_CD    STRING,
   CELL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='UTF-8');

DROP TABLE IF EXISTS NG3.TW_NET_CONT_CATE_D;
CREATE EXTERNAL TABLE NG3.TW_NET_CONT_CATE_D (
   HOUR_ID    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   CONT_CATE_LV1    STRING,
   CONT_CATE_LV2    STRING,
   CONT_CATE_LV3    STRING,
   CONT_CATE_LV4    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_ONOFF_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_ONOFF_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   ON_CNT    INT,
   OFF_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_TOPN_KEYWD_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_TOPN_KEYWD_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   TOP1_KEYWD    STRING,
   TOP1_KEYWD_CNT    BIGINT,
   TOP1_KEYWD_FLUX    BIGINT,
   TOP2_KEYWD    STRING,
   TOP2_KEYWD_CNT    BIGINT,
   TOP2_KEYWD_FLUX    BIGINT,
   TOP3_KEYWD    STRING,
   TOP3_KEYWD_CNT    BIGINT,
   TOP3_KEYWD_FLUX    BIGINT,
   TOP4_KEYWD    STRING,
   TOP4_KEYWD_CNT    BIGINT,
   TOP4_KEYWD_FLUX    BIGINT,
   TOP5_KEYWD    STRING,
   TOP5_KEYWD_CNT    BIGINT,
   TOP5_KEYWD_FLUX    BIGINT,
   TOP6_KEYWD    STRING,
   TOP6_KEYWD_CNT    BIGINT,
   TOP6_KEYWD_FLUX    BIGINT,
   TOP7_KEYWD    STRING,
   TOP7_KEYWD_CNT    BIGINT,
   TOP7_KEYWD_FLUX    BIGINT,
   TOP8_KEYWD    STRING,
   TOP8_KEYWD_CNT    BIGINT,
   TOP8_KEYWD_FLUX    BIGINT,
   TOP9_KEYWD    STRING,
   TOP9_KEYWD_CNT    BIGINT,
   TOP9_KEYWD_FLUX    BIGINT,
   TOP10_KEYWD    STRING,
   TOP10_KEYWD_CNT    BIGINT,
   TOP10_KEYWD_FLUX    BIGINT,
   TOP11_KEYWD    STRING,
   TOP11_KEYWD_CNT    BIGINT,
   TOP11_KEYWD_FLUX    BIGINT,
   TOP12_KEYWD    STRING,
   TOP12_KEYWD_CNT    BIGINT,
   TOP12_KEYWD_FLUX    BIGINT,
   TOP13_KEYWD    STRING,
   TOP13_KEYWD_CNT    BIGINT,
   TOP13_KEYWD_FLUX    BIGINT,
   TOP14_KEYWD    STRING,
   TOP14_KEYWD_CNT    BIGINT,
   TOP14_KEYWD_FLUX    BIGINT,
   TOP15_KEYWD    STRING,
   TOP15_KEYWD_CNT    BIGINT,
   TOP15_KEYWD_FLUX    BIGINT,
   TOP16_KEYWD    STRING,
   TOP16_KEYWD_CNT    BIGINT,
   TOP16_KEYWD_FLUX    BIGINT,
   TOP17_KEYWD    STRING,
   TOP17_KEYWD_CNT    BIGINT,
   TOP17_KEYWD_FLUX    BIGINT,
   TOP18_KEYWD    STRING,
   TOP18_KEYWD_CNT    BIGINT,
   TOP18_KEYWD_FLUX    BIGINT,
   TOP19_KEYWD    STRING,
   TOP19_KEYWD_CNT    BIGINT,
   TOP19_KEYWD_FLUX    BIGINT,
   TOP20_KEYWD    STRING,
   TOP20_KEYWD_CNT    BIGINT,
   TOP20_KEYWD_FLUX    BIGINT,
   OTH_KEYWD_CNT    BIGINT,
   OTH_KEYWD_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_TOPN_KEYWD_M;
CREATE EXTERNAL TABLE NG3.TW_PERS_TOPN_KEYWD_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   TOP1_KEYWD    STRING,
   TOP1_KEYWD_CNT    BIGINT,
   TOP1_KEYWD_FLUX    BIGINT,
   TOP2_KEYWD    STRING,
   TOP2_KEYWD_CNT    BIGINT,
   TOP2_KEYWD_FLUX    BIGINT,
   TOP3_KEYWD    STRING,
   TOP3_KEYWD_CNT    BIGINT,
   TOP3_KEYWD_FLUX    BIGINT,
   TOP4_KEYWD    STRING,
   TOP4_KEYWD_CNT    BIGINT,
   TOP4_KEYWD_FLUX    BIGINT,
   TOP5_KEYWD    STRING,
   TOP5_KEYWD_CNT    BIGINT,
   TOP5_KEYWD_FLUX    BIGINT,
   TOP6_KEYWD    STRING,
   TOP6_KEYWD_CNT    BIGINT,
   TOP6_KEYWD_FLUX    BIGINT,
   TOP7_KEYWD    STRING,
   TOP7_KEYWD_CNT    BIGINT,
   TOP7_KEYWD_FLUX    BIGINT,
   TOP8_KEYWD    STRING,
   TOP8_KEYWD_CNT    BIGINT,
   TOP8_KEYWD_FLUX    BIGINT,
   TOP9_KEYWD    STRING,
   TOP9_KEYWD_CNT    BIGINT,
   TOP9_KEYWD_FLUX    BIGINT,
   TOP10_KEYWD    STRING,
   TOP10_KEYWD_CNT    BIGINT,
   TOP10_KEYWD_FLUX    BIGINT,
   TOP11_KEYWD    STRING,
   TOP11_KEYWD_CNT    BIGINT,
   TOP11_KEYWD_FLUX    BIGINT,
   TOP12_KEYWD    STRING,
   TOP12_KEYWD_CNT    BIGINT,
   TOP12_KEYWD_FLUX    BIGINT,
   TOP13_KEYWD    STRING,
   TOP13_KEYWD_CNT    BIGINT,
   TOP13_KEYWD_FLUX    BIGINT,
   TOP14_KEYWD    STRING,
   TOP14_KEYWD_CNT    BIGINT,
   TOP14_KEYWD_FLUX    BIGINT,
   TOP15_KEYWD    STRING,
   TOP15_KEYWD_CNT    BIGINT,
   TOP15_KEYWD_FLUX    BIGINT,
   TOP16_KEYWD    STRING,
   TOP16_KEYWD_CNT    BIGINT,
   TOP16_KEYWD_FLUX    BIGINT,
   TOP17_KEYWD    STRING,
   TOP17_KEYWD_CNT    BIGINT,
   TOP17_KEYWD_FLUX    BIGINT,
   TOP18_KEYWD    STRING,
   TOP18_KEYWD_CNT    BIGINT,
   TOP18_KEYWD_FLUX    BIGINT,
   TOP19_KEYWD    STRING,
   TOP19_KEYWD_CNT    BIGINT,
   TOP19_KEYWD_FLUX    BIGINT,
   TOP20_KEYWD    STRING,
   TOP20_KEYWD_CNT    BIGINT,
   TOP20_KEYWD_FLUX    BIGINT,
   OTH_KEYWD_CNT    BIGINT,
   OTH_KEYWD_FLUX    BIGINT,
   KEYWD_CREDIT_CARD_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_VOLTE_USR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_VOLTE_USR_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   VOLTE_IMEI    STRING,
   VOLTE_TAC    STRING,
   VOLTE_TERM_BRND_NAM    STRING,
   VOLTE_TERM_DEVICE_NAM    STRING,
   VOLTE_1ACT_CALL_USR_IND    STRING,
   VOLTE_2ACT_CALL_USR_IND    STRING,
   VOLTE_1CALL_USR_IND    STRING,
   VOLTE_2CALL_USR_IND    STRING,
   OPEN_VOLTE_FUNC_IND    STRING,
   VOLTE_DEBET_DUR    BIGINT,
   VOLTE_ACT_DEBET_DUR    BIGINT,
   VOLTE_VID_DEBET_DUR    BIGINT,
   VOLTE_ACT_VID_DEBET_DUR    BIGINT,
   VOLTE_1ACT_NEW_USR_IND    STRING,
   DT_VOLTE_IMEI    STRING,
   DT_VOLTE_TAC    STRING,
   DT_VOLTE_TERM_BRND_NAM    STRING,
   DT_VOLTE_TERM_DEVICE_NAM    STRING,
   DT_VOLTE_2ACT_CALL_USR_IND    STRING,
   DT_VOLTE_2CALL_USR_IND    STRING,
   N_OPEN_VOLTE_FUNC_IND    STRING,
   VOLTE_BY_DEBET_DUR    BIGINT,
   VOLTE_BY_VID_DEBET_DUR    BIGINT,
   N_VOLTE_ACT_USR_IND    STRING,
   N_VOLTE_ACT_VID_USR_IND    STRING,
   VOLTE_1ACTV_USR_IND    STRING,
   N_VOLTE_1ACTV_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_NB_WLAN_TERMOS_BUSI_D;
CREATE EXTERNAL TABLE NG3.TW_NB_WLAN_TERMOS_BUSI_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   TERM_TYP_CD    STRING,
   OS_TYP_CD    STRING,
   WLAN_AUTO_IND    STRING,
   EWLAN_IND    STRING,
   CMCC_BRANCH_CD    STRING,
   WLAN_DEBET_DUR    INT,
   WLAN_FLUX    BIGINT,
   BRND_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TM_NET_SR_APP_D;
CREATE EXTERNAL TABLE NG3.TM_NET_SR_APP_D (
   STAT_DT    INT,
   SR_SERVER_ID    INT,
   SR_SERVER_NAM    STRING,
   SR_CONT_TYP_ID    INT,
   SR_CONT_TYP_NAM    STRING,
   USR_CNT    INT,
   M_USR_CNT    INT,
   GPRS_FLUX    BIGINT,
   TDLTE_GPRS_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_CORP_MBR_ORDER_D;
CREATE EXTERNAL TABLE NG3.TW_CORP_MBR_ORDER_D (
   STAT_DT    INT,
   GUSR_ID    STRING,
   USR_NBR    STRING,
   EFF_DT    INT,
   BASS_PRDCT_CD    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   BRND_CD    INT,
   GCUST_ID    STRING,
   CORP_PRDCT_CODE    STRING,
   CORP_PRDCT_NBR    STRING,
   CORP_USR_NBR    STRING,
   GROUP_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   CMCC_CNTRY_CD    STRING,
   CMCC_TOWN_CD    STRING,
   DGUSR_IND    STRING,
   DF_IND    STRING,
   REG_PRDCT_MBR_IND    STRING,
   VPMN_MBR_IND    STRING,
   DL100_USR_IND    STRING,
   IOT_TYP_CD    STRING,
   IOT_ATR_IND    STRING,
   SRC_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_LIVING_CIRCLE_M;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_LIVING_CIRCLE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING,
   BRND_CD    SMALLINT,
   UPDT_TYP_CD    STRING,
   UPDT_DT    INT,
   RESERVED_FIELD_1    STRING,
   RESERVED_FIELD_2    STRING,
   RESERVED_FIELD_3    STRING,
   RESERVED_FIELD_4    STRING
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_4GLIFE_M;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_4GLIFE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING,
   BRND_CD    SMALLINT,
   UPDT_TYP_CD    STRING,
   UPDT_DT    INT,
   RESERVED_FIELD_1    STRING,
   RESERVED_FIELD_2    STRING,
   RESERVED_FIELD_3    STRING,
   RESERVED_FIELD_4    STRING
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_BASIC_FEATURE_M;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_BASIC_FEATURE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING,
   BRND_CD    SMALLINT,
   UPDT_TYP_CD    STRING,
   UPDT_DT    INT,
   RESERVED_FIELD_1    STRING,
   RESERVED_FIELD_2    STRING,
   RESERVED_FIELD_3    STRING,
   RESERVED_FIELD_4    STRING
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_BEHAVIOR_HABIT_M;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_BEHAVIOR_HABIT_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING,
   BRND_CD    SMALLINT,
   UPDT_TYP_CD    STRING,
   UPDT_DT    INT,
   RESERVED_FIELD_1    STRING,
   RESERVED_FIELD_2    STRING,
   RESERVED_FIELD_3    STRING,
   RESERVED_FIELD_4    STRING
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_PERSONAL_TAILOR_M;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_PERSONAL_TAILOR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING,
   BRND_CD    SMALLINT,
   UPDT_TYP_CD    STRING,
   UPDT_DT    INT,
   RESERVED_FIELD_1    STRING,
   RESERVED_FIELD_2    STRING,
   RESERVED_FIELD_3    STRING,
   RESERVED_FIELD_4    STRING
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_USER_FILE_M;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_USER_FILE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING,
   BRND_CD    SMALLINT,
   UPDT_TYP_CD    STRING,
   UPDT_DT    INT,
   RESERVED_FIELD_1    STRING,
   RESERVED_FIELD_2    STRING,
   RESERVED_FIELD_3    STRING,
   RESERVED_FIELD_4    STRING
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_SPENDING_POWER_M;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_SPENDING_POWER_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING,
   BRND_CD    SMALLINT,
   UPDT_TYP_CD    STRING,
   UPDT_DT    INT,
   RESERVED_FIELD_1    STRING,
   RESERVED_FIELD_2    STRING,
   RESERVED_FIELD_3    STRING,
   RESERVED_FIELD_4    STRING
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TM_NB_CNTN_GPRS_SERV_D;
CREATE EXTERNAL TABLE NG3.TM_NB_CNTN_GPRS_SERV_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   IMSI    STRING,
   NET_TYP_CD    STRING,
   CALL_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TM_MMS_APP;
CREATE EXTERNAL TABLE NG3.TM_MMS_APP (
   COLLECT_DT    INT                ,
   Date_CD    INT                    ,
   Send_City_ID    BIGINT     ,
   Recv_city_id    BIGINT     ,
   Send_UserBrand_CD    INT,
   Recv_UserBrand_CD    INT,
   MM_CDRTYPE_CD    INT      ,
   MM_APPTYPE_CD    INT      ,
   MM_STATUS_CD    STRING     ,
   Total_MMS_VOL    BIGIN          ,
   Total_MMS_cnt    BIGIN          ,
   PAY_City_ID    BIGINT       ,
   PAY_UserBrand_CD    INT,
   NOFWD_MMS_CNT    BIGINT ,
   SP_CODE    BIGINT               ,
   NOFT_MMS_CNT    BIGINT               
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TM_MMSC_CNT;
CREATE EXTERNAL TABLE NG3.TM_MMSC_CNT (
   DATE_CD    INT,
   COLLECT_DT    INT,
   USER_ID    STRING,
   CITY_ID    BIGINT,
   USERBRAND_CD    INT,
   SYSTEM_ID    BIGINT,
   SP_CODE    BIGINT,
   SP_ID    STRING,
   SERVICE_ID    STRING,
   MM_CDRTYPE_CD    INT,
   MM_STATUS_CD    STRING,
   SEND_TMS    STRING,
   RECV_TMS    STRING,
   Send_MMSC_ID    BIGINT,
   Recv_MMSC_ID    BIGINT,
   MM_APPTYPE_CD    INT,
   Send_City_ID    BIGINT,
   Recv_city_id    BIGINT,
   Send_ADDR    STRING,
   Recv_ADDR    STRING,
   MMS_VOL    BIGINT,
   SMS_CNT    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TM_WAP_GWUSER_HR;
CREATE EXTERNAL TABLE NG3.TM_WAP_GWUSER_HR (
   HR_CD    INT,
   Date_CD    BIGINT,
   SYSTEM_ID    BIGINT,
   UserBrand_CD    INT,
   City_ID    BIGINT,
   WAPGW_IP    STRING,
   COLLECT_DT    BIGINT,
   SUM_GW_AVGDELAY_DUR    BIGINT,
   STREAM_VOL    BIGINT,
   UP_VOL    BIGINT,
   DOWN_VOL    BIGINT,
   USER_SUCC_CNT    BIGINT,
   SYS_SUCC_CNT    BIGINT,
   STD_SUCC_CNT    BIGINT,
   ACC_CNT    BIGINT,
   GW_DELAY_ACC_CNT    BIGINT,
   SUCC_ACC_CNT    BIGINT,
   NEW_SUCC_CNT    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TM_WAP_SPUSER_ACCDATE;
CREATE EXTERNAL TABLE NG3.TM_WAP_SPUSER_ACCDATE (
   COLLECT_DT    BIGINT,
   MSISDN    STRING,
   DATE_CD    BIGINT,
   SP_GROUP_NAM    STRING,
   HTTP_STATUS_CD    STRING,
   USERBRAND_CD    BIGINT,
   CITY_ID    BIGINT,
   STREAM_VOL    BIGINT,
   ACC_CNT    BIGINT,
   UP_VOL    BIGINT,
   DOWN_VOL    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TM_PERS_NEW_USR_D;
CREATE EXTERNAL TABLE NG3.TM_PERS_NEW_USR_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   DIST_ID    STRING,
   MICRODIST_ID    STRING,
   BUSI_USR_NBR    STRING,
   CHNL_STAR_LVL3_IND    STRING,
   CHNL_CD    STRING,
   CHNL_STS_CD    STRING,
   BRND_CD    SMALLINT,
   BASS_PRDCT_CD    STRING,
   BASS_PRDCT_NAM    STRING,
   MAIN_PRDCT_CD    STRING,
   MAIN_PRDCT_NAM    STRING,
   DSSB_NEW_USR_CNT    INT,
   SMDJ_NEW_USR_CNT    INT,
   TKGX_NEW_USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TM_PRDCT_BUSI_HANDLE_D;
CREATE EXTERNAL TABLE NG3.TM_PRDCT_BUSI_HANDLE_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   DIST_ID    STRING,
   MICRODIST_ID    STRING,
   BUSI_USR_NBR    STRING,
   CHNL_STAR_LVL3_IND    STRING,
   CHNL_CD    STRING,
   CHNL_STS_CD    STRING,
   ACCEPT_OPR_ID    STRING,
   BUSI_ACCEPT_NBR    STRING,
   ACCEPT_DT    INT,
   ACCEPT_TIM    STRING,
   BASS_PRDCT_CD    STRING,
   BASS_PRDCT_NAM    STRING,
   OPR_TYP    STRING,
   WORKF_TYP_CD    STRING,
   MENU_ID    STRING,
   IN_SYSTEM    STRING,
   ORDER_ID    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TM_CHNL_MNTR_KPI_D;
CREATE EXTERNAL TABLE NG3.TM_CHNL_MNTR_KPI_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   DIST_ID    STRING,
   MICRODIST_ID    STRING,
   BUSI_USR_NBR    STRING,
   CHNL_STAR_LVL3_IND    STRING,
   CHNL_CD    STRING,
   CHNL_STS_CD    STRING,
   ITEM_CD    STRING,
   ITEM_VALUE    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TM_CHNL_MNTR_TERMKPI_D;
CREATE EXTERNAL TABLE NG3.TM_CHNL_MNTR_TERMKPI_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   DIST_ID    STRING,
   MICRODIST_ID    STRING,
   BUSI_USR_NBR    STRING,
   CHNL_STAR_LVL3_IND    STRING,
   CHNL_CD    STRING,
   CHNL_STS_CD    STRING,
   TERM_BRND_NAM    STRING,
   TRML_CD    STRING,
   ITEM_CD    STRING,
   ITEM_VALUE    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TM_TARGET_USR_4GINVERT_D;
CREATE EXTERNAL TABLE NG3.TM_TARGET_USR_4GINVERT_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   ACTIVITY_TYP    STRING,
   USR_CNT    INT,
   P365D_GEN_4GFLUX_USRCNT    INT,
   P30D_GEN_4GFLUX_USRCNT    INT,
   DMON_GEN_4GFLUX_USRCNT    INT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_OPENTODMP;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_OPENTODMP (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING,
   BRND_CD    SMALLINT,
   UPDT_TYP_CD    STRING,
   UPDT_DT    INT,
   RESERVED_FIELD_1    STRING,
   RESERVED_FIELD_2    STRING,
   RESERVED_FIELD_3    STRING,
   RESERVED_FIELD_4    STRING,
   MD5_IMEI    STRING
)
PARTITIONED BY (branch STRING)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_NETPLAY_BEHAVIOR_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_NETPLAY_BEHAVIOR_D (
   MSISDN    STRING,
   IMSI    STRING,
   IMEI    STRING,
   ROAM_TRAVEL_FLAG    STRING,
   FLUX_BG_CLASS_TOP1    STRING,
   FLUX_SM_CLASS_TOP1    STRING,
   FLUX_BG_CLASS_TOP2    STRING,
   FLUX_SM_CLASS_TOP2    STRING,
   FLUX_BG_CLASS_TOP3    STRING,
   FLUX_SM_CLASS_TOP3    STRING,
   FLUX_BG_CLASS_TOP4    STRING,
   FLUX_SM_CLASS_TOP4    STRING,
   FLUX_BG_CLASS_TOP5    STRING,
   FLUX_SM_CLASS_TOP5    STRING,
   DUR_BG_CLASS_TOP1    STRING,
   DUR_SM_CLASS_TOP1    STRING,
   DUR_BG_CLASS_TOP2    STRING,
   DUR_SM_CLASS_TOP2    STRING,
   DUR_BG_CLASS_TOP3    STRING,
   DUR_SM_CLASS_TOP3    STRING,
   DUR_BG_CLASS_TOP4    STRING,
   DUR_SM_CLASS_TOP4    STRING,
   DUR_BG_CLASS_TOP5    STRING,
   DUR_SM_CLASS_TOP5    STRING,
   REQ_KEYWORD1    STRING,
   REQ_KEYWORD2    STRING,
   REQ_KEYWORD3    STRING,
   REQ_KEYWORD4    STRING,
   REQ_KEYWORD5    STRING,
   REQ_KEYWORD6    STRING,
   REQ_KEYWORD7    STRING,
   REQ_KEYWORD8    STRING,
   REQ_KEYWORD9    STRING,
   REQ_KEYWORD10    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TW_PERS_LAB_TRAVEL_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_LAB_TRAVEL_D (
   MSISDN    STRING,
   IMSI    STRING,
   IMEI    STRING,
   ROAM_TRAVEL_FLAG    STRING,
   EVENT_LAB    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TM_TIMES_OPER_MNTR_KPI_D;
CREATE EXTERNAL TABLE NG3.TM_TIMES_OPER_MNTR_KPI_D (
   STAT_DT    INT,
   CMCC_BRANCH_CD    STRING,
   AREA_ID    STRING,
   CHNL_CD    STRING,
   OPR_CD    STRING,
   OPR_NAM    STRING,
   OPR_TYP    STRING,
   CHNL_MAG_NAM    STRING,
   ITEM_CD    STRING,
   ITEM_VALUE    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_CMPT_FST_LOCALCALL_D;
CREATE EXTERNAL TABLE NG3.TW_CMPT_FST_LOCALCALL_D (
   STAT_DT    INT,
   COOPR_NBR    STRING,
   COOPR_CD    STRING,
   COOPR_BRND_CD    SMALLINT,
   COOPR_AREA_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   A_CMCC_BRANCH_CD    STRING,
   A_BRND_CD    SMALLINT,
   A_MOB_NBR    STRING,
   FIRST_LOCAL_CALL_DT    INT,
   FIRST_LOCAL_CALL_TIM    INT,
   FIRST_LOCAL_LOCAL_CD    STRING,
   FIRST_LOCAL_CELL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE;

DROP TABLE IF EXISTS NG3.TYJ_PERS_NET_BUSI_D;
CREATE EXTERNAL TABLE NG3.TYJ_PERS_NET_BUSI_D (
   USR_NBR    STRING,
   GROUP_SOFT_CD    INT,
   GROUP_SOFT_NAM    STRING,
   GROUP_SOFT_TYP_CD    INT,
   GROUP_SOFT_TYP_NAM    STRING,
   NET_TYP_CD    INT,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_BIXF_HARASS_CALL_REPORT_D;
CREATE EXTERNAL TABLE NG3.TW_BIXF_HARASS_CALL_REPORT_D (
   STAT_DT    INT,
   BE_REPORT_NBR    STRING,
   BE_REPORT_AREA_CD    STRING,
   REPORT_NBR    STRING,
   REPORT_CHNL_NAM    STRING,
   REPORT_TYP    SMALLINT,
   REPORT_TIM    STRING,
   IS_HARASS_NBR    SMALLINT,
   BE_REPORT_NBR_CHNL_NAM    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS NG3.TW_PERS_USR_RESIDENCE_D;
CREATE EXTERNAL TABLE NG3.TW_PERS_USR_RESIDENCE_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   IMSI    STRING,
   IMEI    STRING,
   INDATE_CNT    BIGINT,
   ROAM_TYPE    STRING,
   CNTRY_CD    STRING,
   PROV_CD    STRING,
   CITY_CD    STRING,
   FIRST_LAC_ID    STRING,
   FIRST_CELL_ID    STRING,
   FIRST_LOCAL_CD    STRING,
   FIRST_CELL_CD    STRING,
   DT_FIRST_TIME    STRING,
   LAST_LAC_ID    STRING,
   LAST_CELL_ID    STRING,
   LAST_LOCAL_CD    STRING,
   LAST_CELL_CD    STRING,
   DT_LAST_TIME    STRING
)
PARTITIONED BY (branch STRING,month INT,day INT)
STORED AS PARQUET
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');


