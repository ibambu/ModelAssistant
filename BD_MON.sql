----bd_mon租户脚本----
DROP TABLE IF EXISTS JCFW.TW_PERS_4G_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_4G_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   COMMON_IMEI    STRING,
   TERM_TYP_CD    SMALLINT,
   A4G_BRND_PRDCT_CD    STRING,
   A4G_PRDCT_CD    STRING,
   LTE_4G_TERM_IND    SMALLINT,
   LTE_4G_NET_IND    SMALLINT,
   USE_USIM_IND    STRING,
   OPEN_4G_FUNC_IND    STRING,
   A4G_PKG_USR_IND    STRING,
   A4G_POTENTIAL_USR_IND    STRING,
   A4G_PHONE_PKG_USR_IND    STRING,
   A4G_KPI_USR_IND    STRING,
   A4G_MNEW_PKG_USR_IND    STRING,
   TERM_KIND    SMALLINT,
   EFF_DT    INT,
   ORDR_N_USR_IND    STRING,
   ORDR_N_BASS_PRDCT_CD    STRING,
   ORDR_N_NEW_CHNL_CD    STRING,
   USIM_CHNL_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   A4G_LOST_USR_IND    STRING,
   LOST_4G_USRTYP_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_4G_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_USR_BAL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_USR_BAL_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   USR_ID    STRING,
   BRND_CD    SMALLINT,
   USR_STS_CD    STRING,
   BASE_ACCT_AMT    DECIMAL(16,2),
   GIFT_ACCT_AMT    DECIMAL(16,2),
   AVL_TOT_ACCT_AMT    DECIMAL(16,2),
   PRE_NEFF_ACCT_AMT    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT    DECIMAL(16,2),
   TOT_ACCT_AMT    DECIMAL(16,2),
   MO_RTN_AMT    DECIMAL(16,2),
   MO_GIFT_AMT    DECIMAL(16,2),
   OSS_NAM    STRING,
   NEFF_GIFT_BAL_MAX_RTN_DT    INT,
   NEFF_BASE_BAL_MAX_RTN_DT    INT,
   BASE_NEFF_ACCT_AMT1    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT2    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT3    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT4    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT5    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT6    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT7    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT8    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT9    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT10    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT11    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT12    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT_UP12    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT1    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT2    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT3    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT4    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT5    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT6    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT7    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT8    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT9    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT10    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT11    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT12    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT_UP12    DECIMAL(16,2),
   BASE_CASH_ACCT_AMT    DECIMAL(16,2),
   BASE_CARD_ACCT_AMT    DECIMAL(16,2),
   BASE_PRINCIPAL_ACCT_AMT    DECIMAL(16,2),
   BASE_OFFSET_ACCT_AMT    DECIMAL(16,2),
   BASE_BOND_ACCT_AMT    DECIMAL(16,2),
   GIFT_GENERAL_ACCT_AMT    DECIMAL(16,2),
   GIFT_NB_ACCT_AMT    DECIMAL(16,2),
   GIFT_LABOR_ACCT_AMT    DECIMAL(16,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_USR_BAL_M';

DROP TABLE IF EXISTS JCFW.TW_IMEI_USR_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_IMEI_USR_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   IMEI    STRING,
   CMCC_BRANCH_CD    STRING,
   IMEI_TERM_CD    SMALLINT,
   BRND_CD    SMALLINT,
   TAC    STRING,
   STS_IND    STRING,
   DEBET_DUR    INT,
   VOCCALL_CNT    INT,
   TOT_FEE    DECIMAL(10,2),
   CMN_USE_IND    STRING,
   GPRS_FLUX    BIGINT,
   CMN_USE_NBR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_IMEI_USR_BUSI_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_PERS_VOC_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_VOC_BUSI_M (
   USR_NBR    STRING,
   STAT_MO    INT,
   VOC_CDR_FEE    DECIMAL(10,2),
   NORM_VOC_CDR_FEE    DECIMAL(10,2),
   ACTVCALL_FEE    DECIMAL(10,2),
   FWD_ACTVCALL_FEE    DECIMAL(10,2),
   ACTV_CALL_NFWD_FEE    DECIMAL(10,2),
   BYCALL_FEE    DECIMAL(10,2),
   FWD_BYCALL_FEE    DECIMAL(10,2),
   BYCALL_NFWD_FEE    DECIMAL(10,2),
   INNER_CALL_FEE    DECIMAL(10,2),
   EXTNL_CALL_FEE    DECIMAL(10,2),
   CITY_CALL_FEE    DECIMAL(10,2),
   PROV_TOLL_FEE    DECIMAL(10,2),
   CNTRY_TOLL_FEE    DECIMAL(10,2),
   HMT_TOLL_FEE    DECIMAL(10,2),
   INTNTL_TOLL_FEE    DECIMAL(10,2),
   LCL_TOLL_FEE    DECIMAL(10,2),
   PROV_ROAM_FEE    DECIMAL(10,2),
   OUTPROV_ROAM_FEE    DECIMAL(10,2),
   HMT_ROAM_FEE    DECIMAL(10,2),
   INTNTL_ROAM_FEE    DECIMAL(10,2),
   DEBET_DUR    INT,
   ACTVCALL_DUR    INT,
   FWD_ACTVCALL_DUR    INT,
   ACTV_CALL_NFWD_DUR    INT,
   BYCALL_DUR    INT,
   FWD_BYCALL_DUR    INT,
   BYCALL_NFWD_DUR    INT,
   INNER_DEBET_DUR    INT,
   EXTNL_DEBET_DUR    INT,
   UNICOM_DEBET_DUR    INT,
   TELCOM_DEBET_DUR    INT,
   OTHR_DEBET_DUR    INT,
   CITY_CALL_DUR    INT,
   PROV_TOLL_DUR    INT,
   CNTRY_TOLL_DUR    INT,
   HMT_TOLL_DUR    INT,
   INTNTL_TOLL_DUR    INT,
   LCL_TOLL_DUR    INT,
   PROV_ROAM_DUR    INT,
   OUTPROV_ROAM_DUR    INT,
   HMT_ROAM_DUR    INT,
   INTNTL_ROAM_DUR    INT,
   INVNET_DEBET_DUR    INT,
   OUTVNET_DEBET_DUR    INT,
   CALL_CNT    INT,
   ACTV_CALL_CNT    INT,
   ACTV_CALL_NFWD_CNT    INT,
   BYCALL_CNT    INT,
   FWD_BYCALL_CNT    INT,
   BYCALL_NFWD_CNT    INT,
   INNER_CALL_CNT    INT,
   EXTNL_CALL_CNT    INT,
   UNICOM_CALL_CNT    INT,
   TELCOM_CALL_CNT    INT,
   OTHR_CALL_CNT    INT,
   CITY_CALL_CNT    INT,
   PROV_TOLL_CNT    INT,
   CNTRY_TOLL_CNT    INT,
   HMT_TOLL_CNT    INT,
   INTNTL_TOLL_CNT    INT,
   LCL_TOLL_CNT    INT,
   PROV_ROAM_CNT    INT,
   OUTPROV_ROAM_CNT    INT,
   HMT_ROAM_CNT    INT,
   INTNTL_ROAM_CNT    INT,
   INVNET_CALL_CNT    INT,
   OUTVNET_CALL_CNT    INT,
   FWD_CMPT_CNT    INT,
   IN_LOCAL_ACT_DUR    INT,
   IN_PRVC_ACT_DUR    INT,
   IN_NAT_ACT_DUR    INT,
   IN_NAT_PSV_DUR    INT,
   OUT_LL_ACT_DUR    INT,
   OUT_LO_ACT_DUR    INT,
   OUT_PRVC_ACT_DUR    INT,
   OUT_NAT_ACT_DUR    INT,
   OUT_NAT_PSV_DUR    INT,
   OUT_HKWZ_ACT_DUR    INT,
   OUT_HKWZ_PSV_DUR    INT,
   PRVC_PSV_DUR    INT,
   LRVC_PSV_DUR    INT,
   LOCAL_ACT_SPECNBR_DUR    INT,
   PRVC_ACT_SPECNBR_DUR    INT,
   NAT_ACT_SPECNBR_DUR    INT,
   NAT_PSV_SPECNBR_DUR    INT,
   IN_LL_ACT_DUR    INT,
   IN_LL_PSV_DUR    INT,
   OUT_LL_PSV_DUR    INT,
   IN_LO_ACT_DUR    INT,
   IN_LO_PSV_DUR    INT,
   OUT_LO_PSV_DUR    INT,
   IN_PRVC_PSV_DUR    INT,
   OUT_PRVC_PSV_DUR    INT,
   OUT_LL_ACT_FEE    DECIMAL(10,2),
   OUT_LL_PSV_FEE    DECIMAL(10,2),
   OUT_LO_ACT_FEE    DECIMAL(10,2),
   OUT_LO_PSV_FEE    DECIMAL(10,2),
   OUT_PRVC_ACT_FEE    DECIMAL(10,2),
   OUT_PRVC_PSV_FEE    DECIMAL(10,2),
   OUT_NAT_ACT_FEE    DECIMAL(10,2),
   OUT_NAT_PSV_FEE    DECIMAL(10,2),
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   GSM_ACTV_MOB_DUR    INT,
   GSM_BYCALL_MOB_DUR    INT,
   T_ACTV_MOB_DUR    INT,
   T_BYCALL_MOB_DUR    INT,
   INVNET_CALL_FEE    DECIMAL(14,2),
   INVNET_LCL_DUR    INT,
   INVNET_PRVC_DUR    INT,
   INVNET_ACTCALL_DUR    INT,
   INVNET_ACTCALL_CNT    INT,
   INTNTL_DAY_CNT    INT,
   CNTRY_DAY_CNT    INT,
   LCL_ACTVCALL_CNT    INT,
   LCL_ACTVCALL_DUR    INT,
   LCL_BYCALL_CNT    INT,
   LCL_BYCALL_DUR    INT,
   LCL_CITY_ACTVCALL_CNT    INT,
   LCL_CITY_ACTVCALL_DUR    INT,
   LCLB_TOLL_CNT    INT,
   LCLB_TOLL_DUR    INT,
   LCL_PROV_TOLL_DUR    INT,
   LCL_CNTRY_TOLL_DUR    INT,
   LCL_INTNTL_TOLL_DUR    INT,
   LCL_HMT_TOLL_DUR    INT,
   PROV_ROAM_ACTVCALL_CNT    INT,
   PROV_ROAM_ACTVCALL_DUR    INT,
   PROV_ROAM_BYCALL_CNT    INT,
   PROV_ROAM_BYCALL_DUR    INT,
   PROV_TOLL_ACTCALL_DUR    INT,
   PROV_ROAM_TOLL_ACTVCALL_DUR    INT,
   CNTRY_ROAM_BYCALL_CNT    INT,
   CNTRY_ROAM_BYCALL_DUR    INT,
   CNTRY_ROAM_ACTVCALL_CNT    INT,
   CNTRY_ROAM_ACTVCALL_DUR    INT,
   CNTRY_TOLL_ACTCALL_DUR    INT,
   CNTRY_ROAM_TOLL_ACTVCALL_DUR    INT,
   INTNTL_ROAM_BYCALL_CNT    INT,
   INTNTL_ROAM_BYCALL_DUR    INT,
   INTNTL_ROAM_ACTVCALL_CNT    INT,
   INTNTL_ROAM_ACTVCALL_DUR    INT,
   INTNTL_TOLL_ACTCALL_DUR    INT,
   INTNTL_ROAM_TOLL_ACTVCALL_DUR    INT,
   HMT_ROAM_ACTVCALL_DUR    INT,
   HMT_ROAM_BYCALL_DUR    INT,
   HMT_TOLL_ACTCALL_DUR    INT,
   TELCOM_CALL_USRCNT    INT,
   TELCOM_CALL_DUR    INT,
   UNICOM_CALL_USRCNT    INT,
   UNICOM_CALL_DUR    INT,
   LCL_ACTVCALL_FEE    DECIMAL(10,2),
   LCL_ABYCALL_FEE    DECIMAL(10,2),
   LCL_CITY_ACTVCALL_FEE    DECIMAL(10,2),
   LCL_TOLL_ACTVCALL_FEE    DECIMAL(10,2),
   LCL_PROV_TOLL_FEE    DECIMAL(10,2),
   LCL_CNTRY_TOLL_FEE    DECIMAL(10,2),
   LCL_INTNTL_TOLL_FEE    DECIMAL(10,2),
   LCL_HMT_TOLL_FEE    DECIMAL(10,2),
   ROAM_FEE    DECIMAL(10,2),
   PROV_ROAM_ACTVCALL_FEE    DECIMAL(10,2),
   PROV_ROAM_BYCALL_FEE    DECIMAL(10,2),
   CNTRY_ROAM_BYCALL_FEE    DECIMAL(10,2),
   CNTRY_ROAM_ACTVCALL_FEE    DECIMAL(10,2),
   INTNTL_ROAM_BYCALL_FEE    DECIMAL(10,2),
   INTNTL_ROAM_ACTVCALL_FEE    DECIMAL(10,2),
   HMT_ROAM_ACTVCALL_FEE    DECIMAL(10,2),
   HMT_ROAM_BYCALL_FEE    DECIMAL(10,2),
   TOLL_FEE    DECIMAL(10,2),
   PROV_TOLL_ACTCALL_FEE    DECIMAL(10,2),
   CNTRY_TOLL_ACTCALL_FEE    DECIMAL(10,2),
   INTNTL_TOLL_ACTCALL_FEE    DECIMAL(10,2),
   HMT_TOLL_ACTCALL_FEE    DECIMAL(10,2),
   ACTCALL_PAY_IND    STRING,
   BYCALL_PAY_IND    STRING,
   ACTCALL_DEBET_DUR    INT,
   BYCALL_DEBET_DUR    INT,
   ACTCALL_PAY_FEE    DECIMAL(12,2),
   BYCALL_PAY_FEE    DECIMAL(12,2),
   WAIT_USR_IND    STRING,
   FWD_ACTVCALL_CNT    INT,
   CALL_FREE_DUR    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_VOC_BUSI_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_PERS_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   BASS_PRDCT_CD    STRING,
   CUST_NAM    STRING,
   CNTCT_TEL    STRING,
   CNTCT_NAM    STRING,
   CNTCT_ADDR    STRING,
   GDR_TYP_CD    STRING,
   ID_TYP_CD    STRING,
   ID_NBR    STRING,
   PROF_TYP_CD    STRING,
   BIRTH_DT    INT,
   OWE_CHNL_CD    STRING,
   START_DT    INT,
   NET_TYP    STRING,
   AGE_CNT    SMALLINT,
   PAY_TYP_CD    STRING,
   INNET_MO_CNT    SMALLINT,
   OWE_STOP_IND    STRING,
   FORCE_STOP_IND    STRING,
   HIGH_STOP_IND    STRING,
   APPLY_STOP_IND    STRING,
   LOST_STOP_IND    STRING,
   EFF_STOP_IND    STRING,
   MOB_USE_TYP_CD    STRING,
   USR_STS_CD    STRING,
   VIP_LVL_CD    SMALLINT,
   USR_STS_DT    INT,
   USR_STS_TIM    STRING,
   VIP_CHG_DT    INT,
   USR_OUTNET_DT    INT,
   CUST_CHG_DT    INT,
   PREOUTNET_STOP_DT    INT,
   INNET_USR_IND    STRING,
   QUALIFYRSN_CD    SMALLINT,
   VPMN_USR_IND    STRING,
   PKG_CD    SMALLINT,
   PKG_DTL_CD    INT,
   OSS_NAM    STRING,
   NBR_PROP_CD    SMALLINT,
   IUSR_TYP_CD    INT,
   MON_NEW_USR_IND    STRING,
   IMEI    STRING,
   IMSI    STRING,
   SIM_CD    STRING,
   ORDER_BRND_CD    SMALLINT,
   ORDER_PKG_CD    SMALLINT,
   ORDER_PKG_DTL_CD    INT,
   N_BASS_PRDCT_CD    STRING,
   ORDER_BASS_PRDCT_CD    STRING,
   SETL_DT    INT,
   START_TIM    STRING,
   REG_DT    INT,
   DBL_STOP_CNT    INT,
   SBL_STOP_CNT    INT,
   DBL_STOP_DAYCNT    INT,
   SBL_STOP_DAYCNT    INT,
   N_BASS_PRDCT_EFF_DT    INT,
   N_BASS_PRDCT_END_DT    INT,
   ORDER_BASS_PRDCT_EFF_DT    INT,
   ORDER_BASS_PRDCT_END_DT    INT,
   DHT_SUB_IND    STRING,
   MH_INNET_AGE_USR_IND    STRING,
   NEW_STK_LOST_USR_IND    STRING,
   OWE_STOP_CNT    INT,
   OWE_STOP_DAYCNT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_USR_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_NB_GPRS_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_GPRS_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   GPRS_ACTV_USR_IND    STRING,
   GPRS_NEW_USR_IND    STRING,
   GPRS_USE_USR_IND    STRING,
   GPRS_PAY_USR_IND    STRING,
   GPRS_UP_FLUX    BIGINT,
   GPRS_DOWN_FLUX    BIGINT,
   GPRS_TD_FLUX    BIGINT,
   TDLTE_GPRS_FLUX    BIGINT,
   GPRS_NTD_FLUX    BIGINT,
   LOC_CMPWAP_FLUX    BIGINT,
   IPRVC_CMWAP_FLUX    BIGINT,
   OPRVC_CMWAP_FLUX    BIGINT,
   CMWAP_FLUX    BIGINT,
   LOC_CMNET_FLUX    BIGINT,
   IPRVC_CMNET_FLUX    BIGINT,
   OPRVC_CMNET_FLUX    BIGINT,
   CMNET_FLUX    BIGINT,
   LOC_GDMOB_FLUX    BIGINT,
   IRPVC_GDMOB_FLUX    BIGINT,
   OPRVC_GDMOB_FLUX    BIGINT,
   GDMOB_FLUX    BIGINT,
   LOC_OTHAPN_FLUX    BIGINT,
   IPRVC_OTHAPN_FLUX    BIGINT,
   OPRVC_OTHAPN_FLUX    BIGINT,
   OTHAPN_FLUX    BIGINT,
   LOC_FLUX    BIGINT,
   IPRVC_FLUX    BIGINT,
   OPRVC_FLUX    BIGINT,
   NON_OVERRUN_FLUX    BIGINT,
   OVERRUN_FLUX    BIGINT,
   GPRS_PKG_FEE    DECIMAL(14,2),
   GPRS_FEE    DECIMAL(14,2),
   GPRS_FLUX    BIGINT,
   GPRS_MO_PKG_FEE    DECIMAL(14,2),
   GPRS_MOB_FEE    DECIMAL(14,2),
   OUTPRVC_ROAM_FLUX    BIGINT,
   OUTPRVC_ROAM_T_FLUX    BIGINT,
   OVERRUN_FLUX_FEE    DECIMAL(14,2),
   FLUX_BHD    DECIMAL(20,6),
   MIX_PKG_IN_FLUX    BIGINT,
   STD_PKG_IN_FLUX    BIGINT,
   SWYH_PKG_IN_FLUX    BIGINT,
   SWYH_STDPKG_IN_FLUX    BIGINT,
   PLUSPKG_IN_FLUX    BIGINT,
   OTH_PKG_IN_FLUX    BIGINT,
   MAIN_PKG_IN_FLUX    BIGINT,
   EFF_STD_PKG_CD    STRING,
   ORDR_STD_PKG_CD    STRING,
   INTNTL_ROAM_GPRS_USR_IND    STRING,
   INTNTL_ROAM_GPRS_FLUX    BIGINT,
   INTNTL_ROAM_GPRS_FEE    DECIMAL(14,2),
   EFF_IDLE_PKG_CD    STRING,
   GPRS_CALL_CNT    INT,
   GPRS_DAY_CNT    INT,
   TDLTE_GPRS_DAY_CNT    INT,
   FLUX_USR_IND    STRING,
   MH_FLUX_USR_IND    STRING,
   GPRS_SPKG_IND    STRING,
   GPRS_BPKG_IND    STRING,
   GPRS_NSPKG_IND    STRING,
   GPRS_FPKG_IND    STRING,
   GPRS_DJ_PKG_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_GPRS_BUSI_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_PERS_REDU_MH_CUST_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_REDU_MH_CUST_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PKG_CD    SMALLINT,
   MO_AMT_FEE    DECIMAL(14,2),
   MO_DEBET_DUR    BIGINT,
   MO_ACTVCALL_DEBET_DUR    BIGINT,
   MO_DISCNT_FEE    DECIMAL(14,2),
   PER_PAY_DISCNT_FEE    DECIMAL(14,2),
   GOTONE_DISCNT_FEE    DECIMAL(14,2),
   MO_DISCNT_FIX_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='&&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_REDU_MH_CUST_M';

DROP TABLE IF EXISTS JCFW.TW_USRCALL_MO;
CREATE EXTERNAL TABLE JCFW.TW_USRCALL_MO (
   TM_INTRVL_CD    INT,
   CNCT_NBR    STRING,
   A_USR_NBR    STRING,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   TOLL_TYP_CD    SMALLINT,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   RATE_TYP_CD    STRING,
   BILL_TYP_CD    STRING,
   CARRY_TYP_CD    STRING,
   ICP_STAT_CD    STRING,
   B_AREA_CD    STRING,
   B_BRND_CD    SMALLINT,
   B_OPER_CD    STRING,
   CALL_AREA_CD    STRING,
   FILE_TYP    STRING,
   CX_FILE_IND    STRING,
   NET_TYP_CD    STRING,
   BILL_ACCT_CD    STRING,
   B_USR_TYP_CD    STRING,
   A_USR_TYP_CD    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   CALL_CNT    INT,
   SMS_CALL_CNT    INT,
   CALL_DUR    INT,
   CALL_FLUX    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEBET_MOB_DUR    INT,
   DEBET_TOLL_DUR    INT,
   MOB_FEE    DECIMAL(10,2),
   TOLL_FEE    DECIMAL(10,2),
   INF_FEE    DECIMAL(10,2),
   MOB_DEBET1_FEE    DECIMAL(10,2),
   TOLL_DEBET1_FEE    DECIMAL(10,2),
   INF_DEBET1_FEE    DECIMAL(10,2),
   VPMN_IND    STRING,
   FEE_DISCOUNT_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_USRCALL_MO';

DROP TABLE IF EXISTS JCFW.TW_PERS_CSNM_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CSNM_M (
   USR_NBR    STRING,
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PKG_CD    SMALLINT,
   VOC_BUSI_FEE    DECIMAL(10,2),
   DB_FEE    DECIMAL(10,2),
   TOT_FEE    DECIMAL(10,2),
   DISCNT_FEE    DECIMAL(10,2),
   G3NB_PKG_FEE    DECIMAL(10,2),
   G3NB_OUTPKG_FEE    DECIMAL(10,2),
   CMNCT_DEBET_DUR    INT,
   CMNCT_CNT    INT,
   CMNCT_USR_IND    STRING,
   ACTV_CMNCT_IND    STRING,
   STK_MH_IND    STRING,
   ACTV_USR_IND    STRING,
   CM_AMT_RNK_CD    SMALLINT,
   INNET_MO_RNK_CD    SMALLINT,
   CORE_CALL_CNT    DECIMAL(14,2),
   MONFIX_FEE    DECIMAL(16,2),
   VPMN_MONTH_FEE    DECIMAL(16,2),
   MH_VALUE_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CSNM_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_PERS_CSNM_CITY_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CSNM_CITY_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   BRND_CD    SMALLINT,
   PKG_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   TOT_FEE    DECIMAL(10,2),
   CMNCT_DEBET_DUR    INT,
   CMNCT_CNT    INT,
   CMNCT_USR_IND    STRING,
   CM_AMT_RNK_CD    SMALLINT,
   INNET_MO_RNK_CD    SMALLINT,
   ACTV_CMNCT_IND    STRING,
   ACTV_USR_IND    STRING,
   CNSM_RNK_FEE    DECIMAL(10,2),
   FEE_DISCOUNT_TYP_CD    SMALLINT,
   CORE_CALL_CNT    DECIMAL(14,2),
   MONFIX_FEE    DECIMAL(16,2),
   VPMN_MONTH_FEE    DECIMAL(16,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CSNM_CITY_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_MH_CUST_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_MH_CUST_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   MO_AMT_FEE    DECIMAL(12,2),
   MO_DEBET_DUR    INT,
   MO_ACTVCALL_DEBET_DUR    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_MH_CUST_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_FAMHOME_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_FAMHOME_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   SHORT_NBR    STRING,
   EFF_DT    INT,
   INVALID_DT    INT,
   BASS_PRDCT_CD    STRING,
   MAIN_NBR    STRING,
   MAIN_CMCC_BRANCH_CD    STRING,
   MAIN_BRND_CD    SMALLINT,
   MAIN_SHORT_NBR    STRING,
   FAMHOME_REACH_FAM_IND    STRING,
   FAMHOME_NEW_FAM_IND    STRING,
   FAMHOME_REACH_MBR_IND    STRING,
   FAMHOME_NEW_MBR_IND    STRING,
   FAMHOME_MAINSUB_CD    SMALLINT,
   FAMHOME_FAM_TYP_CD    SMALLINT,
   FEE_TYP_CD    SMALLINT,
   PAY_TYP_CD    SMALLINT,
   CMPT_USR_IND    STRING,
   FAMHOME_SMS_IND    STRING,
   FAMHOME_SMS_NEW_IND    STRING,
   FAMHOME_SMS_LOST_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='&&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_FAMHOME_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_FAMHOME_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_FAMHOME_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MAIN_NBR    STRING,
   FAMHOME_FIX_FEE    DECIMAL(16,2),
   VNS_ACTCALL_CNT    INT,
   VNS_BYCALL_CNT    INT,
   VNL_ACTCALL_CNT    INT,
   VNL_BYCALL_CNT    INT,
   VNS_ACTCALL_DEBET_DUR    INT,
   VNS_BYCALL_DEBET_DUR    INT,
   VNL_ACTCALL_DEBET_DUR    INT,
   VNL_BYCALL_DEBET_DUR    INT,
   ACTCALL_550_DEBET_DUR    INT,
   ACTCALL_550_CNT    INT,
   BYCALL_550_DEBET_DUR    INT,
   BYCALL_550_CNT    INT,
   VNSL_ACTVCALL_DUR    INT,
   VNSL_BYCALL_DUR    INT,
   VNL_LACTCALL_DEBET_DUR    INT,
   VNL_IPACTCALL_DEBET_DUR    INT,
   VNL_OPACTCALL_DEBET_DUR    INT,
   VNL_LBYCALL_DEBET_DUR    INT,
   VNL_IPBYCALL_DEBET_DUR    INT,
   VNL_OPBYCALL_DEBET_DUR    INT,
   VNL_ALLOP_CALL_DUR    INT,
   VNL_ALLOP_CALL_CNT    INT,
   VNS_ALLOP_CALL_DUR    INT,
   VNS_ALLOP_CALL_CNT    INT,
   VNL_LACTCALL_CNT    INT,
   VNL_LBYCALL_CNT    INT,
   VNL_IPACTCALL_CNT    INT,
   VNL_IPBYCALL_CNT    INT,
   VNL_OPACTCALL_CNT    INT,
   VNL_OPBYCALL_CNT    INT,
   VNS_LACTCALL_CNT    INT,
   VNS_LBYCALL_CNT    INT,
   VNS_IPACTCALL_DEBET_DUR    INT,
   VNS_IPBYCALL_DEBET_DUR    INT,
   VNS_IPACTCALL_CNT    INT,
   VNS_IPBYCALL_CNT    INT,
   VNS_OPACTCALL_DEBET_DUR    INT,
   VNS_OPBYCALL_DEBET_DUR    INT,
   VNS_OPACTCALL_CNT    INT,
   VNS_OPBYCALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='&&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_FAMHOME_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_CDR_USR_GPRS_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_CDR_USR_GPRS_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   EVENT_FORMAT_YTP_CD    STRING,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_TYP_CD    STRING,
   CALL_AREA_CD    STRING,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   XD_TYP_CD    STRING,
   RESERVE    STRING,
   RESERVE2    STRING,
   RESERVE3    STRING,
   DUR_VOL_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   EVENT_TYP_CD    STRING,
   SPECIAL_TYP_CD    STRING,
   FILE_TYP    STRING,
   IMEI    STRING,
   NET_TYP_CD    STRING,
   A_USR_TYP_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOB_FEE    DECIMAL(16,3),
   TOLL_FEE    DECIMAL(16,3),
   INF_FEE    DECIMAL(16,3),
   CALL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   UP_CALL_FLUX    BIGINT,
   DOWN_CALL_FLUX    BIGINT,
   INTR_UP_FLUX    BIGINT,
   INTR_DOWN_FLUX    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CDR_USR_GPRS_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_CDR_USR_WLAN_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_CDR_USR_WLAN_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   EVENT_FORMAT_YTP_CD    STRING,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_TYP_CD    STRING,
   CALL_AREA_CD    STRING,
   FILE_TYP    STRING,
   CDR_SRC_CD    SMALLINT,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   XD_TYP_CD    STRING,
   RESERVE    STRING,
   RESERVE2    STRING,
   RESERVE3    STRING,
   DUR_VOL_TYP_CD    STRING,
   CDR_ROAM_TYP_CD    STRING,
   NAS_ID    STRING,
   NAS_PORT_ID    STRING,
   AUTH_TYP_CD    STRING,
   BUSI_FLAG    STRING,
   TERM_TYP_CD    STRING,
   TERM_OS_TYP    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOB_FEE    DECIMAL(16,3),
   TOLL_FEE    DECIMAL(16,3),
   INF_FEE    DECIMAL(16,3),
   CALL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   UP_CALL_FLUX    BIGINT,
   DOWN_CALL_FLUX    BIGINT,
   INTR_UP_FLUX    BIGINT,
   INTR_DOWN_FLUX    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CDR_USR_WLAN_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_CDR_USR_VOC_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_CDR_USR_VOC_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   EVENT_FORMAT_YTP_CD    STRING,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_TYP_CD    STRING,
   CALL_AREA_CD    STRING,
   DISC_BASS_PRDCT_CD1    STRING,
   DISC_BASS_PRDCT_CD2    STRING,
   XD_TYP_CD    STRING,
   RESERVE    STRING,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   TOLL_TYP_CD    SMALLINT,
   EVENT_TYP_CD    STRING,
   FILE_TYP    STRING,
   REL_TYP_CD    STRING,
   NET_TYP_CD    STRING,
   CDR_CALL_TYP_CD    STRING,
   IMEI    STRING,
   CNCT_NBR    STRING,
   VPMN_IND    STRING,
   B_OPER_CD    STRING,
   B_BRND_CD    SMALLINT,
   B_USR_TYP_CD    STRING,
   B_AREA_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOB_FEE    DECIMAL(16,3),
   TOLL_FEE    DECIMAL(16,3),
   INF_FEE    DECIMAL(16,3),
   CALL_DUR    BIGINT,
   DEBET_TOLL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CDR_USR_VOC_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_CDR_USRCALL_M;
CREATE EXTERNAL TABLE JCFW.TW_CDR_USRCALL_M (
   DEBET_DT    INT,
   CALL_DT    INT,
   USR_NBR    STRING,
   EVENT_FORMAT_YTP_CD    STRING,
   XD_TYP_CD    STRING,
   FREE_IND    STRING,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   CX_FILE_IND    STRING,
   BILL_TYP_CD    STRING,
   BILL_ACCT_CD    STRING,
   RATE_TYP_CD    STRING,
   CARRY_TYP_CD    STRING,
   ICP_STAT_CD    STRING,
   SPECIAL_TYP_CD    STRING,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   TOLL_TYP_CD    SMALLINT,
   CALL_AREA_CD    STRING,
   FILE_TYP    STRING,
   NET_TYP_CD    STRING,
   A_USR_TYP_CD    STRING,
   VPMN_IND    STRING,
   B_AREA_CD    STRING,
   B_BRND_CD    SMALLINT,
   B_OPER_CD    STRING,
   B_USR_TYP_CD    STRING,
   CNCT_NBR    STRING,
   IMEI    STRING,
   RESERVE    STRING,
   RESERVE3    STRING,
   DUR_VOL_TYP_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOB_FEE    DECIMAL(16,3),
   TOLL_FEE    DECIMAL(16,3),
   INF_FEE    DECIMAL(16,3),
   CALL_DUR    BIGINT,
   DEBET_TOLL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   UP_CALL_FLUX    BIGINT,
   DOWN_CALL_FLUX    BIGINT,
   INTR_UP_FLUX    BIGINT,
   INTR_DOWN_FLUX    BIGINT,
   CALL_FREE_DUR    BIGINT,
   DEDUCTION1    BIGINT,
   DEDUCTION2    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CDR_USRCALL_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_CHNL_INF_M;
CREATE EXTERNAL TABLE JCFW.TW_CHNL_INF_M (
   STAT_MO    INT,
   CHNL_CD    STRING,
   UNIQUE_CHNL_CD    STRING,
   PROVINCE_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   CMCC_CNTY_CD    STRING,
   SECTION    STRING,
   TOWN    STRING,
   CHNL_NAM    STRING,
   CHNL_ADR_NAM    STRING,
   CHNL_CNTCT_NAM    STRING,
   CNTCT_TEL_NBR    STRING,
   CHNL_TYP_CD    STRING,
   CHNL_SUBTYP_CD    STRING,
   BI_CHNL_TYP_CD    SMALLINT,
   BI_CHNL_SUBTYP_CD    SMALLINT,
   RUN_MOD    SMALLINT,
   IS_EXC    SMALLINT,
   ADR_TYP_CD    SMALLINT,
   BUZ_TYP_CD    SMALLINT,
   CHNL_RUNSTS_CD    SMALLINT,
   ET_TYP_CD    SMALLINT,
   IF_MOBILEMALL    SMALLINT,
   PRT_SOURCE    SMALLINT,
   STAR_LVL_CD    SMALLINT,
   CATE_ATTR    SMALLINT,
   CNSTR_STOP_DT    INT,
   HOUSE_ID    STRING,
   LAND_ID    STRING,
   BUS_ENROL_ID    STRING,
   CNSTR_COST    DECIMAL(14,2),
   RENT_START_DT    INT,
   RENT_END_DT    INT,
   AVG_RENT_FEE    DECIMAL(14,2),
   CNSTR_AREA    DECIMAL(10,2),
   USE_AREA    DECIMAL(10,2),
   FRONT_AREA    DECIMAL(10,2),
   SEAT_CNT    INT,
   EMP_NUM    INT,
   SECU_NUM    INT,
   CLEAN_NUM    INT,
   HAS_WAITMACH    SMALLINT,
   HAS_POSMACH    SMALLINT,
   HAS_24MALL    SMALLINT,
   HAS_VIP_SEAT    SMALLINT,
   HAS_VIP_ROOM    SMALLINT,
   PRINTER_NUM    INT,
   SH_NUM    INT,
   G3_AREA    DECIMAL(16,2),
   TV_NUM    INT,
   NEW_OPER_MALL_NUM    INT,
   THINK_MALL_NUM    INT,
   NET_MALL_NUM    INT,
   STOREFRONY_AREA    DECIMAL(16,2),
   GMCC_AREA    DECIMAL(16,2),
   ISP_CONNECT_TYP    SMALLINT,
   IS_KZCZ    SMALLINT,
   FIX_TOTAL_FEE    DECIMAL(16,2),
   EQUIP_TOTAL_FEE    DECIMAL(16,2),
   FITMENT_FEE    DECIMAL(16,2),
   BUSI_START_TIME    STRING,
   BUSI_END_TIME    STRING,
   LONGITUDE    DECIMAL(10,5),
   LATITUDE    DECIMAL(10,5),
   FRIEND_CHNL_CD    STRING,
   IS_TIETONG    SMALLINT,
   COMPACT_BEGIN_DT    INT,
   COMPACT_END_DT    INT,
   CLAC_MONTH    INT,
   CHK_CD    STRING,
   TOP_CD    STRING,
   OPR_DT    INT,
   OPR_TIM    STRING,
   CHAIN_HEAD_CD    STRING,
   BOSS_CHNL_CD    STRING,
   SUB_RUN_MOD    INT,
   CMOP_CNTY_CD    STRING,
   DATA_SOURCE    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CHNL_INF_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CUST_BILL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CUST_BILL_M (
   EBOX_ID    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   BILL_ACCT_CD    STRING,
   BILL_CYC_CD    INT,
   CMCC_BRANCH_CD    STRING,
   REC_FEE    DECIMAL(16,2),
   ACT_FEE    DECIMAL(16,2),
   BILL_STS_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CUST_BILL_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_USR_NBUSE_MO;
CREATE EXTERNAL TABLE JCFW.TW_USR_NBUSE_MO (
   TM_INTRVL_CD    INT,
   USR_NBR    STRING,
   NEW_BUSI_CD    INT,
   CO_TYP_CD    INT,
   DIR_TYP_CD    STRING,
   SP_CODE    STRING,
   SP_SERV_CD    STRING,
   SP_SUBBUSI_CD    STRING,
   SP_BUSICLASS_CD    STRING,
   TAOCAN_IND    STRING,
   CALL_AREA_CD    STRING,
   B_OPER_CD    STRING,
   B_AREA_CD    STRING,
   NET_TYP_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   BASE_DAY_RENT    DECIMAL(7,2),
   BASE_MONTH_RENT    DECIMAL(10,2),
   MOB_FEE    DECIMAL(10,2),
   TOLL_FEE    DECIMAL(10,2),
   PER_INF_FEE    DECIMAL(10,2),
   MON_INF_FEE    DECIMAL(10,2),
   CALL_DUR    BIGINT,
   DEBET_MOB_DUR    BIGINT,
   CALL_CNT    BIGINT,
   GPRS_FLUX    BIGINT,
   MMS_GPRS_FLUX    BIGINT,
   DEBT1_DAY_RENT    DECIMAL(7,2),
   DEBT1_MONTH_RENT    DECIMAL(10,2),
   DEBT1_MOB_FEE    DECIMAL(10,2),
   DEBT1_TOLL_FEE    DECIMAL(10,2),
   DEBT1_PER_INF_FEE    DECIMAL(10,2),
   DEBT1_MON_INF_FEE    DECIMAL(10,2),
   PKG_CD    SMALLINT,
   CDR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_USR_NBUSE_MO'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_NB_GPRS_USR_PRDCT_ORDR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_GPRS_USR_PRDCT_ORDR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   BASS_PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   ORDR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_GPRS_USR_PRDCT_ORDR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_DEBET_BILL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_DEBET_BILL_M (
   USR_NBR    STRING,
   BILL_TYP_CD    STRING,
   TM_INTRVL_CD    INT,
   BILL_CUST_ID    STRING,
   PDT_ID    STRING,
   IMSI    STRING,
   DISC_CD    STRING,
   BILL_SERV_TYP    STRING,
   BILL_BRND_TYP    STRING,
   BILL_USR_TYP    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   FEE_DISCOUNT_TYP_CD    SMALLINT,
   SP_BUSICLASS_CD    STRING,
   SP_SERV_CD    STRING,
   SP_CODE    STRING,
   SP_CODE1    STRING,
   SP_SERV_CD1    STRING,
   MOB_FEE    DECIMAL(10,2),
   DDD_FEE    DECIMAL(10,2),
   IDD_FEE    DECIMAL(10,2),
   MON_FEE    DECIMAL(10,2),
   INFO_FEE    DECIMAL(10,2),
   PER_INF_FEE    DECIMAL(10,2),
   MON_INF_FEE    DECIMAL(10,2),
   GIFT_FEE    DECIMAL(10,2),
   DEBT1_MOB_FEE    DECIMAL(10,2),
   DEBT1_DDD_FEE    DECIMAL(10,2),
   DEBT1_IDD_FEE    DECIMAL(10,2),
   DEBT1_MON_FEE    DECIMAL(10,2),
   DEBT1_INFO_FEE    DECIMAL(10,2),
   DEBT1_GIFT_FEE    DECIMAL(10,2),
   BILL_DISC_FEE    DECIMAL(10,2),
   DEBT2_MOB_FEE    DECIMAL(10,2),
   DEBT2_DDD_FEE    DECIMAL(10,2),
   DEBT2_IDD_FEE    DECIMAL(10,2),
   DEBT2_MON_FEE    DECIMAL(10,2),
   DEBT2_INFO_FEE    DECIMAL(10,2),
   DEBT2_GIFT_FEE    DECIMAL(10,2),
   CALL_CNT    INT,
   DEBT_MOB_DUR    INT,
   CALL_FLUX    BIGINT,
   CALL_DUR    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_DEBET_BILL_M';

DROP TABLE IF EXISTS JCFW.TW_CUST_CONSUME;
CREATE EXTERNAL TABLE JCFW.TW_CUST_CONSUME (
   BILL_CYC_CD    INT,
   USR_ID    STRING,
   CUST_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   USR_NBR    STRING,
   BASS_PRDCT_CD    STRING,
   INNET_MO_CNT    SMALLINT,
   MOB_USE_TYP_CD    STRING,
   MRKT_CHNL_CD    STRING,
   OWE_STOP_IND    STRING,
   FORCE_STOP_IND    STRING,
   HIGH_STOP_IND    STRING,
   APPLY_STOP_IND    STRING,
   LOST_STOP_IND    STRING,
   EFF_STOP_IND    STRING,
   USR_STS_CD    STRING,
   CORP_MEMBER_IND    STRING,
   INNET_USR_IND    STRING,
   VIP_LVL_CD    SMALLINT,
   LB_FEE    DECIMAL(10,2),
   LB_DDD    DECIMAL(10,2),
   LB_IDD    DECIMAL(10,2),
   PB_FEE    DECIMAL(10,2),
   PB_DDD    DECIMAL(10,2),
   PB_IDD    DECIMAL(10,2),
   GB_FEE    DECIMAL(10,2),
   GB_DDD    DECIMAL(10,2),
   GB_IDD    DECIMAL(10,2),
   M_IP_FEE    DECIMAL(10,2),
   M_IP_DDD    DECIMAL(10,2),
   M_IP_IDD    DECIMAL(10,2),
   IB_FEE    DECIMAL(10,2),
   T_IP_FEE    DECIMAL(10,2),
   N_IP_FEE    DECIMAL(10,2),
   MW_SMS_FEE    DECIMAL(10,2),
   LB_GPRS_FEE    DECIMAL(10,2),
   ZJFF_FEE    DECIMAL(10,2),
   BJFF_FEE    DECIMAL(10,2),
   SMS_FEE    DECIMAL(10,2),
   MMS_FEE    DECIMAL(10,2),
   WAP_FEE    DECIMAL(10,2),
   WLAN_FEE    DECIMAL(10,2),
   LBT_TEL_FEE    DECIMAL(10,2),
   IPZT_FEE    DECIMAL(10,2),
   IPZT_DDD    DECIMAL(10,2),
   IPZT_IDD    DECIMAL(10,2),
   IB_GPRS_FEE    DECIMAL(10,2),
   OTH_TEL_FEE    DECIMAL(10,2),
   BASE_MONTH_FEE    DECIMAL(10,2),
   TAOCAN_MONTH_FEE    DECIMAL(10,2),
   VPMN_MONTH_FEE    DECIMAL(10,2),
   BYCALL_MONTH_FEE    DECIMAL(10,2),
   SMS_MONTH_FEE    DECIMAL(10,2),
   G_CALL_MONTH_FEE    DECIMAL(10,2),
   GPRS_MONTH_FEE    DECIMAL(10,2),
   MW_MONTH_FEE    DECIMAL(10,2),
   DVOICE_GPS_FEE    DECIMAL(10,2),
   CORP_SMS_FEE    DECIMAL(10,2),
   IDLE_MONTH_FEE    DECIMAL(10,2),
   LBT_MONTH_FEE    DECIMAL(10,2),
   SUB_NBR_FEE    DECIMAL(10,2),
   SVOICE_GPS_FEE    DECIMAL(10,2),
   NVOICE_GPS_FEE    DECIMAL(10,2),
   WIRELESS_POS_FEE    DECIMAL(10,2),
   LINE_MONTH_FEE    DECIMAL(10,2),
   IP_ADDR_FEE    DECIMAL(10,2),
   IP_VPN_FEE    DECIMAL(10,2),
   NET_USE_FEE    DECIMAL(10,2),
   OTH_MONTH_FEE    DECIMAL(10,2),
   NEW_FUNC_FEE    DECIMAL(10,2),
   ICP_INFO_FEE    DECIMAL(10,2),
   GPRS_INFO_FEE    DECIMAL(10,2),
   WAP_INFO_FEE    DECIMAL(10,2),
   LBT_INFO_FEE    DECIMAL(10,2),
   OTH_INFO_FEE    DECIMAL(10,2),
   DOFOR_FEE    DECIMAL(10,2),
   OTH_FEE    DECIMAL(10,2),
   BREACH_FEE    DECIMAL(10,2),
   MEND_FEE    DECIMAL(10,2),
   DISCOUNT_FEE    DECIMAL(10,2),
   REDUCE_FEE    DECIMAL(10,2),
   MO_AMT_FEE    DECIMAL(10,2),
   DT_AVG_FEE    DECIMAL(10,2),
   MMS_PKG_FEE    DECIMAL(10,2),
   PKG_CD    SMALLINT,
   M12593_MONTH_FEE    DECIMAL(10,2),
   MONFIX_FEE    DECIMAL(16,2),
   MONFIX2_FEE    DECIMAL(10,2),
   G3NB_TAOCAN_FEE    DECIMAL(10,2),
   G3NB_OUT_TAOCAN_FEE    DECIMAL(10,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CUST_CONSUME';

DROP TABLE IF EXISTS JCFW.TW_CORP_BILL_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_BILL_M (
   STAT_MO    INT,
   USR_ID    STRING,
   PAY_EBOX_ID    STRING,
   BILL_ACCT_CD    STRING,
   USR_TYP_CD    SMALLINT,
   GPAY_TYP_CD    SMALLINT,
   GFEE_TYP_CD    SMALLINT,
   VOC_FEE_IND    STRING,
   USR_NBR    STRING,
   PAY_GROUP_ID    STRING,
   PAY_CUST_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   REC_FEE    DECIMAL(14,2),
   GUSR_ID    STRING,
   GROUP_ID    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   PRDCT_FEE    DECIMAL(14,2),
   MBR_FEE    DECIMAL(14,2),
   PRDCT_TAX_RT    DECIMAL(10,4),
   TAXED_REC_FEE    DECIMAL(20,8),
   TAXED_PRDCT_FEE    DECIMAL(20,8),
   TAXED_MBR_FEE    DECIMAL(20,8)
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_BILL_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_CORP_MBR_ORDER_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_MBR_ORDER_M (
   STAT_MO    INT,
   GUSR_ID    STRING,
   USR_NBR    STRING,
   EFF_DT    INT,
   BASS_PRDCT_CD    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   BRND_CD    INT,
   GCUST_ID    STRING,
   CORP_PRDCT_CODE    STRING,
   CORP_PRDCT_NBR    STRING,
   CORP_USR_NBR    STRING,
   GROUP_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   CMCC_CNTRY_CD    STRING,
   CMCC_TOWN_CD    STRING,
   DGUSR_IND    STRING,
   DF_IND    STRING,
   REG_PRDCT_MBR_IND    STRING,
   VPMN_MBR_IND    STRING,
   DL100_USR_IND    STRING,
   IOT_TYP_CD    STRING,
   IOT_ATR_IND    STRING,
   SRC_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_MBR_ORDER_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_CORP_MBR_CNSM_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_MBR_CNSM_M (
   STAT_MO    INT,
   GUSR_ID    STRING,
   USR_NBR    STRING,
   GCUST_ID    STRING,
   GROUP_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   USR_ID    STRING,
   BRND_CD    INT,
   CUST_ID    STRING,
   MBR_FEE    DECIMAL(14,2),
   GPAY_MBR_FEE    DECIMAL(14,2),
   GPAY1_MBR_FEE    DECIMAL(14,2),
   GPAY2_MBR_FEE    DECIMAL(14,2),
   GPAY3_MBR_FEE    DECIMAL(14,2),
   GPAY4_MBR_FEE    DECIMAL(14,2),
   CI_MBR_FEE    DECIMAL(14,2),
   CI_GPAY_MBR_FEE    DECIMAL(14,2),
   VNET_FEE    DECIMAL(14,2),
   GPAY_VNET_FEE    DECIMAL(14,2),
   TAXED_MBR_FEE    DECIMAL(20,8),
   TAXED_GPAY_MBR_FEE    DECIMAL(20,8),
   TAXED_CI_MBR_FEE    DECIMAL(20,8)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_MBR_CNSM_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_FAMHOME_VNL_CALL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_FAMHOME_VNL_CALL_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   VNL_ACTCALL_DEBET_DUR    INT,
   VNL_BYCALL_DEBET_DUR    INT,
   VNL_ACTCALL_CNT    INT,
   VNL_BYCALL_CNT    INT,
   VNL_LACTCALL_DEBET_DUR    INT,
   VNL_IPACTCALL_DEBET_DUR    INT,
   VNL_OPACTCALL_DEBET_DUR    INT,
   VNL_LBYCALL_DEBET_DUR    INT,
   VNL_IPBYCALL_DEBET_DUR    INT,
   VNL_OPBYCALL_DEBET_DUR    INT,
   VNL_ALLOP_CALL_DUR    INT,
   VNL_ALLOP_CALL_CNT    INT,
   VNL_LACTCALL_CNT    INT,
   VNL_LBYCALL_CNT    INT,
   VNL_IPACTCALL_CNT    INT,
   VNL_IPBYCALL_CNT    INT,
   VNL_OPACTCALL_CNT    INT,
   VNL_OPBYCALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_FAMHOME_VNL_CALL_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_FAMHOME_MBR_INF_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_FAMHOME_MBR_INF_M (
   STAT_MO    INT,
   SUB_NBR    STRING,
   MASTER_NBR    STRING,
   SHORT_NBR    STRING,
   SUB_SHORT_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   SUB_CMCC_BRANCH_CD    STRING,
   SUB_BRND_CD    SMALLINT,
   ADD_DT    INT,
   SUB_STS_CD    SMALLINT,
   DEL_DT    INT,
   SUB_BASS_PRDCT_CD    STRING,
   SUB_PKG_CD    SMALLINT,
   NEW_ADD_IND    STRING,
   SHORT_NBR_TYP    SMALLINT,
   CMPT_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_FAMHOME_MBR_INF_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_FAMHOME_INF_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_FAMHOME_INF_M (
   STAT_MO    INT,
   MASTER_NBR    STRING,
   SHORT_NBR_TYP    SMALLINT,
   SHORT_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    INT,
   REG_DT    INT,
   STS_CD    SMALLINT,
   INVALID_DT    INT,
   BASS_PRDCT_CD    STRING,
   PKG_CD    SMALLINT,
   FEE_TYP_CD    SMALLINT,
   PAY_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_FAMHOME_INF_M';

DROP TABLE IF EXISTS JCFW.TW_TERM_SELL_STS_M;
CREATE EXTERNAL TABLE JCFW.TW_TERM_SELL_STS_M (
   STAT_MO    INT,
   IMEI    STRING,
   SELL_STS_CD    SMALLINT,
   SELL_STS_DT    INT,
   SELL_STS_TIM    STRING,
   TRML_PRDCT_ID    STRING,
   HALL_CD    STRING,
   PLAT_CD    STRING,
   SELL_KIND    STRING,
   ACT_SELL_PRC    DECIMAL(12,2),
   TRML_PROTO_PRC    DECIMAL(12,2),
   MARK_PLAN_CD    STRING,
   MARK_MOB_NBR    STRING,
   BIND_MOB_NBR    STRING,
   PRESENT_MOB_NBR    STRING,
   ECHNL_TYP_CD    SMALLINT,
   DS_CD    SMALLINT,
   SUB_IMEI    STRING,
   SUB_BIND_MOB_NBR    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_TERM_SELL_STS_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CELLTYP_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CELLTYP_M (
   STAT_MO    INT,
   USR_MOB_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   CELL_TYP_CD    SMALLINT,
   STS_TYP_CD    SMALLINT,
   FLAG_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CELLTYP_M';

DROP TABLE IF EXISTS JCFW.TW_IMEI_STS_M;
CREATE EXTERNAL TABLE JCFW.TW_IMEI_STS_M (
   STAT_MO    INT,
   IMEI    STRING,
   FRST_EFF_DT    INT,
   FRST_EFF_TM    STRING,
   FRST_USR_NBR    STRING,
   FRST_CMCC_BRANCH_CD    STRING,
   LAST_CALL_DT    INT,
   LAST_CALL_TM    STRING,
   LAST_USR_NBR    STRING,
   LAST_CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_IMEI_STS_M';

DROP TABLE IF EXISTS JCFW.TW_NB_FETION_USR_USE_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_FETION_USR_USE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   PC_ACTV_IND    STRING,
   MOB_ACTV_IND    STRING,
   SMS_ACTV_IND    STRING,
   IVR_ACTV_IND    STRING,
   FRIEND_OPEN_IND    STRING,
   FETION_CLUB_IND    STRING,
   LGN_FETION_DAY_CNT    INT,
   ONLINE_DUR    DECIMAL(12,2),
   CLIENT_MSG_CNT    INT,
   CLIENT_SMS_CNT    INT,
   FRIEND_CNT    INT,
   GRP_CNT    INT,
   GRP_USR_CNT    INT,
   FETION_NBR    STRING,
   PC_ACT_DUR    INT,
   MOB_ACT_DUR    INT,
   IVR_ACT_DUR    INT,
   SMS_12520_UP_CNT    INT,
   SMS_12520_UP_FEE    DECIMAL(10,2),
   VOC_12520_DUR    INT,
   VOC_12520_FEE    DECIMAL(10,2),
   FRD_FEE    DECIMAL(10,2),
   QQ_FEE    DECIMAL(10,2),
   PP_FEE    DECIMAL(10,2),
   FRD_SCOR    INT,
   PC_ACT_CNT    INT,
   MOB_ACT_CNT    INT,
   IVR_ACT_CNT    INT,
   SMS_ACT_CNT    INT,
   ACT_CNT    INT,
   USE_LM_USR_IND    STRING,
   USE_CM_NEWUSR_IND    STRING,
   MUTE_LM_USR_IND    STRING,
   MUTE_CM_NEWUSR_IND    STRING,
   ACTV_LM_USR_IND    STRING,
   ACTV_CM_NEWUSR_IND    STRING,
   CM_NEWUSR_IND    STRING,
   CANC_LM_USR_IND    STRING,
   CANC_CM_NEWUSR_IND    STRING,
   WAP_USR_IND    STRING,
   LOW_ACTV_USR_IND    STRING,
   HI_ACTV_USR_IND    STRING,
   MOB_UND50K_USR_IND    STRING,
   MOB_NOFRD_USR_IND    STRING,
   MOB_0GPRSFLUX_USR_IND    STRING,
   MOB_0SMS_USR_IND    STRING,
   MOB_NEEDRDUC_USR_IND    STRING,
   PC_NOFRD_USR_IND    STRING,
   PC_0SMS_USR_IND    STRING,
   PC_NEEDRDUC_USR_IND    STRING,
   PC_ACTV_IND_REFAUD    STRING,
   MOB_ACTV_IND_REFAUD    STRING,
   ACTV_IND_REFAUD    STRING,
   PC_ACTV_IND_AUD    STRING,
   MOB_ACTV_IND_AUD    STRING,
   SMS_DOWN_CNT    INT,
   LOGIN_CNT    INT,
   PC_MOB_ACTV_IND    STRING,
   PC_LOGIN_IND    STRING,
   MOB_LOGIN_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_FETION_USR_USE_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBREAD_ASCC_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBREAD_ASCC_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   NEW_USR_IND    STRING,
   TOT_LOGIN_CNT    INT,
   WAP_LOGIN_CNT    INT,
   CLI_LOGIN_CNT    INT,
   FST_LOGIN_CNT    INT,
   PV_CNT    INT,
   WAP_PV_CNT    INT,
   CLI_PV_CNT    INT,
   FST_PV_CNT    INT,
   PAY_AMT    DECIMAL(14,2),
   WAP_PAY_AMT    DECIMAL(14,2),
   CLI_PAY_AMT    DECIMAL(14,2),
   FST_PAY_AMT    DECIMAL(14,2),
   BOOK_ORDR_CNT    INT,
   WORD_ORDR_CNT    INT,
   MO_ORDR_CNT    INT,
   BOOK_PAY_AMT    DECIMAL(14,2),
   WORD_PAY_AMT    DECIMAL(14,2),
   MO_PAY_AMT    DECIMAL(14,2),
   TOT_READ_CHPT_CNT    INT,
   WAP_CHPT_READ_CNT    INT,
   MOBREAD_CHPT_READ_CNT    INT,
   CLI_CHPT_READ_CNT    INT,
   SER_FREE_CHPT_CNT    INT,
   BOOK_FREE_CHPT_CNT    INT,
   SER_PAY_CHPT_CNT    INT,
   BOOK_PAY_CHPT_CNT    INT,
   BOOK_DWNLOAD_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBREAD_ASCC_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_DDLINE_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_DDLINE_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   GUSR_ID    STRING,
   GROUP_ID    STRING,
   EBOX_ID    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   EFF_DT    INT,
   USR_STS_CD    STRING,
   STS_DT    INT,
   CORP_PRDCT_NBR    STRING,
   CORP_USR_NBR    STRING,
   DDLINE_WIDTH    STRING,
   UP_DDLINE_WIDTH    STRING,
   DOWN_DDLINE_WIDTH    STRING,
   RNG_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_DDLINE_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_GPFLUX_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_GPFLUX_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   GUSR_ID    STRING,
   CORP_PRDCT_NBR    STRING,
   GROUP_ID    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   BBOSS_GCUST_ID    STRING,
   BBOSS_GUSR_ID    STRING,
   BBOSS_PRDCT_CD    STRING,
   SRVC_ID    STRING,
   SGN_TYP_CD    SMALLINT,
   SGN_HST_CD    STRING,
   BUS_MDE_CD    STRING,
   PRDCT_FEE    DECIMAL(12,4),
   CI_PRDCT_FEE    DECIMAL(12,4),
   TAXED_PRDCT_FEE    DECIMAL(12,4),
   TAXED_CI_PRDCT_FEE    DECIMAL(12,4),
   GLB_USR_CNT    BIGINT,
   USR_CNT    BIGINT,
   GLB_GPRS_FLUX    BIGINT,
   GPRS_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_GPFLUX_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_PRDCT_OWE_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_PRDCT_OWE_M (
   STAT_MO    INT,
   GUSR_ID    STRING,
   OWE_MO_CNT    INT,
   CMCC_BRANCH_CD    STRING,
   BASS_PRDCT_CD    STRING,
   GROUP_ID    STRING,
   OWE_FEE    DECIMAL(14,2),
   REC_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_PRDCT_OWE_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CORP_IND_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CORP_IND_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    INT,
   DTGRP_AB_CD    STRING,
   PRVCGRP_TYP_CD    SMALLINT,
   PRDCT_MBR_IND    STRING,
   AB_MBR_IND    STRING,
   NEW_MBR_IND    STRING,
   IOT_MBR_IND    STRING,
   VPMN_MBR_IND    STRING,
   SHORT_MBR_IND    STRING,
   CRING_MBR_IND    STRING,
   CALL_VPN_IND    STRING,
   CALL_VPMN_IND    STRING,
   CALL_CVPMN_IND    STRING,
   CALL_HOME_IND    STRING,
   INF_PM_IND    STRING,
   INF_BB_IND    STRING,
   INF_ECARD_IND    STRING,
   INF_GPRS_IND    STRING,
   VFELLOW_IND    STRING,
   USR_ACT2_IND    STRING,
   USR_ACT_IND    STRING,
   VUSR_ACT2_IND    STRING,
   VUSR_ACT_IND    STRING,
   HC_MBR_IND    STRING,
   DL01_MBR_IND    STRING,
   DL02_MBR_IND    STRING,
   DL03_MBR_IND    STRING,
   GT_MBR_IND    STRING,
   GC_MBR_IND    STRING,
   GB_MBR_IND    STRING,
   MACH_IND    STRING,
   MAIL_APN_IND    STRING,
   TD_USR_IND    STRING,
   LTE_USR_IND    STRING,
   MIFI_USR_IND    STRING,
   INDAPPLY_XXT_IND    STRING,
   INDAPPLY_YXT_IND    STRING,
   INDAPPLY_NXT_IND    STRING,
   CRM_MBR_IND    STRING,
   KEY_MBR_IND    STRING,
   CNCT_MBR_IND    STRING,
   MH_CUST_IND    STRING,
   REDU_MH_CUST_IND    STRING,
   VIP_CUST_IND    STRING,
   HIGH_WARN_IND    STRING,
   MARK_YCZS_IND    STRING,
   MARK_CNXF_IND    STRING,
   MARK_YXSX_IND    STRING,
   MARK_ZDYH_IND    STRING,
   SERV_DF_IND    STRING,
   SERV_DG_IND    STRING,
   SERV_YE_IND    STRING,
   MARK_BIND_IND    STRING,
   FINC_BIND_IND    STRING,
   SRVC_BIND_IND    STRING,
   BILL_NYE_IND    STRING,
   BIND_IND    STRING,
   BIND_END_DT    INT,
   MIN_CON_FEE    DECIMAL(14,2),
   NEFF_ACCT_AMT    DECIMAL(14,2),
   AVG_FEE    DECIMAL(14,2),
   GROUP_ID    STRING,
   GROUP_NAM    STRING,
   CORP_GPFLUX_IND    STRING,
   SERV_DF_AMT    DECIMAL(16,2),
   SERV_DG_AMT    DECIMAL(16,2),
   CRM_MBR2_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CORP_IND_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CORP_CNSM_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CORP_CNSM_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    INT,
   TOT_FEE    DECIMAL(14,2),
   MON_FEE    DECIMAL(14,2),
   PM_FEE    DECIMAL(14,2),
   BB_FEE    DECIMAL(14,2),
   CR_FEE    DECIMAL(14,2),
   V_FEE    DECIMAL(14,2),
   VB_FEE    DECIMAL(14,2),
   GPRS_FEE    DECIMAL(14,2),
   KD_FEE    DECIMAL(14,2),
   YXT_FEE    DECIMAL(14,2),
   HYT_FEE    DECIMAL(14,2),
   WL_FEE    DECIMAL(14,2),
   DB_FEE    DECIMAL(14,2),
   DL100_DB_FEE    DECIMAL(14,2),
   GPAY_TOT_FEE    DECIMAL(14,2),
   GPAY_MON_FEE    DECIMAL(14,2),
   GPAY_PM_FEE    DECIMAL(14,2),
   GPAY_BB_FEE    DECIMAL(14,2),
   GPAY_CR_FEE    DECIMAL(14,2),
   GPAY_V_FEE    DECIMAL(14,2),
   GPAY_VB_FEE    DECIMAL(14,2),
   GPAY_GPRS_FEE    DECIMAL(14,2),
   GPAY_KD_FEE    DECIMAL(14,2),
   GPAY_YXT_FEE    DECIMAL(14,2),
   GPAY_HYT_FEE    DECIMAL(14,2),
   GPAY_WL_FEE    DECIMAL(14,2),
   GPAY_DB_FEE    DECIMAL(14,2),
   GPAY_DL100_DB_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CORP_CNSM_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_MBR_ACT_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_MBR_ACT_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CORP_PRDCT_CODE    STRING,
   BRND_CD    INT,
   CMCC_BRANCH_CD    STRING,
   USR_ACT_IND    STRING,
   USR_ACT2_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_MBR_ACT_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_PRDCT_CNSM_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_PRDCT_CNSM_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   GUSR_ID    STRING,
   GROUP_ID    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   PRDCT_FEE    DECIMAL(14,2),
   MBR_FEE    DECIMAL(14,2),
   GPAY_MBR_FEE    DECIMAL(14,2),
   CI_PRDCT_FEE    DECIMAL(14,2),
   CI_MBR_FEE    DECIMAL(14,2),
   TAXED_PRDCT_FEE    DECIMAL(20,8),
   TAXED_MBR_FEE    DECIMAL(20,8),
   TAXED_GPAY_MBR_FEE    DECIMAL(20,8),
   TAXED_CI_PRDCT_FEE    DECIMAL(20,8),
   TAXED_CI_MBR_FEE    DECIMAL(20,8)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_PRDCT_CNSM_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_CUST_CNSM_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_CUST_CNSM_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   GROUP_ID    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   PRDCT_FEE    DECIMAL(14,2),
   MBR_FEE    DECIMAL(14,2),
   GPAY_MBR_FEE    DECIMAL(14,2),
   CI_PRDCT_FEE    DECIMAL(14,2),
   CI_MBR_FEE    DECIMAL(14,2),
   TAXED_PRDCT_FEE    DECIMAL(20,8),
   TAXED_MBR_FEE    DECIMAL(20,8),
   TAXED_GPAY_MBR_FEE    DECIMAL(20,8),
   TAXED_CI_PRDCT_FEE    DECIMAL(20,8),
   TAXED_CI_MBR_FEE    DECIMAL(20,8)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_CUST_CNSM_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_CUST_BAS_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_CUST_BAS_M (
   STAT_MO    INT,
   GROUP_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   CMCC_CNTRY_CD    STRING,
   CMCC_TOWN_CD    STRING,
   DTGRP_AB_CD    STRING,
   DTGRP_AB_CD_2016    STRING,
   CORP_TYP_CD    INT,
   INDUS_TYP_CD    INT,
   INDUS_TYP2_CD    INT,
   VOCATION_TYP1_CD    STRING,
   PRVCGRP_TYP_CD    SMALLINT,
   NATGRP_TYP_CD    SMALLINT,
   PROF_TYP_CD    SMALLINT,
   SRV_OFC_CD    SMALLINT,
   YJ_VLD_IND    STRING,
   CMLBRB_GRP_IND    STRING,
   CUST_STS_CD    STRING,
   CUST_INNET_DT    INT,
   CUST_CHG_DT    INT,
   MRKT_CHNL_CD    STRING,
   HST_CD    STRING,
   CUST_ID    STRING,
   PAR_GROUP_ID    STRING,
   CUST_MGR_ID    STRING,
   GRPORG_TYP_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_CUST_BAS_M';

DROP TABLE IF EXISTS JCFW.TO_P_CORP_CUST_SRVINFO_UP_M;
CREATE EXTERNAL TABLE JCFW.TO_P_CORP_CUST_SRVINFO_UP_M (
   GROUP_ID    STRING,
   PRVCGRP_TYP_CD    SMALLINT,
   NATGRP_TYP_CD    SMALLINT,
   PROF_TYP_CD    SMALLINT,
   SRV_OFC_CD    SMALLINT,
   UPDT_DT    INT
)
PARTITIONED BY (branch STRING)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'=',','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/ODS/TO_P_CORP_CUST_SRVINFO_UP_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_PRDCT_RECACT_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_PRDCT_RECACT_M (
   STAT_MO    INT,
   GUSR_ID    STRING,
   BILL_CYC_CD    INT,
   CMCC_BRANCH_CD    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   REC_FEE    DECIMAL(14,2),
   WOFF_FEE    DECIMAL(14,2),
   WOFF_01_FEE    DECIMAL(14,2),
   WOFF_02_FEE    DECIMAL(14,2),
   WOFF_03_FEE    DECIMAL(14,2),
   WOFF_04_FEE    DECIMAL(14,2),
   WOFF_05_FEE    DECIMAL(14,2),
   WOFF_06_FEE    DECIMAL(14,2),
   WOFF_07_FEE    DECIMAL(14,2),
   WOFF_08_FEE    DECIMAL(14,2),
   WOFF_09_FEE    DECIMAL(14,2),
   WOFF_10_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_PRDCT_RECACT_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_STAR_CUST_ASES_PROV_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_STAR_CUST_ASES_PROV_M (
   USR_NBR    STRING,
   STAT_MO    INT,
   ASES_DT    INT,
   USR_ID    STRING,
   STAR_SCORE    INT,
   STAR_RANK_CD    STRING,
   STAR_MAIN_SCORE    INT,
   ADD_SCORE    INT,
   REDUCE_SCORE    INT,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_STAR_CUST_ASES_PROV_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_UNWOFF_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_UNWOFF_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   USR_ID    STRING,
   UNWOFF_IND    STRING,
   UNWOFF_FEE    DECIMAL(16,2),
   ACCUM_UNWOFF_FEE    DECIMAL(16,2),
   UNWOFF_CYC_M    INT,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_UNWOFF_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_4G_USR_BUSI_ATTR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_4G_USR_BUSI_ATTR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   IN_4G_MAIN_PKG_MO    INT,
   IN_4G_MAIN_PKG_USR_TYP    STRING,
   TRAN_SRC_PKG_DTL_CD    INT,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_4G_USR_BUSI_ATTR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_GPRS_FLUX_LAYER_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_GPRS_FLUX_LAYER_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   USR_NBR    STRING,
   MIX_PKG_ATTR    SMALLINT,
   STD_PKG_ATTR    SMALLINT,
   MIX_PKG_USR_TYP    STRING,
   STD_PKG_USR_TYP    STRING,
   MIX_PKG_DTL_TYP    INT,
   STD_PKG_DTL_TYP    INT,
   MIX_PKG_PRDCT_FEE    DECIMAL(16,2),
   STD_PKG_PRDCT_FEE    DECIMAL(16,2),
   MAIN_PKG_FLUX_SPLT_FEE    DECIMAL(16,2),
   PLUSPKG_PKG_PRDCT_FEE    DECIMAL(16,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_GPRS_FLUX_LAYER_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_SNAP_STK_USR_TRACK_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_SNAP_STK_USR_TRACK_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   ACT_VPMN_IND    STRING,
   ACT_HLZX_IND    STRING,
   MARK_CNCT_USR_IND    STRING,
   TERM_TYP_IND    STRING,
   PKG_TYP_IND    STRING,
   TF_IND    STRING,
   DG_IND    STRING,
   USR_USE_IND    STRING,
   STOP_IND    STRING,
   RTN_IND    STRING,
   CANC_IND    STRING,
   PRE_CANC_IND    STRING,
   FRZ_IND    STRING,
   KEEP_IND    STRING,
   BILL_INC    DECIMAL(14,2),
   RCT_3_BILL_INC    DECIMAL(14,2),
   CY_BILL_INC    INT,
   GPRS_FLUX    BIGINT,
   CY_GPRS_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_SNAP_STK_USR_TRACK_M';

DROP TABLE IF EXISTS JCFW.TW_F_CUST_VAL_ANLYS_M;
CREATE EXTERNAL TABLE JCFW.TW_F_CUST_VAL_ANLYS_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   INNET_DT    INT,
   INNET_MO_CNT    INT,
   TOT_FEE    DECIMAL(10,2),
   TOT_COST    DECIMAL(20,12),
   GPRS_FLUX    BIGINT,
   DEBET_MOB_DUR    INT,
   ORDR_PKG_CNT    INT,
   USR_STS_CD    STRING,
   GCUST_IND    STRING,
   INNET_USR_IND    STRING,
   INTELL_USR_IND    STRING,
   INNET_CHNL_CD    STRING,
   CUST_IND    STRING,
   CUST_ATTR_CD    STRING,
   AREA_TYP_CD    STRING,
   AGE_LAYER_CD    STRING,
   NET_TYP_CD    STRING,
   TERM_TYP_CD    STRING,
   TERM_SUBSY_IND    STRING,
   DIS_SUBSY_IND    STRING,
   EQ_SUBSY_IND    STRING,
   ENTITY_SUBSY_IND    STRING,
   CNTY    STRING,
   CUST_ID    STRING,
   PKG_DTL_CD    INT,
   PKG_DTL_NAM    STRING,
   USR_LVL_CD    SMALLINT,
   ORG_FEE    DECIMAL(20,12),
   AD_FEE    DECIMAL(20,12),
   BUSI_PRGD_FEE    DECIMAL(20,12),
   EXT_FEE    DECIMAL(20,12),
   BASE_SRV_FEE    DECIMAL(20,12),
   VALUE_ADDED_FEE    DECIMAL(20,12),
   OTHR_CUST_SRV_FEE    DECIMAL(20,12),
   GFT_TERM_FEE    DECIMAL(12,2),
   DIV_TERM_FEE    DECIMAL(12,2),
   OTHR_ENTITY_FEE    DECIMAL(20,12),
   SIM_CARD_COST    DECIMAL(20,12),
   SELL_TERM_COST    DECIMAL(12,2),
   BILL_FEE    DECIMAL(10,2),
   TERM_SELL_FEE    DECIMAL(12,2),
   INNER_AOASETL_FEE    DECIMAL(20,12),
   SIM_CAR_FEE    DECIMAL(10,2),
   CUST_INC    DECIMAL(10,2),
   IOT_MBR_IND    STRING,
   DL100_IND    STRING,
   CORP_MEMBER_ATR    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_F_CUST_VAL_ANLYS_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_ARPU_SNAP_USR_TRACK_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_ARPU_SNAP_USR_TRACK_M (
   USR_NBR    STRING,
   STAT_MO    INT,
   USR_ID    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   ARPU50_SNAP_USR_IND    STRING,
   ARPU120_SNAP_USR_IND    STRING,
   VPMN50_USR_IND    STRING,
   VPMN120_USR_IND    STRING,
   OUTNET_IND    STRING,
   OUTNET_DT    INT,
   CM_NOBILL_IND    STRING,
   CM_STOP_IND    STRING,
   ARPU50_CM_KEEP_IND    STRING,
   ARPU120_CM_VALLOST_IND    STRING,
   ARPU120_CM_KEEP_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_ARPU_SNAP_USR_TRACK_M';

DROP TABLE IF EXISTS JCFW.TW_TERM_TAC_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_TERM_TAC_BUSI_M (
   STAT_MO    INT,
   TAC    STRING,
   TOT_USR_CNT    INT,
   TOT_FEE    DECIMAL(16,2),
   SMS_USR_CNT    INT,
   SMS_CNT    INT,
   MNET_SMS_CNT    INT,
   MMS_USR_CNT    INT,
   MMS_CNT    INT,
   MNET_MMS_CNT    INT,
   GPRS_USR_CNT    INT,
   NTD_GPRS_USRCNT    INT,
   TD_GPRS_USRCNT    INT,
   NTD_GPRS_FLUX    BIGINT,
   TD_GPRS_FLUX    BIGINT,
   WLAN_USR_CNT    INT,
   WLAN_DEBET_DUR    INT,
   VOC_USR_CNT    INT,
   NTD_VOC_USRCNT    INT,
   NTD_DEBET_DUR    INT,
   TD_VOC_USRCNT    INT,
   TD_DEBET_DUR    INT,
   TD_TERM_IND    STRING,
   LTE_GPRS_USRCNT    INT,
   LTE_GPRS_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_TERM_TAC_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_FAM_PAY_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_FAM_PAY_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   MAIN_NBR_IND    STRING,
   MAIN_NBR    STRING,
   FAM_MBR_CNT    SMALLINT,
   SUB_ALLSPAY_AMT    DECIMAL(16,2),
   SUB_FIXSPAY_AMT    DECIMAL(16,2),
   SUB_CHRG_AMT    DECIMAL(16,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_FAM_PAY_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CONTR_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CONTR_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   BAL_MODU    INT,
   BAL_RTN_MODU    INT,
   FIX_AJUST_MODU    INT,
   CMIT_CONSM_MODU    INT,
   MARK_VAL    INT,
   VPMN_IND    STRING,
   CORP_IND    STRING,
   DATABUSI_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CONTR_USR_M';

DROP TABLE IF EXISTS JCFW.TW_CHNL_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_CHNL_BUSI_M (
   STAT_MO    INT,
   CHNL_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   GIF_GOTONE_NEWUSR_CNT    INT,
   GIF_TD_NEWUSR_CNT    INT,
   GIF_PRE_NEWUSR_CNT    INT,
   GIF_MZONE_NEWUSR_CNT    INT,
   GIF_OTHER_NEWUSR_CNT    INT,
   GIF_OUTNET_USR_CNT    INT,
   GIF_REACH_USR_CNT    INT,
   GIF_ZERO_CALL_USR_CNT    INT,
   GOTONE_NEWUSR_CNT    INT,
   TD_NEWUSR_CNT    INT,
   PRE_NEWUSR_CNT    INT,
   MZONE_NEWUSR_CNT    INT,
   OTHER_NEWUSR_CNT    INT,
   OUTNET_USR_CNT    INT,
   REACH_USR_CNT    INT,
   ZERO_CALL_USR_CNT    INT,
   PRE_TK_SELL_CNT    INT,
   MZONE_TK_SELL_CNT    INT,
   BUSI_OPR_CNT    INT,
   PKG_MARKPLAN_OPR_CNT    INT,
   NEW_PKG_MARKPLAN_OPR_CNT    INT,
   HLZX_ORP_CNT    INT,
   DISC_PRECASH_USR_CNT    INT,
   DISC_PRECASH_AMT    DECIMAL(16,2),
   CHRG_CNT    INT,
   CHRG_AMT    DECIMAL(16,2),
   CARD_SELL_OPR_CNT    INT,
   CARD_SELL_CNT    INT,
   CARD_SELL_INCOME    DECIMAL(16,2),
   NEW_BUSI_CNT    INT,
   GOTONE_BUSI_CNT    INT,
   PRE_BUSI_CNT    INT,
   MZONE_BUSI_CNT    INT,
   KEY_NEW_BUSI_CNT    INT,
   NEW_BUSI_ORDER_CNT    INT,
   YXKD_OPR_CNT    INT,
   TERM_SELL_CNT    INT,
   NOT_TERM_SELL_CNT    INT,
   TERM_PHONE_SELL_CNT    INT,
   NOT_TERM_PHONE_SELL_CNT    INT,
   NETBOOK_SELL_CNT    INT,
   DATACARD_SELL_CNT    INT,
   WLPHONE_SELL_CNT    INT,
   TD_PHONE_SELL_CNT    INT,
   OTHER_TERM_SELL_CNT    INT,
   BASE_BUSI_CNT    INT,
   QRY_BUSI_CNT    INT,
   GRP_OPR_CNT    INT,
   BAT_OPR_CNT    INT,
   NEWEXP_NEWBUSI_CNT    INT,
   NEWEXP_NEWBUSI_SALE_CNT    INT,
   NEWEXP_USR_CNT    INT,
   OPR_USR_CNT    INT,
   MOB_TBCARD_SALES_CNT    INT,
   VALUE_ADDED_SRVC_NEW_ORD_CNT    INT,
   MOBTERM_BIND_CNT    INT,
   MOBTERM_CHRG_BIND_CNT    INT,
   TERM_MOB2G_CNT    INT,
   CHRGPRE_CONTR_CNT    INT,
   TERM_CONTR_SELLCNT    INT,
   TRML_ONLY_SELLCNT    INT,
   GOTONE_KH_CNT    INT,
   TK_4G_ACT_CNT    INT,
   PKG_4G_ACPT_CNT    INT,
   TK_ACT_CNT    INT,
   BRND_CHG_CNT    INT,
   CHG_4GUSIM_CNT    INT,
   STOPANDOPEN_SUBS_CNT    INT,
   SH_STOPANDOPEN_SUBS_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CHNL_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_CS_12580_VIST_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_CS_12580_VIST_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   VIST_TYP_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   COOPR_CD    INT,
   CALL_CNT    INT,
   SMS_CNT    INT,
   DEBET_DUR    INT,
   GPRS_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CS_12580_VIST_USR_M';

DROP TABLE IF EXISTS JCFW.TW_ELEC_CHNL_ACT_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_ELEC_CHNL_ACT_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   WEB_LOGIN_CD    SMALLINT,
   SMS_LOGIN_CD    SMALLINT,
   WAP_LOGIN_CD    SMALLINT,
   TRADE_LOGIN_CD    SMALLINT,
   HOTLINE_LOGIN_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_ELEC_CHNL_ACT_USR_M';

DROP TABLE IF EXISTS JCFW.TW_CHNL_YK_M;
CREATE EXTERNAL TABLE JCFW.TW_CHNL_YK_M (
   STAT_MO    INT,
   CHNL_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   CHNL_MAG_ID    STRING,
   EMPLOYEE_NAM    STRING,
   MAG_CONTACT_ID    STRING,
   YK_CHNL_IND    STRING,
   YK_FTUR_CD    STRING,
   CHNL_WARN_LVL_CD    STRING,
   CHNL_ACTV_NBR_CNT    INT,
   YK_NBR_CNT    INT,
   DATA_DT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CHNL_YK_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_YK_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_YK_USR_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   CHNL_CD    STRING,
   CHNL_WARN_LVL_CD    STRING,
   CUDB_YK_USR_NBR    STRING,
   YK_FTUR_CD    STRING,
   BRND_CD    SMALLINT,
   AMT_FEE    DECIMAL(14,2),
   CM_MOU    INT,
   DATA_DT    INT,
   NBR_RNK    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_YK_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_LAB_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_LAB_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_LAB_USR_M';

DROP TABLE IF EXISTS JCFW.TW_TERM_CHG_USR_BASE_M;
CREATE EXTERNAL TABLE JCFW.TW_TERM_CHG_USR_BASE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   INNET_MO_CNT    INT,
   BFR_IMEI    STRING,
   BFR_TAC    STRING,
   BFR_TOT_USE_DUR    INT,
   BFR_LAST_USE_DUR    INT,
   BFR_USE_SPAN    INT,
   BFR_NEXT_TOT_USE_DUR    INT,
   AFT_IMEI    STRING,
   AFT_TAC    STRING,
   AFT_TOT_USE_DUR    INT,
   AFT_LAST_USE_DUR    INT,
   AFT_USE_SPAN    INT,
   AFT_NEXT_TOT_USE_DUR    INT,
   TERM_CHG_CNT    INT,
   TERM_CHG_TYP_CD    STRING,
   TERM_NEW_CHG_TYP_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_TERM_CHG_USR_BASE_M';

DROP TABLE IF EXISTS JCFW.TW_TERM_USR_IMEI_USE_STK_M;
CREATE EXTERNAL TABLE JCFW.TW_TERM_USR_IMEI_USE_STK_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   IMEI    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   TAC    STRING,
   FST_EFF_DT    INT,
   LAST_EFF_DT    INT,
   LAST_INV_DT    INT,
   TOT_USE_CNT    INT,
   TOT_USE_DUR    INT,
   LAST_USE_DUR    INT,
   USE_SPAN    INT,
   NEXT_TOT_USE_DUR    INT,
   CM_USE_CNT    INT,
   CM_USE_DUR    INT,
   LAST_IMEI_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_TERM_USR_IMEI_USE_STK_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_SPLIT_FLOW_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_SPLIT_FLOW_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   IMEI    STRING,
   GPRS_FLUX    BIGINT,
   GPRS_TD_FLUX    BIGINT,
   MOB_USR_IND    STRING,
   MIFI_IND    STRING,
   USR_STS_CD    INT,
   DATACRD_USR_IND    STRING,
   IOT_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_SPLIT_FLOW_USR_M';

DROP TABLE IF EXISTS JCFW.TW_CHNL_INNET_INF_M;
CREATE EXTERNAL TABLE JCFW.TW_CHNL_INNET_INF_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CHNL_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   USR_INNET_DT    INT,
   OUTNET_DT    INT,
   INNET_USR_IND    STRING,
   SELL_DT    INT,
   CHNL_DATASRC_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CHNL_INNET_INF_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_TERM_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_TERM_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   LAST_IMEI    STRING,
   LAST_TAC    STRING,
   CPY_IMEI_USR_IND    STRING,
   TYJ_INTELL_TERM_USR_IND    STRING,
   PRVC_INTELL_TERM_USR_IND    STRING,
   CUSTM_TERM_USR_TYP    SMALLINT,
   IPHONE_USR_IND    STRING,
   TYJ_TD_TERM_USR_IND    STRING,
   PRVC_TD_TERM_USR_IND    STRING,
   NEW_TD_TERM_USR_IND    STRING,
   LOST_TD_TERM_USR_IND    STRING,
   WLAN_TERM_USR_IND    STRING,
   TD_MOB_IND    STRING,
   INTELL_MOB_IND    STRING,
   MIFI_TERM_IND    STRING,
   TERM_KIND    SMALLINT,
   CMN_TOT_USE_DUR    INT,
   CMN_CM_USE_DUR    INT,
   CMN_FST_EFF_DT    INT,
   CMN_TAC_IND    STRING,
   CMN_CM_NEW_IND    STRING,
   CMN_STANDARD_OPER    STRING,
   CMN_CM_SELL_IND    STRING,
   CMN_PLAT_CD    STRING,
   LAST_TOT_USE_DUR    INT,
   LAST_CM_USE_DUR    INT,
   LAST_FST_EFF_DT    INT,
   LAST_TAC_IND    STRING,
   LAST_CM_NEW_IND    STRING,
   LAST_STANDARD_OPER    STRING,
   LAST_CM_SELL_IND    STRING,
   LAST_PLAT_CD    STRING,
   N_TERM_USR_IND    STRING,
   CMN_IMEI    STRING,
   CMN_TAC    STRING,
   USE_TERM_VOLTE_IND    STRING,
   N_USE_TERM_VOLTER_IND    STRING,
   USE_CMN_TERM_VOLTE_IND    STRING,
   STAT_CHG_MO    INT,
   BFR_TAC    STRING,
   AFT_TAC    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_TERM_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_STAR_CUST_ASES_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_STAR_CUST_ASES_M (
   USR_NBR    STRING,
   STAT_MO    INT,
   ASES_DT    INT,
   USR_ID    STRING,
   STAR_SCORE    INT,
   STAR_RANK_CD    STRING,
   STAR_MAIN_SCORE    INT,
   ADD_SCORE    INT,
   REDUCE_SCORE    INT,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_STAR_CUST_ASES_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_USR_STAR_RNK_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_USR_STAR_RNK_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   USR_ID    STRING,
   INNET_CNT    INT,
   CUST_TYP_CD    STRING,
   ARPU    DECIMAL(14,2),
   BIND_FN_IND    STRING,
   BIND_CN_IND    STRING,
   BIND_VNET_IND    STRING,
   CONTR_BIND_CNT    INT,
   BIND_PAY_IND    STRING,
   DBL_STOP_CNT    INT,
   TERM_CONTR_BIND_IND    STRING,
   BUSI_CONTR_BIND_IND    STRING,
   CORP_DG_IND    STRING,
   T_DBL_STOP_CNT    INT,
   L1_DBL_STOP_CNT    INT,
   L2_DBL_STOP_CNT    INT,
   L3_DBL_STOP_CNT    INT,
   L4_DBL_STOP_CNT    INT,
   L5_DBL_STOP_CNT    INT,
   L6_DBL_STOP_CNT    INT,
   L7_DBL_STOP_CNT    INT,
   L8_DBL_STOP_CNT    INT,
   L9_DBL_STOP_CNT    INT,
   L10_DBL_STOP_CNT    INT,
   L11_DBL_STOP_CNT    INT,
   CNSUMMIN_WILLEXCE30_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_USR_STAR_RNK_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_KEY_KEEP_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_KEY_KEEP_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_KEY_KEEP_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_HOMEBRB_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_HOMEBRB_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   USR_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   CM_INNET_DUR_RNK_CD    INT,
   CM_INNET_DUR    INT,
   CM_FLUX_RNK_CD    INT,
   CM_GPRS_FLUX    BIGINT,
   LOGIN_CNT    INT,
   PKG_CYC_CD    SMALLINT,
   PKG_SPEED_CD    SMALLINT,
   PKG_TYP_CD    SMALLINT,
   NEW_USR_IND    STRING,
   START_DT    INT,
   BRB_TYP_CD    SMALLINT,
   CUST_TYP_CD    SMALLINT,
   MRKT_CHNL_CD    STRING,
   BASS_PRDCT_CD    STRING,
   SUBSPROD_ID    STRING,
   PKG_SUBSPROD_ID    STRING,
   PKG_BASS_PRDCT_CD    STRING,
   PKG_EFF_DT    INT,
   PKG_END_DT    INT,
   USR_STS_IND    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_HOMEBRB_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_REAL_NAME_INFO_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_REAL_NAME_INFO_M (
   STAT_MO    INT,
   USR_ID    STRING,
   CUST_ID    STRING,
   USR_NBR    STRING,
   USR_ID_TYP_CD    STRING,
   USR_ID_NBR    STRING,
   USR_NAM    STRING,
   USR_ADDRESS    STRING,
   ACCT_ID_TYP_CD    STRING,
   ACCT_ID_NBR    STRING,
   ACCT_NAM    STRING,
   ACCT_ADDRESS    STRING,
   OPE_ID_TYP_CD    STRING,
   OPE_ID_NBR    STRING,
   OPE_NAM    STRING,
   OPE_ADDRESS    STRING,
   REAL_NAME_DEC    STRING,
   ACCOUNT_TYP    STRING,
   UPDT_DT    INT,
   REAL_NAME_CD    STRING,
   GDR_TYP_CD    SMALLINT,
   AGE_CNT    INT,
   BIRTH_DT    INT,
   ZODIAC_NAM    STRING,
   ID_HOME_PROV    STRING,
   ID_HOME_CITY    STRING,
   CMCC_BRANCH_CD    STRING,
   ACPT_DT    INT,
   ACPT_TIM    INT,
   ACPT_CHNL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_REAL_NAME_INFO_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CMPTUSR_CNTY_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CMPTUSR_CNTY_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   CMCC_CNTY_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CMPTUSR_CNTY_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_USR_CNTY_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_USR_CNTY_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_CNTY_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_USR_CNTY_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MM_USR_STS_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MM_USR_STS_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LOGIN_TYP    STRING,
   LOGIN_CD    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   FIRST_LOGIN_DT    INT,
   FIRST_LOGIN_TIM    STRING,
   LAST_LOGIN_DT    INT,
   LAST_LOGIN_TIM    STRING,
   LOGIN_CNT    INT,
   TERM_DEVC_CD    STRING,
   TERM_PLTFM_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MM_USR_STS_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MNG_PLNTFM_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MNG_PLNTFM_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   CLUB_HUSR_IND    STRING,
   CLUB_NUSR_IND    STRING,
   CLUB_SUSR_IND    STRING,
   CLUB_SUSR_FUNC_FEE    DECIMAL(16,2),
   IVR_USR_IND    STRING,
   CR_USR_IND    STRING,
   SRING_USR_IND    STRING,
   CR_INF_FEE    INT,
   SRING_INF_FEE    DECIMAL(14,2),
   CR_DWN_CNT    INT,
   SRING_DWN_CNT    INT,
   CHRG_SRING_DWN_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MNG_PLNTFM_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_SECUR_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_SECUR_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   SECUR_QRY_IND    STRING,
   SECUR_QRY_NEW_IND    STRING,
   SECUR_QRY_CANC_IND    STRING,
   SECUR_QRY_ACTV_IND    STRING,
   SECUR_QRY_ACTV_CNT    INT,
   SECUR_TRD_IND    STRING,
   SECUR_TRD_NEW_IND    STRING,
   SECUR_TRD_CANC_IND    STRING,
   SECUR_TRD_ACTV_IND    STRING,
   SECUR_TRD_ACTV_CNT    INT,
   SECUR_IND    STRING,
   SECUR_NEW_IND    STRING,
   SECUR_CANC_IND    STRING,
   SECUR_ACTV_IND    STRING,
   SECUR_ACTV_CNT    INT,
   SECUR_CHRG_QRY_IND    STRING,
   SECUR_CHRG_TRD_IND    STRING,
   SECUR_CHRG_COMB_IND    STRING,
   SECUR_CHRG_CNSTR_ND    STRING,
   SECUR_CHRG_IND    STRING,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_SECUR_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_WLAN_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_WLAN_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   WLAN_TOT_DUR    INT,
   WLAN_OVER_PKG_DUR    INT,
   PRVC_WLAN_DUR    INT,
   CNTRY_WLAN_DUR    INT,
   AUTO_AUTH_PLAT_DUR    INT,
   EWLAN_DUR    INT,
   MOB_WLAN_DUR    INT,
   PC_WLAN_DUR    INT,
   TABLET_WLAN_DUR    INT,
   MOB_ANDROID_DUR    INT,
   MOB_APPLE_MAC_DUR    INT,
   MOB_APPLE_ISO_DUR    INT,
   MOB_WINDOWS_DUR    INT,
   MOB_WINDOWS_MOBILE_DUR    INT,
   MOB_WINDOWS_PHONE_DUR    INT,
   MOB_BLACKBERRY_DUR    INT,
   MOB_SYMBIAN_DUR    INT,
   COLLG_DEBET_DUR    INT,
   CALL_DUR    BIGINT,
   FREE_DUR    BIGINT,
   WLAN_TOT_FLUX    BIGINT,
   WLAN_OVER_PKG_FLUX    BIGINT,
   PRVC_WLAN_FLUX    BIGINT,
   CNTRY_WLAN_FLUX    BIGINT,
   AUTO_AUTH_PLAT_FLUX    BIGINT,
   EWLAN_FLUX    BIGINT,
   MOB_WLAN_FLUX    BIGINT,
   PC_WLAN_FLUX    BIGINT,
   TABLET_WLAN_FLUX    BIGINT,
   MOB_ANDROID_FLUX    BIGINT,
   MOB_APPLE_MAC_FLUX    BIGINT,
   MOB_APPLE_ISO_FLUX    BIGINT,
   MOB_WINDOWS_FLUX    BIGINT,
   MOB_WINDOWS_MOBILE_FLUX    BIGINT,
   MOB_WINDOWS_PHONE_FLUX    BIGINT,
   MOB_BLACKBERRY_FLUX    BIGINT,
   MOB_SYMBIAN_FLUX    BIGINT,
   COLLG_FLUX    BIGINT,
   WLAN_MOB_FEE    DECIMAL(12,2),
   WLAN_MO_PKG_FEE    DECIMAL(12,2),
   WLAN_FEE    DECIMAL(12,2),
   AUTO_AUTH_PLAT_LOGIN_CNT    INT,
   EWLAN_LOGIN_CNT    INT,
   LOGIN_CNT    INT,
   WLAN_DUR_PKG_TYP_CD    SMALLINT,
   WLAN_FLUX_PKG_TYP_CD    SMALLINT,
   WLAN_SPCL_PKG_USR_IND    STRING,
   WLAN_CAMPUS_PKG_USR_IND    STRING,
   ACTV_USR_IND    STRING,
   COLLG_USR_IND    STRING,
   NEW_FLUX_PKG_TYP_CD    SMALLINT,
   REG_IND    STRING,
   PROV_SPCL_IND    STRING,
   WLAN_PKG_CD    STRING,
   NORMAL_PKG_USR_IND    STRING,
   PKG_FEE    DECIMAL(12,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_WLAN_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_MP_CXLM_EXT_EMP_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_MP_CXLM_EXT_EMP_BUSI_M (
   STAT_MO    INT,
   BUSI_CD    STRING,
   RECOM_CHNL_CD    STRING,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BUSI_ACPT_FAIL_CNT    INT,
   BUSI_ACPT_SUCC_CNT    INT,
   CM_REWARD_FEE    DECIMAL(16,4),
   CM_REWARD_CNT    INT,
   LAST_1_MO_REWARD_FEE    DECIMAL(16,4),
   LAST_1_MO_REWARD_CNT    INT,
   LAST_2_MO_REWARD_FEE    DECIMAL(16,4),
   LAST_2_MO_REWARD_CNT    INT,
   LAST_3_MO_REWARD_FEE    DECIMAL(16,4),
   LAST_3_MO_REWARD_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_MP_CXLM_EXT_EMP_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_KEY_BUSI_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_KEY_BUSI_USR_M (
   STAT_MO    INT,
   BUSI_TYP    STRING,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ORDR_USR_IND    STRING,
   FREE_ORDR_USR_IND    STRING,
   ACTV_USR_IND    STRING,
   FREE_ACTV_USR_IND    STRING,
   NEW_MUTE_USR_IND    STRING,
   ACTV_TURN_MUTE_USR_IND    STRING,
   CONT_MUTE_MO_CNT    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_KEY_BUSI_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_RFID_SIM_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_RFID_SIM_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   RFID_SIM_ACT_USR_IND    STRING,
   RFID_SIM_ACT_USR2_IND    STRING,
   RFID_SIM_ACT_USR3_IND    STRING,
   RFID_SIM_USR_IND    STRING,
   RFID_SIM_USR2_IND    STRING,
   RFID_SIM_USR3_IND    STRING,
   RFID_SIM_USR4_IND    STRING,
   RFID_SIM_USR5_IND    STRING,
   RFID_SIM_USR6_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_RFID_SIM_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBTB_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBTB_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOBTB_USR_IND    STRING,
   ACTV_CARD_CNT    INT,
   ACTV_USR_IND    STRING,
   NEW_ACTV_USR_IND    STRING,
   CANC_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBTB_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBREAD_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBREAD_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PCK_USR_IND    STRING,
   ACSS_USR_IND    STRING,
   WAP_ACSS_USR_IND    STRING,
   CLI_ACSS_USR_IND    STRING,
   FST_ACSS_USR_IND    STRING,
   ORD_USR_IND    STRING,
   NEW_PCK_USR_IND    STRING,
   PAY_USR_IND    STRING,
   PCK3_USR_IND    STRING,
   PCK5_USR_IND    STRING,
   OTH_USR_IND    STRING,
   ACT_USR_IND    STRING,
   WHL_ORD_USR_IND    STRING,
   WORD_ORD_USR_IND    STRING,
   BK_DWN_USR_IND    STRING,
   CHK_ACT_USR_IND    STRING,
   FREE_CHPT_PV_CNT    INT,
   PAY_CHPT_PV_CNT    INT,
   WAP_PLT_ORD_CNT    INT,
   WWW_PLT_ORD_CNT    INT,
   G3_PLT_ORD_CNT    INT,
   CLI_PLT_ORD_CNT    INT,
   SRVR_PLT_ORD_CNT    INT,
   BOSS_PLT_ORD_CNT    INT,
   SMS_PLT_ORD_CNT    INT,
   MM_PLT_ORD_CNT    INT,
   ALL_PLT_ORD_CNT    INT,
   INFO_FEE    DECIMAL(14,2),
   PCK3_INFO_FEE    DECIMAL(14,2),
   PCK5_INFO_FEE    DECIMAL(14,2),
   PCK_INFO_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBREAD_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBNEWS_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBNEWS_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   SP_CODE    STRING,
   SP_SUBBUSI_CD    STRING,
   NEWS_CLASS_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   NEW_USR_IND    STRING,
   PAY_USR_IND    STRING,
   CANC_USR_IND    STRING,
   SUCC_RECV_IND    STRING,
   FREE_USR_IND    STRING,
   VAL_USR_IND    STRING,
   ORDR_USR_IND    STRING,
   PAY_AMT    DECIMAL(14,2),
   OPR_CD    STRING,
   EFF_DT    INT,
   EFF_TIM    STRING,
   DISC_IND    STRING,
   DOWN_CNT    INT,
   DOWN_USR_IND    STRING,
   SUCCREC_CNT    INT,
   SUCCDOWN_CNT    INT,
   SUCCREC_ICP_SERV_CNT    INT,
   ISSUE_CNT    INT,
   ERR_CNT    INT,
   ERR1_CNT    INT,
   ERR2_CNT    INT,
   ERR3_CNT    INT,
   ERR4_CNT    INT,
   ERR5_CNT    INT,
   ERR6_CNT    INT,
   ERR7_CNT    INT,
   ERR8_CNT    INT,
   ERR9_CNT    INT,
   ERR10_CNT    INT,
   OTH_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBNEWS_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBNEWS_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBNEWS_M (
   STAT_MO    INT,
   CMCC_BRACH_CD    STRING,
   BRND_CD    SMALLINT,
   SP_CODE    STRING,
   SP_SUBBUSI_CD    STRING,
   NEWS_CLASS_CD    STRING,
   SEND_SUCC_CNT    INT,
   SEND_FAIL_CNT    INT,
   SUCC_RECV_CNT    INT,
   ISUSE_CNT    INT,
   ORDR_CNT    INT,
   CANC_CNT    INT,
   INCM_FEE    DECIMAL(14,2),
   SEND_USRCNT    INT,
   ORDR_USRCNT    INT,
   SUCC_RECV_USRCNT    INT,
   FEE_USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBNEWS_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBNEWS_O_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBNEWS_O_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   ICP_SERV_ID    STRING,
   NEWS_CD    INT,
   ORD_ROUTE_CD    STRING,
   PKG_CD    SMALLINT,
   BRND_CD    INT,
   ORD_STS    INT,
   CMCC_BRANCH_CD    STRING,
   UPDT_DT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBNEWS_O_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MM_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MM_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   PRTL_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   TERM_MDL_ID    INT,
   ACTV_USR_IND    STRING,
   REG_USR_IND    STRING,
   USE_USR_IND    STRING,
   SBJ_DLOAD_CNT    INT,
   SOFT_DLOAD_CNT    INT,
   GAME_DLOAD_CNT    INT,
   FREE_APP_DLOAD_CNT    INT,
   PAY_APP_DLOAD_CNT    INT,
   OTH_APP_DLOAD_CNT    INT,
   MUSIC_ORDR_CNT    INT,
   MUSIC_ORDR_AMT    DECIMAL(14,2),
   MUSIC_USE_CNT    INT,
   READ_ORDR_CNT    INT,
   READ_ORDR_AMT    DECIMAL(14,2),
   READ_USE_CNT    INT,
   GAME_ORDR_CNT    INT,
   GAME_ORDR_AMT    DECIMAL(14,2),
   GAME_USE_CNT    INT,
   VIDEO_ORDR_CNT    INT,
   VIDEO_ORDR_AMT    DECIMAL(14,2),
   VIDEO_USE_CNT    INT,
   WAPHALL_USE_CNT    INT,
   LOGIN_CNT    INT,
   ACSS_CNT    INT,
   APP_DLOAD_PAY_AMT    DECIMAL(14,2),
   CLI_DLOAD_CNT    INT,
   MOBNEWS_ORDR_CNT    INT,
   MOBFLASH_ORDR_CNT    INT,
   ACTV_DUR    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MM_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_PCA_REL_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_PCA_REL_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   CAWAKE_USR_IND    STRING,
   CAWAKE_NEW_USR_IND    STRING,
   CAWAKE_CANC_USR_IND    STRING,
   SMSRTN_USR_IND    STRING,
   SMSRTN_NEW_USR_IND    STRING,
   SMSRTN_CANC_USR_IND    STRING,
   AUTORPLY_USR_IND    STRING,
   AUTORPLY_NEW_USR_IND    STRING,
   AUTORPLY_CANC_USR_IND    STRING,
   AUTORPLY_FEE    DECIMAL(12,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_PCA_REL_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_HI_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_HI_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   HI_CNSM_USR_IND    STRING,
   HI_FLUX_USR_IND    STRING,
   HI_USE_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_HI_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_WETHER_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_WETHER_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   SP_SUBBUSI_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   OPEN_DT    INT,
   CANC_DT    INT,
   RECFEE_DT    INT,
   MOR_REACH_CNT    INT,
   EVEN_REACH_CNT    INT,
   REC_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_WETHER_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MAIL139_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MAIL139_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   MAIL_TYP_CD    SMALLINT,
   REG_TYP_CD    SMALLINT,
   NEW_REG_USR_IND    STRING,
   CANC_USR_IND    STRING,
   ACTV_IND    STRING,
   FRZ_IND    STRING,
   USE_ADDBUSI_IND    STRING,
   OPEN_PUSHMAIL_IND    STRING,
   CANC_PUSHMAIL_IND    STRING,
   NEW_PUSHMAIL_IND    STRING,
   OPEN_PRTN_IND    STRING,
   USE_PRTN_IND    STRING,
   USE_SMS_MNG_IND    STRING,
   LOG_CNT    INT,
   WEB_LOG_CNT    INT,
   WAP_LOG_CNT    INT,
   SEND_MAIL_CNT    INT,
   WEB_SEND_MAIL_CNT    INT,
   SMS_SEND_MAIL_CNT    INT,
   SMTP_SEND_MAIL_CNT    INT,
   PUSHMAIL_SEND_MAIL_CNT    INT,
   PUSHMAIL_RECV_MAIL_CNT    INT,
   RECV_MAIL_CNT    INT,
   POP_RECV_MAIL_CNT    INT,
   IMAP_RECV_MAIL_CNT    INT,
   RW_RECV_MAIL_CNT    INT,
   SEND_SMS_CNT    INT,
   USE_ADDVAL_BUSI_CNT    INT,
   USE_SMS_MNG_CNT    INT,
   ACTV_DUR    INT,
   MAIL139_TOT_FEE    DECIMAL(14,2),
   MAIL_SRVC_TYP_CD    SMALLINT,
   USR_NCKNM    STRING,
   CNSLT_ACTV_USR_IND    STRING,
   MUTE_USR_IND    STRING,
   LOST_USR_IND    STRING,
   CHRG_USR_IND    STRING,
   REG_USR_IND2    STRING,
   REG_TYP2    SMALLINT,
   REG_USR_IND    STRING,
   REG_TYP    SMALLINT,
   RTN_W_CNT    INT,
   SMS_DOWN_CNT    INT,
   SMS_UP_CNT    INT,
   MMS_DOWN_CNT    INT,
   SMTP_CNCT_CNT    INT,
   POP_CNCT_CNT    INT,
   LSMS_DOWN_CNT    INT,
   NB_SMS_DOWN_CNT    INT,
   NB_MMS_DOWN_CNT    INT,
   ADR_USE_CNT    INT,
   RSS_USE_CNT    INT,
   DISC_USE_CNT    INT,
   FAX_USE_CNT    INT,
   NEWMAIL_NTC_CNT    INT,
   WW_MAIL_SEND_CNT    INT,
   WN_MAIL_SEND_CNT    INT,
   WW_MAIL_RECV_CNT    INT,
   WN_MAIL_RECV_CNT    INT,
   PUSHMAIL_UP_CNT    INT,
   PUSHMAIL_DOWN_CNT    INT,
   MMS_MAIL_RECV_CNT    INT,
   SMS_MAIL_RECV_CNT    INT,
   WAP_MAIL_RECV_CNT    INT,
   POP_MAIL_RECV_CNT    INT,
   MAIL_SEND_SMS_CNT    INT,
   MAIL_SEND_MMS_CNT    INT,
   MAIL_SEND_FAX_CNT    INT,
   ZX_CNT    INT,
   NCKNAM_USR_IND    STRING,
   LAST_ACTV_DT    INT,
   SRCE_TYP_CD    SMALLINT,
   ORDR_DT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MAIL139_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_CPRINT_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_CPRINT_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   USR_TYP    STRING,
   BUSI_TYP    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   CPRINT_USR_IND    STRING,
   NEW_USR_IND    STRING,
   LOST_USR_IND    STRING,
   FEE    DECIMAL(10,2),
   USE_CPRINT_CLI_IND    STRING,
   USE_SPCL_CPRINT_IND    STRING,
   USE_BCK_WHITE_LIST_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_CPRINT_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_PCA_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_PCA_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   USR_TYP    STRING,
   BUSI_TYP    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   PCA_USR_IND    STRING,
   NEW_USR_IND    STRING,
   LOST_USR_IND    STRING,
   FEE    DECIMAL(10,2),
   USE_FUNC_IND    STRING,
   GFT_CNT    INT,
   DEMAND_CNT    INT,
   PRDCT_CD    STRING,
   BRND_CD    SMALLINT,
   EFF_DT    INT,
   INV_DT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_PCA_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_SP_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_SP_BUSI_M (
   STAT_MO    INT,
   SP_CD    STRING,
   OPERATOR_CD    STRING,
   OPERATOR_NAM    STRING,
   BUSI_CLASS_CD    STRING,
   BILL_TYP_CD    STRING,
   INFO_FEE    DECIMAL(14,2),
   VALID_DT    INT,
   EXPIRE_DT    INT,
   VALID_FLAG    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_SP_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_SP_INFO_M;
CREATE EXTERNAL TABLE JCFW.TW_SP_INFO_M (
   STAT_MO    INT,
   SP_CD    STRING,
   VALID_DT    INT,
   EXPIRE_DT    INT,
   SP_NAM    STRING,
   OPER_MODE    STRING,
   VALID_FLAG    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_SP_INFO_M';

DROP TABLE IF EXISTS JCFW.TW_USR_CNTY_MO;
CREATE EXTERNAL TABLE JCFW.TW_USR_CNTY_MO (
   USR_NBR    STRING,
   TM_INTRVL_CD    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PERMNT_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_USR_CNTY_MO';

DROP TABLE IF EXISTS JCFW.TW_USRCALL_SPLSRVR_MO;
CREATE EXTERNAL TABLE JCFW.TW_USRCALL_SPLSRVR_MO (
   USR_NBR    STRING,
   B_NBR    STRING,
   UPD_DT    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   CURRYR_CALL_CNT    INT,
   CURRYR_DEBET_DUR    INT,
   MON1_CALL_CNT    INT,
   MON2_CALL_CNT    INT,
   MON3_CALL_CNT    INT,
   MON4_CALL_CNT    INT,
   MON5_CALL_CNT    INT,
   MON6_CALL_CNT    INT,
   MON7_CALL_CNT    INT,
   MON8_CALL_CNT    INT,
   MON9_CALL_CNT    INT,
   MON10_CALL_CNT    INT,
   MON11_CALL_CNT    INT,
   MON12_CALL_CNT    INT,
   MON1_DEBET_DUR    INT,
   MON2_DEBET_DUR    INT,
   MON3_DEBET_DUR    INT,
   MON4_DEBET_DUR    INT,
   MON5_DEBET_DUR    INT,
   MON6_DEBET_DUR    INT,
   MON7_DEBET_DUR    INT,
   MON8_DEBET_DUR    INT,
   MON9_DEBET_DUR    INT,
   MON10_DEBET_DUR    INT,
   MON11_DEBET_DUR    INT,
   MON12_DEBET_DUR    INT
)
PARTITIONED BY (branch STRING,year INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_USRCALL_SPLSRVR_MO';

DROP TABLE IF EXISTS JCFW.TO_NB_CPRINT_USR_ORDR_M;
CREATE EXTERNAL TABLE JCFW.TO_NB_CPRINT_USR_ORDR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   EFF_DT    INT,
   STS_CD    STRING,
   INV_DT    INT,
   OPER_DT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/ODS/TO_NB_CPRINT_USR_ORDR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_PCA_USR_ORDR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_PCA_USR_ORDR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   EFF_DT    INT,
   STS_CD    STRING,
   INV_DT    INT,
   ORDR_CHNL_CD    STRING,
   CANC_CHNL_CD    STRING,
   BUSI_TYP    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_PCA_USR_ORDR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBLOT_USE_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBLOT_USE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   NEW_ACT_IND    STRING,
   BUY_CNT    INT,
   BUY_AMT    DECIMAL(14,2),
   MON_FEE    DECIMAL(14,2),
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBLOT_USE_M';

DROP TABLE IF EXISTS JCFW.TW_MOBGAME_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_MOBGAME_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ALONE_TSTUSR_IND    STRING,
   GAME_PLAYER_ACTV_USR_IND    STRING,
   GAME_PLAYER_ORDR_USR_IND    STRING,
   GAME_PLAYER_CANC_USR_IND    STRING,
   GAME_PLAYER_NEW_USR_IND    STRING,
   INDP_ACTV_USR_IND    STRING,
   PKG_NEW_USR_IND    STRING,
   PICWORD_NETWORK_USE_IND    STRING,
   CLI_ALONE_USE_IND    STRING,
   ACSS_PORTAL_USR_IND    STRING,
   PICWORD_USE_IND    STRING,
   MOBGAME_USE_IND    STRING,
   PKG_ORDR_USR_IND    STRING,
   PKG_CANC_USR_IND    STRING,
   NETWORK_INC    DECIMAL(14,2),
   PKG_INC    DECIMAL(14,2),
   PICWORD_INC    DECIMAL(14,2),
   ALONE_TST_INC    DECIMAL(14,2),
   GNA_INC    DECIMAL(14,2),
   PKG_GAME_PLAYER_INC    DECIMAL(14,2),
   PKG_INDP_INC    DECIMAL(14,2),
   TOT_INC    DECIMAL(14,2),
   NETWORK_LOGIN_CNT    INT,
   GNA_DOWNLOAD_CNT    INT,
   PKG_DOWNLOAD_CNT    INT,
   PKG_ORDR_CNT    INT,
   NETWORK_PAY_CNT    INT,
   GNA_PAY_CNT    INT,
   ORDR_USR_IND    STRING,
   ACTV_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_MOBGAME_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_COM139_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_COM139_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   STS_IND    STRING,
   WEB_NEW_REG_IND    STRING,
   WAP_NEW_REG_IND    STRING,
   MOB_NEW_REG_IND    STRING,
   OTHR_NEW_REG_IND    STRING,
   ACTV_IND    STRING,
   CONTACTV_M_CNT    INT,
   G3_PKG_CD    STRING,
   EFF_DT    INT,
   EFF_TM    STRING,
   INV_DT    INT,
   INV_TM    STRING,
   WEB_LOGIN_CNT    INT,
   WAP_LOGIN_CNT    INT,
   MOB_LOGIN_CNT    INT,
   OTHR_LOGIN_CNT    INT,
   WEB_WEIBO_RLSE_CNT    INT,
   WAP_WEIBO_RLSE_CNT    INT,
   MOB_WEIBO_RLSE_CNT    INT,
   OTHR_WEIBO_RLSE_CNT    INT,
   WEB_WEIBO_RPLY_CNT    INT,
   WAP_WEIBO_RPLY_CNT    INT,
   MOB_WEIBO_RPLY_CNT    INT,
   OTHR_WEIBO_RPLY_CNT    INT,
   WEB_WEIBO_FWD_CNT    INT,
   WAP_WEIBO_FWD_CNT    INT,
   MOB_WEIBO_FWD_CNT    INT,
   OTHR_WEIBO_FWD_CNT    INT,
   G3_CALL_FEE    DECIMAL(16,2),
   G3_CALL_PKG_FEE    DECIMAL(16,2),
   G3_CALL_DUR    INT,
   G3_DEBET_DUR    INT,
   G3_SMS_CNT    INT,
   G3_MMS_CNT    INT,
   DISK_UP_CNT    INT,
   DISK_DOWN_CNT    INT,
   DISK_SHARE_CNT    INT,
   DISK_RLSE_CNT    INT,
   ICNTC_UP_CNT    INT,
   ICNTC_DOWN_CNT    INT,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_COM139_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBPAY_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBPAY_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   MOBPAY_USR_IND    STRING,
   MOBBAG_USR_IND    STRING,
   CARD_USR_IND    STRING,
   MOBPAY_NEW_USR_IND    STRING,
   MOBBAG_NEW_USR_IND    STRING,
   CARD_NEW_USR_IND    STRING,
   MOBPAY_ACTV_USR_IND    STRING,
   MOBBAG_ACTV_USR_IND    STRING,
   CARD_ACTV_USR_IND    STRING,
   LOC_TRD_CNT    INT,
   LOC_TRD_AMT    DECIMAL(14,2),
   REMO_TRD_CNT    INT,
   REMO_TRD_AMT    DECIMAL(14,2),
   FWD_CNT    INT,
   FWD_AMT    DECIMAL(14,2),
   PROV_CASH_CNT    INT,
   PROV_CASH_AMT    DECIMAL(14,2),
   CASH_CHRG_CNT    INT,
   CASH_CHRG_AMT    DECIMAL(14,2),
   CARD_CHRG_CNT    INT,
   CARD_CHRG_AMT    DECIMAL(14,2),
   MOBBAG_CARD_CNSM_AMT    DECIMAL(14,2),
   MOBBAG_CARD_CHRG_CNT    INT,
   MOBBAG_CARD_CHRG_AMT    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBPAY_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_CR_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_CR_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   VALID_USR_IND    STRING,
   RECV_CHRG_USR_IND    STRING,
   PAY_USR_IND    STRING,
   CORPRING_USR_IND    STRING,
   CHNL_SRC    STRING,
   CR_ORDR_CNT    INT,
   CR_SET_CNT    INT,
   CHRG_CR_ORDR_CNT    INT,
   CR_ACTV_ORDR_CNT    INT,
   FUNC_FEE    DECIMAL(12,2),
   DIV_INF_FEE    DECIMAL(12,2),
   INF_FEE    DECIMAL(12,2),
   IVR_CHRG_CALL_DUR    BIGINT,
   IVR_FREE_CALL_DUR    BIGINT,
   IVR_CALL_FEE    DECIMAL(12,2),
   M12530_CMNCT_FEE    DECIMAL(10,2),
   SMS_NEW_USR_IND    STRING,
   IVR_NEW_USR_IND    STRING,
   WAP_NEW_USR_IND    STRING,
   WEBPORTAL_NEW_USR_IND    STRING,
   BOSS_NEW_USR_IND    STRING,
   CUSTSERV_NEW_USR_IND    STRING,
   OTH_NEW_USR_IND    STRING,
   SMS_CANC_USR_IND    STRING,
   IVR_CANC_USR_IND    STRING,
   WAP_CANC_USR_IND    STRING,
   WEBPORTAL_CANC_USR_IND    STRING,
   BOSS_CANC_USR_IND    STRING,
   CUSTSERV_CANC_USR_IND    STRING,
   OTH_CANC_USR_IND    STRING,
   BYCANC_USR_IND    STRING,
   ACTCANC_USR_IND    STRING,
   SMS_CHRG_IND    STRING,
   IVR_CHRG_IND    STRING,
   WAP_CHRG_IND    STRING,
   WEBPORTAL_CHRG_IND    STRING,
   BOSS_CHRG_IND    STRING,
   CUSTSERV_CHRG_IND    STRING,
   OTH_CHRG_IND    STRING,
   PKG_USR_IND    STRING,
   ORDR_USR_IND    STRING,
   IVR_CALL_DUR    INT,
   SMS_UP_CNT    INT,
   SMS_DOWN_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_CR_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   GPRS_ACTV_USR_IND    STRING,
   MOBREAD_ACTV_USR_IND    STRING,
   MOBGAME_ACTV_USR_IND    STRING,
   COM139_ACTV_USR_IND    STRING,
   MM_ACTV_USR_IND    STRING,
   FETION_ACTV_USR_IND    STRING,
   MAIL139_ACTV_USR_IND    STRING,
   MOBNEWS_ACTV_USR_IND    STRING,
   MOBPAY_ACTV_USR_IND    STRING,
   MOBFLASH_ACTV_USR_IND    STRING,
   FEILIAO_ACTV_USR_IND    STRING,
   MOB139_G3_ACT_USR_IND    STRING,
   WEATHER_IND    STRING,
   SMSHZ_IND    STRING,
   SECUR_IND    STRING,
   OPEN_139_IND    STRING,
   CALL_AWAKE_IND    STRING,
   NEWSFLASH_IND    STRING,
   MOBMAP_IND    STRING,
   CALL_DISP_IND    STRING,
   VOC_MBOX_IND    STRING,
   TELBK_12593_IND    STRING,
   CHSEC_IND    STRING,
   SMS_TAOCAN_IND    STRING,
   HLZX_IND    STRING,
   CITYHOME_IND    STRING,
   DX_TOLL_IND    STRING,
   COM139_ZJY_IND    STRING,
   TXZS_IND    STRING,
   MOBTV_IND    STRING,
   WEIBO_IND    STRING,
   COLORING_IND    STRING,
   USE_WLAN_IND    STRING,
   USE_12580_SRVC_IND    STRING,
   CLUB_HUSR_IND    STRING,
   CPRINT_USR_IND    STRING,
   AUTORPLY_USR_IND    STRING,
   AUTORPLY_NEW_IND    STRING,
   AUTORPLY_CANC_IND    STRING,
   WAKE_NEW_IND    STRING,
   WAKE_CANC_IND    STRING,
   SMSINCR_USR_IND    STRING,
   SMSINCR_NEW_IND    STRING,
   SMSINCR_CANC_IND    STRING,
   SMSHZ_ACTV_IND    STRING,
   SMSHZ_NEW_REG_IND    STRING,
   SMSHZ_CANC_IND    STRING,
   SMSHZ_SMS_CNT    INT,
   SMSHZ_INC_SMS_CNT    INT,
   SMS12580_USR_IND    STRING,
   MMS12580_USR_IND    STRING,
   CALL12580_INCOME    DECIMAL(12,2),
   INF12580_INCOME    DECIMAL(12,2),
   SMS12580_INCOME    DECIMAL(12,2),
   CALL12580_DEBET_DUR    INT,
   SMS12580_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_COM139_USE_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_COM139_USE_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   TERM_BRND    STRING,
   PKG_DTL_CD    INT,
   OPEN_FETION_IND    STRING,
   OPEN_CR_IND    STRING,
   OPEN_MOBNEWS_IND    STRING,
   OPEN_MAIL139_IND    STRING,
   CORP_MEMBER_IND    STRING,
   CORP_XY_IND    STRING,
   CURRMO_INNET_IND    STRING,
   INNET_DUR    INT,
   TOT_FEE    DECIMAL(14,2),
   CALL_CNT    INT,
   CALL_DUR    INT,
   ACTVCALL_DEBET_DUR    INT,
   BYCALL_DEBET_DUR    INT,
   GPRS_FEE    DECIMAL(14,2),
   CNTCT_CNT    INT,
   FETION_FRIEND_CNT    INT,
   FETION_LOGIN_CNT    INT,
   UP_MMS_CNT    INT,
   UP_SMS_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_COM139_USE_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBREAD_KPI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBREAD_KPI_M (
   USR_NBR    STRING,
   STRT_KPI_DT    INT,
   PRVC_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   BOOK_IND    STRING,
   WORD_IND    STRING,
   MO_IND    STRING,
   CM_BOOK_FEE    DECIMAL(8,2),
   CM_WORD_FEE    DECIMAL(8,2),
   CM_MO_FEE    DECIMAL(8,2),
   CM_USE_WAP_IND    STRING,
   CM_USE_CLI_IND    STRING,
   CM_USE_MOBREAD_IND    STRING,
   USE_WWW_IND    STRING,
   USE_MM_IND    STRING,
   PROD_PCK_IND    STRING,
   VOL_IND    STRING,
   B_GRNT_IND    STRING,
   PRD_PCK_FEE    DECIMAL(8,2),
   VOL_FEE    DECIMAL(8,2),
   ALL_FEE    DECIMAL(8,2),
   B_GRNT_FEE    DECIMAL(8,2),
   STAT_MO    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBREAD_KPI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBNGTN_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBNGTN_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   IS_PAY_MO    SMALLINT,
   IS_PAY_CNT    SMALLINT,
   IS_FREE    SMALLINT,
   IS_ORDER    SMALLINT,
   IS_CANC    SMALLINT,
   PAY_MO_CNT    INT,
   PAY_TIME_CNT    INT,
   FREE_USE_CNT    INT,
   MOB_MAVIGAT_USE_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBNGTN_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_SMS_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_SMS_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   LOC_INNER_P2PSMS_UP_CNT    INT,
   IPRVC_INNER_P2PSMS_UP_CNT    INT,
   OPRVC_INNER_P2PSMS_UP_CNT    INT,
   INNER_P2PSMS_UP_DEBET_CNT    INT,
   INNER_P2PSMS_UP_CNT    INT,
   DX_OUTER_P2PSMS_UP_DEBET_CNT    INT,
   DX_OUTER_P2PSMS_UP_CNT    INT,
   LT_OUTER_P2PSMS_UP_DEBET_CNT    INT,
   LT_OUTER_P2PSMS_UP_CNT    INT,
   OUTER_P2PSMS_UP_DEBET_CNT    INT,
   OUTER_P2PSMS_UP_CNT    INT,
   INTNTL_P2PSMS_UP_DEBET_CNT    INT,
   INTNTL_P2PSMS_UP_CNT    INT,
   P2PSMS_UP_CNT    INT,
   PKG_INNER_P2PSMS_CNT    INT,
   MWSMS_UP_CNT    INT,
   MWSMS_DOWN_CNT    INT,
   MWSMS_PER_CHRG_DOWN_CNT    INT,
   MWSMS_MON_CHRG_CDR_CNT    INT,
   LOC_INNER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   IPRVC_INNER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   OPRVC_INNER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   INNER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   DX_OUTER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   LT_OUTER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   OUTER_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   INTNTL_P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   P2PSMS_CMNCT_FEE    DECIMAL(12,2),
   MWSMS_UP_CMNCT_FEE    DECIMAL(12,2),
   MWSMS_MON_INF_FEE    DECIMAL(12,2),
   MWSMS_PER_INF_FEE    DECIMAL(12,2),
   MWSMS_DIV_INF_FEE    DECIMAL(12,2),
   MWSMS_GMCC_INCOME    DECIMAL(12,2),
   P2PSMS_PKG_FEE    DECIMAL(12,2),
   BRND_BIND_SMS_PKG_FEE    DECIMAL(12,2),
   SMS_PKG_FEE    DECIMAL(12,2),
   SMS_FEE    DECIMAL(12,2),
   SMS_USE_USR_IND    STRING,
   SMS_SPKG_ORD_USR_IND    STRING,
   BRND_BIND_SMS_PKG_USR_IND    STRING,
   SMS_PKG_NEW_IND    STRING,
   P2PSMS_UP_IND    STRING,
   PKG_INNER_P2PSMS_IND    STRING,
   OVER_PKG_P2PSMS_IND    STRING,
   SMS_PKG_CHRG_IND    STRING,
   SMS_INPKG_IND    STRING,
   LOC_INNER_P2PSMS_IND    STRING,
   IPRVC_INNER_P2PSMS_IND    STRING,
   OPRVC_INNER_P2PSMS_IND    STRING,
   INNER_P2PSMS_IND    STRING,
   DX_OUTER_P2PSMS_IND    STRING,
   LT_OUTER_P2PSMS_IND    STRING,
   OUTER_P2PSMS_IND    STRING,
   INTNTL_P2PSMS_IND    STRING,
   MWSMS_ORD_IND    STRING,
   MWSMS_UP_IND    STRING,
   MWSMS_DOWN_IND    STRING,
   MWSMS_PAY_IND    STRING,
   MWSMS_IND    STRING,
   P2PSMS_PKG_TYP_CD    SMALLINT,
   SMS_PKG_PRDCT_CD    STRING,
   SMS_PKG_TYP_CD    SMALLINT,
   INTNTL_ROAM_SMS_USR_IND    STRING,
   INTNTL_ROAM_SMS_CNT    INT,
   INTNTL_ROAM_SMS_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_SMS_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MMS_BUSI_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MMS_BUSI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   INNER_P2PMMS_UP_CNT    INT,
   OUTER_P2PMMS_UP_CNT    INT,
   INTNTL_P2PMMS_UP_CNT    INT,
   P2PMMS_UP_CNT    INT,
   INNER_P2PMMS_DOWN_CNT    INT,
   OUTER_P2PMMS_DOWN_CNT    INT,
   INTNTL_P2PMMS_DOWN_CNT    INT,
   P2PMMS_DOWN_CNT    INT,
   DEBET_P2PMMS_UP_CNT    INT,
   DEBET_P2PMMS_DOWN_CNT    INT,
   MAILMMS_UP_CNT    INT,
   MAILMMS_DOWN_CNT    INT,
   MWMMS_UP_CNT    INT,
   MWMMS_DOWN_CNT    INT,
   PKG_INNER_P2PMMS_CNT    INT,
   P2PMMS_PKG_FEE    DECIMAL(12,2),
   INNER_P2PMMS_CMNCT_FEE    DECIMAL(12,2),
   OUTER_P2PMMS_CMNCT_FEE    DECIMAL(12,2),
   INTNTL_P2PMMS_CMNCT_FEE    DECIMAL(12,2),
   P2PMMS_CMNCT_FEE    DECIMAL(12,2),
   MAILMMS_UP_CMNCT_FEE    DECIMAL(12,2),
   MAILMMS_DOWN_CMNCT_FEE    DECIMAL(12,2),
   MAILMMS_PKG_FEE    DECIMAL(12,2),
   MWMMS_PKG_FEE    DECIMAL(12,2),
   MWMMS_UP_CMNCT_FEE    DECIMAL(12,2),
   MWMMS_MON_INF_FEE    DECIMAL(12,2),
   MWMMS_PER_INF_FEE    DECIMAL(12,2),
   MWMMS_DIV_INF_FEE    DECIMAL(12,2),
   MWMMS_GMCC_INCOME    DECIMAL(12,2),
   MMS_FEE    DECIMAL(12,2),
   P2PMMS_PKG_ORD_IND    STRING,
   INNER_P2PMMS_UP_IND    STRING,
   OUTER_P2PMMS_UP_IND    STRING,
   INTNTL_P2PMMS_UP_IND    STRING,
   INNER_P2PMMS_DOWN_IND    STRING,
   OUTER_P2PMMS_DOWN_IND    STRING,
   INTNTL_P2PMMS_DOWN_IND    STRING,
   DEBET_P2PMMS_UP_IND    STRING,
   DEBET_P2PMMS_DOWN_IND    STRING,
   P2PMMS_UP_IND    STRING,
   P2PMMS_DOWN_IND    STRING,
   NEW_MMS_PKG_IND    STRING,
   MMS_PKG_DEBET_IND    STRING,
   MWMMS_UP_IND    STRING,
   MWMMS_DOWN_IND    STRING,
   MWMMS_ORD_IND    STRING,
   MWMMS_IND    STRING,
   MAILMMS_USE_IND    STRING,
   MAILMMS_IND    STRING,
   INTNTL_ROAM_MMS_USR_IND    STRING,
   INTNTL_ROAM_MMS_CNT    INT,
   INTNTL_ROAM_MMS_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MMS_BUSI_M';

DROP TABLE IF EXISTS JCFW.TW_NB_VOICEMAIL_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_VOICEMAIL_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   PN_ORDR_USR_IND    STRING,
   PZ_ORDR_USR_IND    STRING,
   PS_ORDR_USR_IND    STRING,
   PH_ORDR_USR_IND    STRING,
   PW_ORDR_USR_IND    STRING,
   PN_NEW_USR_IND    STRING,
   PZ_NEW_USR_IND    STRING,
   PS_NEW_USR_IND    STRING,
   PH_NEW_USR_IND    STRING,
   PW_NEW_USR_IND    STRING,
   PN_CANC_USR_IND    STRING,
   PZ_CANC_USR_IND    STRING,
   PS_CANC_USR_IND    STRING,
   PH_CANC_USR_IND    STRING,
   PW_CANC_USR_IND    STRING,
   VOICEMAIL_FEE    DECIMAL(16,2),
   ORDR_DT    INT,
   CANC_DT    INT,
   PAY_USR_IND    STRING,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_VOICEMAIL_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBFLASH_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBFLASH_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ORDR_USR_IND    STRING,
   FEE_USR_IND    STRING,
   INF_FEE    DECIMAL(14,2),
   DEMAND_ORDR_USR_IND    STRING,
   MONTHLY_ORDR_USR_IND    STRING,
   DEMAND_FEE_USR_IND    STRING,
   MONTHLY_FEE_USR_IND    STRING,
   DEMAND_FEE    DECIMAL(14,2),
   MONTHLY_FEE    DECIMAL(14,2),
   MAGA_N_ORDR_CNT    INT,
   MAGA_O_ORDR_CNT    INT,
   MAGA_E_ORDR_CNT    INT,
   MAGE_E_ORDR_USR_IND    STRING,
   MAGE_FEE_USR_IND    STRING,
   MAGA_FEE    DECIMAL(14,2),
   MONTHLY_N_ORDR_CNT    INT,
   MONTHLY_O_ORDR_CNT    INT,
   MONTHLY_E_ORDR_CNT    INT,
   DEMAND_FEE_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBFLASH_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_MOBVEDIO_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_MOBVEDIO_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MOBVEDIO_USR_IND    STRING,
   MOBVEDIO_FEE_IND    STRING,
   INF_FEE    DECIMAL(14,2),
   FREE_ORDR_USR_IND    STRING,
   DEMAND_ORDR_USR_IND    STRING,
   MONTHLY_ORDR_USR_IND    STRING,
   DEMAND_FEE_USR_IND    STRING,
   MONTHLY_FEE_USR_IND    STRING,
   DEMAND_FEE    DECIMAL(14,2),
   MONTHLY_FEE    DECIMAL(14,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_MOBVEDIO_USR_M';

DROP TABLE IF EXISTS JCFW.TW_TERM_CHG_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_TERM_CHG_USR_M (
   STAT_MO    INT,
   STAT_CHG_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   USR_TYP    INT,
   CHNL_TYP    STRING,
   SELL_KIND    STRING,
   PLAT_CD    STRING,
   TRML_PRDCT_ID    STRING,
   TERM_CHG_TYP    INT,
   PROV_VOCCALL_USR_IND    STRING,
   ACTVCALL_DUR    INT,
   BYCALL_DUR    INT,
   ACTV_CALL_CNT    INT,
   BYCALL_CNT    INT,
   ACTCALL_DAYS    INT,
   INNET_USR_IND    STRING,
   TD_TERM_IND    STRING,
   SMTPHN_IND    STRING,
   WLAN_FUNC_IND    STRING,
   WLAN_FLUX    BIGINT,
   WLAN_MOB_FLUX    BIGINT,
   WLAN_MOB_DUR    BIGINT,
   BFR_CHG_WLAN_FLUX    BIGINT,
   GPRS_NTD_FLUX    BIGINT,
   GPRS_TD_FLUX    BIGINT,
   GPRS_TDLTE_FLUX    BIGINT,
   GPRS_FEE    DECIMAL(12,2),
   BFR_CHG_NTD_FLUX    BIGINT,
   BFR_CHG_TD_FLUX    BIGINT,
   BFR_CHG_TDLTE_FLUX    BIGINT,
   BFR_CHG_GPRS_FEE    DECIMAL(12,2),
   BZERO_GPRS_FLUX_IND    STRING,
   ZERO_GPRS_FLUX_IND    STRING,
   GPRS_FLUX_USR_TYP    INT,
   GPRS_FEE_USR_TYP    INT,
   ACT_CALL_IND    STRING,
   ARPU    DECIMAL(12,2),
   CORE_VAL    DECIMAL(12,2),
   GPRS_SPKG_TYP_CD    INT,
   GPRS_SPKG_FLUX    INT,
   GPRS_BPKG_TYP_CD    INT,
   GPRS_BPKG_FLUX    INT,
   IMEI_CHG_IND    STRING,
   IMEI    STRING,
   TAC    STRING,
   LAST_IMEI    STRING,
   LAST_TAC    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_TERM_CHG_USR_M';

DROP TABLE IF EXISTS JCFW.TW_NB_DOUBT_TDNET_LOCK_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_DOUBT_TDNET_LOCK_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   DOUBT_TDNET_LOCK_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_DOUBT_TDNET_LOCK_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CUST_BILL_ORIG_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CUST_BILL_ORIG_M (
   EBOX_ID    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   BILL_ACCT_CD    STRING,
   BILL_CYC_CD    INT,
   BILL_TYP    SMALLINT,
   EBOX_BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   REC_FEE    DECIMAL(16,2),
   ACT_FEE    DECIMAL(16,2),
   BILL_STS_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CUST_BILL_ORIG_M';

DROP TABLE IF EXISTS JCFW.TW_GMCC_CMPT_VEST_JSSC_M;
CREATE EXTERNAL TABLE JCFW.TW_GMCC_CMPT_VEST_JSSC_M (
   STAT_MO    INT,
   CMPT_USR_NBR    STRING,
   VEST_TYP_CD    STRING,
   VEST_LVL1_CD    STRING,
   VEST_LVL2_CD    STRING,
   VEST_LVL3_CD    STRING,
   VEST_LVL4_CD    STRING,
   VEST_LVL5_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_GMCC_CMPT_VEST_JSSC_M';

DROP TABLE IF EXISTS JCFW.TW_GMCC_USR_VEST_JSSC_M;
CREATE EXTERNAL TABLE JCFW.TW_GMCC_USR_VEST_JSSC_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   VEST_TYP_CD    STRING,
   VEST_LVL1_CD    STRING,
   VEST_LVL2_CD    STRING,
   VEST_LVL3_CD    STRING,
   VEST_LVL4_CD    STRING,
   VEST_LVL5_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_GMCC_USR_VEST_JSSC_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_USR_BRND_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_USR_BRND_M (
   USR_NBR    STRING,
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   PRDCT_CD    SMALLINT,
   START_DT    INT,
   END_DT    INT,
   GBRND_IND    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_USR_BRND_M';

DROP TABLE IF EXISTS JCFW.TW_CMPT_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_CMPT_USR_M (
   CMPT_NBR    STRING,
   AREA_CD    STRING,
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   CMPT_OPER_CD    STRING,
   CMPT_BRND_CD    SMALLINT,
   PKG_CD    SMALLINT,
   USR_STS_CD    STRING,
   CM_NEW_USR_IND    STRING,
   CM_ACT_CMNCT_USR_IND    STRING,
   CM_ACTV_DAYS    INT,
   INNET_MO_CNT    INT,
   FST_CALL_DT    INT,
   FST_CALL_TIM    STRING,
   LAST_CALL_DT    INT,
   INNET_DT    INT,
   OUTNET_DT    INT,
   CM_OUTNET_USR_IND    STRING,
   FST_LOCAL_CD    STRING,
   FST_CELL_CD    STRING,
   FST_DEBET1_FEE    DECIMAL(10,2),
   FST_DEBET2_FEE    DECIMAL(10,2),
   FST_CALL_DUR    INT,
   ACTVCALL_DUR    INT,
   ACTVCALL_CNT    INT,
   BYCALL_DUR    INT,
   BYCALL_CNT    INT,
   FWD_BYCALL_DUR    INT,
   FWD_BYCALL_CNT    INT,
   SMS_UP_CNT    INT,
   SMS_DOWN_CNT    INT,
   COOPR_CMCC_BRANCH_CD    STRING,
   DIST_D_LOCAL_CD    STRING,
   DIST_D_CELL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CMPT_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CUST_BAL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CUST_BAL_M (
   STAT_MO    INT,
   CUST_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   IN_CASH_AMT    DECIMAL(16,2),
   IN_RESERVE_AMT    DECIMAL(16,2),
   IN_CARD_AMT    DECIMAL(16,2),
   IN_DISCOUNT_AMT    DECIMAL(16,2),
   IN_REDUCE_AMT    DECIMAL(16,2),
   IN_ASSURE_AMT    DECIMAL(16,2),
   IN_PRESENT_AMT    DECIMAL(16,2),
   IN_OTH_AMT    DECIMAL(16,2),
   CASH_AMT    DECIMAL(16,2),
   RESERVE_AMT    DECIMAL(16,2),
   CARD_AMT    DECIMAL(16,2),
   DISCOUNT_AMT    DECIMAL(16,2),
   REDUCE_AMT    DECIMAL(16,2),
   ASSURE_AMT    DECIMAL(16,2),
   PRESENT_AMT    DECIMAL(16,2),
   OTH_AMT    DECIMAL(16,2),
   ACCOUNT_AMT    DECIMAL(16,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CUST_BAL_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_CMNCT_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_CMNCT_USR_M (
   USR_MOB_NBR    STRING,
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   MUM_3MON_IND    STRING,
   FIRST_CALL_DT    INT,
   LAST_CALL_DT    INT,
   FIRST_LOCAL_CD    STRING,
   FIRST_CELL_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_CMNCT_USR_M';

DROP TABLE IF EXISTS JCFW.TW_USR_INTRCRS_MO;
CREATE EXTERNAL TABLE JCFW.TW_USR_INTRCRS_MO (
   TM_INTRVL_CD    INT,
   USR_NBR    STRING,
   B_NBR    STRING,
   B_AREA_CD    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   ACTVCALL_CNT    INT,
   BYCALL_CNT    INT,
   ACTVCALL_FEE    DECIMAL(10,2),
   BYCALL_FEE    DECIMAL(10,2),
   ACTVCALL_DUR    INT,
   ACTVCALL_DEBET_DUR    INT,
   BYCALL_DUR    INT,
   BYCALL_DEBET_DUR    INT,
   ROAM_ACTVCALL_CNT    INT,
   ROAM_BYCALL_CNT    INT,
   ROAM_ACTVCALL_DUR    INT,
   ROAM_ACTVCALL_DEBET_DUR    INT,
   ROAM_BYCALL_DUR    INT,
   ROAM_BYCALL_DEBET_DUR    INT,
   B_BRND_CD    SMALLINT,
   SMS_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_USR_INTRCRS_MO';

DROP TABLE IF EXISTS JCFW.TW_PERS_3G_TYJUSR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_3G_TYJUSR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   IMEI    STRING,
   TD_TYP_CD    SMALLINT,
   BRND_CD    SMALLINT,
   TD_NB_IND    SMALLINT,
   CHNL_CD    STRING,
   IMEI_CALL_CNT    INT,
   TD_NB_GPRS_FLUX    BIGINT,
   TD_NB_IMEI    STRING,
   TD_LXACTV_IND    SMALLINT,
   TD_ACTACTV_IND    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_3G_TYJUSR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_INTEGRAL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_INTEGRAL_M (
   STAT_MO    INT,
   CUST_ID    STRING,
   USR_ID    STRING,
   INTEGRAL_CYC_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   USR_INTEGRAL_AMT    INT,
   USR_HAVE_CHG_INTEGRAL    INT,
   USR_CAN_CHG_INTEGRAL    INT,
   DUTY_DERATE_INTEGRAL    INT,
   AUCTION_INTEGRAL    INT,
   CONSUME_INTEGRAL    INT,
   PRMT_INTEGRAL    INT,
   INNET_INTEGRAL    INT,
   CREDIT_INTEGRAL    INT,
   AWARD_INTEGRAL    INT,
   XST_CONSUME_INTEGRAL    INT,
   XST_PRMT_INTEGRAL    INT,
   CONSUME_INTEGRAL_AMT    INT,
   INNET_INTEGRAL_AMT    INT,
   CREDIT_INTEGRAL_AMT    INT,
   AWARD_INTEGRAL_AMT    INT,
   LOAD_ID    INT,
   DATA_BUSI_INTEGRAL    INT,
   DATA_BUSI_INTEGRAL_AMT    INT,
   AVAIL_INTEGRAL_AMT    INT,
   MOVE_INTEGRAL_AMT    INT,
   USR_ID_BORN    STRING,
   PKG_CD    SMALLINT,
   TERM_CAN_CHG_INTEGRAL    INT,
   ACCUM_USR_INTEGRAL_AMT    INT,
   BRND_CD    SMALLINT,
   CLEAR_INTEGRAL    INT,
   CURRY_HAVECHG_INTEGRAL    INT,
   T_CAN_CHG_INTEGRAL    INT,
   T1_CAN_CHG_INTEGRAL    INT,
   T2_CAN_CHG_INTEGRAL    INT,
   HIS_CAN_CHG_INTEGRAL    INT,
   END_CLEAR_INTEGRAL    INT,
   OUTNET_CLEAR_INTEGRAL    INT,
   CONSUME_OUTCLEAR_INTEGRAL    INT,
   PRMT_OUTCLEAR_INTEGRAL    INT,
   CHGNET_CLEAR_INTEGRAL    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_INTEGRAL_M';

DROP TABLE IF EXISTS JCFW.TW_NB_CNTN_GPRS_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_NB_CNTN_GPRS_USR_M (
   STAT_MO    INT,
   IMSI    STRING,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   GPRS_CNTN_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NB_CNTN_GPRS_USR_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_IOT_MBR_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_IOT_MBR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   USR_BASS_PRDCT_CD    STRING,
   IOT_ATR_IND    STRING,
   IOT_TYP_CD    STRING,
   EFF_DT    INT,
   GROUP_ID    STRING,
   GUSR_ID    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   CORP_PRDCT_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   MBR_IND    STRING,
   SN_USR_IND    STRING,
   DL100_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_IOT_MBR_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_ZBFZ_LIST_MO;
CREATE EXTERNAL TABLE JCFW.TW_CORP_ZBFZ_LIST_MO (
   TM_INTRVL_CD    INT,
   GROUP_ID    STRING,
   GROUP_NO    STRING,
   PAR_GROUP_NO    STRING,
   GROUP_NAME    STRING,
   PROVINCEGROUP_IND    STRING,
   GROUP_SK_ATTR    STRING,
   CUST_A_MGR    STRING,
   CUST_B_MGR    STRING,
   CUST_ADR    STRING,
   CUST_POSTCODE    STRING,
   CUST_FAX    STRING,
   CUST_WEBSITE    STRING,
   VOCATION_TYP1_CD    STRING,
   CUST_GROUPTYPE    STRING,
   CUST_EMP_NBR    INT,
   CUST_RGST_FUND    DECIMAL(16,2),
   CUST_WORKAREA    STRING,
   OFFIC_NAME    STRING,
   NET_SRV_GRD    STRING,
   HQ_IND    STRING,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_ZBFZ_LIST_MO';

DROP TABLE IF EXISTS JCFW.TW_PERS_FAMHOME_LOST_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_FAMHOME_LOST_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   INVALID_DT    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   SHORT_NBR    STRING,
   EFF_DT    INT,
   BASS_PRDCT_CD    STRING,
   MAIN_NBR    STRING,
   MAIN_CMCC_BRANCH_CD    STRING,
   MAIN_BRND_CD    SMALLINT,
   MAIN_SHORT_NBR    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_FAMHOME_LOST_USR_M';

DROP TABLE IF EXISTS JCFW.TW_12580_CALL_FEE_MO;
CREATE EXTERNAL TABLE JCFW.TW_12580_CALL_FEE_MO (
   TM_INTRVL_CD    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   INNET_USR_IND    INT,
   CALL_FEE1    DECIMAL(12,2),
   CALL_FEE2    DECIMAL(12,2),
   CALL_FEE3    DECIMAL(12,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_12580_CALL_FEE_MO';

DROP TABLE IF EXISTS JCFW.TW_REDU_ACCT_MNTR_MO;
CREATE EXTERNAL TABLE JCFW.TW_REDU_ACCT_MNTR_MO (
   TM_INTRVL_CD    INT,
   CMCC_BRANCH_CD    STRING,
   USR_NBR    STRING,
   ILGL_IND    SMALLINT,
   REDU_AMT    DECIMAL(12,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_REDU_ACCT_MNTR_MO';

DROP TABLE IF EXISTS JCFW.TW_IPHONE_USRCALL_MO;
CREATE EXTERNAL TABLE JCFW.TW_IPHONE_USRCALL_MO (
   TM_INTRVL_CD    INT,
   CNCT_NBR    STRING,
   A_USR_NBR    STRING,
   DIR_TYP_CD    STRING,
   ROAM_TYP_CD    SMALLINT,
   TOLL_TYP_CD    SMALLINT,
   SRV_TYP_CD    STRING,
   SUBSRV_TYP_CD    STRING,
   BILL_TYP_CD    STRING,
   B_USR_NBR    STRING,
   B_AREA_CD    STRING,
   B_BRND_CD    SMALLINT,
   B_OPER_CD    STRING,
   CALL_AREA_CD    STRING,
   LM_USE_IND    STRING,
   BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   CALL_CNT    INT,
   CALL_DUR    INT,
   CALL_FLUX    BIGINT,
   DEBET_MOB_DUR    INT,
   DEBET_TOLL_DUR    INT,
   MOB_FEE    DECIMAL(10,2),
   TOLL_FEE    DECIMAL(10,2),
   INF_FEE    DECIMAL(10,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_IPHONE_USRCALL_MO';

DROP TABLE IF EXISTS JCFW.TW_PERS_DIR_TOLL_DEL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_DIR_TOLL_DEL_M (
   USR_NBR    STRING,
   PRVC_NAM    STRING,
   B_AREA_CD    STRING,
   CTY_NAM    STRING,
   B_USR_CNT    INT,
   LOC_ACT_CALL_CNT    INT,
   LOC_BY_CALL_CNT    INT,
   LOC_ACT_CALL_DUR    INT,
   LOC_BY_CALL_DUR    INT,
   LOC_ACT_FEE    DECIMAL(12,2),
   LOC_BY_FEE    DECIMAL(12,2)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_DIR_TOLL_DEL_M';

DROP TABLE IF EXISTS JCFW.TW_TERMPAY_PROV_ACTVCALL_M;
CREATE EXTERNAL TABLE JCFW.TW_TERMPAY_PROV_ACTVCALL_M (
   STAT_DT    INT,
   IMEI    STRING,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   B_NBR    STRING,
   B_AREA_CD    STRING,
   LOCAL_CD    STRING,
   CELL_CD    STRING,
   CALL_AREA_CD    STRING,
   CALL_CNT    INT,
   SMS_UP_CNT    INT,
   MMS_UP_CNT    INT,
   GPRS_FLUX    BIGINT,
   WLAN_FLUX    BIGINT,
   UP_GPRS_CALL_CNT    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_TERMPAY_PROV_ACTVCALL_M';

DROP TABLE IF EXISTS JCFW.TW_TERM_SELL_MO;
CREATE EXTERNAL TABLE JCFW.TW_TERM_SELL_MO (
   TM_INTRVL_CD    INT,
   SELL_IMEI    STRING,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   SELL_DT    INT,
   CHNL_CD    STRING,
   BRND_CD    SMALLINT,
   WORKF_ID    STRING,
   CHNL_CLASS_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_TERM_SELL_MO';

DROP TABLE IF EXISTS JCFW.TW_IMEI_USRCALL_MO;
CREATE EXTERNAL TABLE JCFW.TW_IMEI_USRCALL_MO (
   TM_INTRVL_CD    INT,
   USR_NBR    STRING,
   IMEI    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   VOCCALL_CNT    INT,
   VOCCALL_DUR    INT,
   DEBET_DUR    INT,
   GPRS_FLUX    BIGINT,
   TOT_FEE    DECIMAL(10,2),
   NET2G_VOCCALL_CNT    INT,
   NET2G_VOCCALL_DUR    INT,
   NET2G_DEBET_DUR    INT,
   NET2G_GPRS_FLUX    BIGINT,
   NET2G_TOT_FEE    DECIMAL(10,2),
   NET3G_VOCCALL_CNT    INT,
   NET3G_DEBET_DUR    INT,
   NET3G_VOCCALL_DUR    INT,
   NET3G_GPRS_FLUX    BIGINT,
   NET3G_TOT_FEE    DECIMAL(10,2),
   NET4G_VOCCALL_CNT    INT,
   NET4G_DEBET_DUR    INT,
   NET4G_VOCCALL_DUR    INT,
   NET4G_GPRS_FLUX    BIGINT,
   NET4G_TOT_FEE    DECIMAL(10,2),
   PROV_VOCCALL_CNT    INT,
   PROV_VOCDEBET_DUR    INT,
   ACTCALL_DAYS    INT,
   T_GPRS_CALLCNT    INT,
   G_GPRS_CALLCNT    INT,
   TDLTE_GPRS_CALLCNT    INT,
   PROV_GPRS_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_IMEI_USRCALL_MO';

DROP TABLE IF EXISTS JCFW.TW_PRDCT_FREE_RES_M;
CREATE EXTERNAL TABLE JCFW.TW_PRDCT_FREE_RES_M (
   STAT_DT    INT,
   USR_NBR    STRING,
   BASS_PRDCT_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   PKG_VALUE    DECIMAL(20,2),
   PKG_LEFT_VALUE    DECIMAL(20,2),
   PKG_ROLLOVER_VALUE    DECIMAL(20,2),
   RESOURCE_TYPE    SMALLINT,
   USR_FREE_TYP_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PRDCT_FREE_RES_M';

DROP TABLE IF EXISTS JCFW.TW_NET_CONT_PARSE_M;
CREATE EXTERNAL TABLE JCFW.TW_NET_CONT_PARSE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   PARSE_1    STRING,
   PARSE_2    STRING,
   PARSE_3    STRING,
   CONT_CATE_LV1    STRING,
   CONT_CATE_LV2    STRING,
   CONT_CATE_LV3    STRING,
   CONT_CATE_LV4    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NET_CONT_PARSE_M';

DROP TABLE IF EXISTS JCFW.TW_NET_KEYWD_M;
CREATE EXTERNAL TABLE JCFW.TW_NET_KEYWD_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   KEYWD    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NET_KEYWD_M';

DROP TABLE IF EXISTS JCFW.TW_NET_SITE_M;
CREATE EXTERNAL TABLE JCFW.TW_NET_SITE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   SITE_TYP_ID    INT,
   SITE_TYP_NAM    STRING,
   SITE_ID    INT,
   SITE_NAM    STRING,
   SITE_CATEGO_ID    INT,
   SITE_CATEGO_NAM    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NET_SITE_M';

DROP TABLE IF EXISTS JCFW.TW_NET_SR_M;
CREATE EXTERNAL TABLE JCFW.TW_NET_SR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   SR_ENTER_ID    INT,
   SR_ENTER_NAM    STRING,
   SR_SERVER_ID    INT,
   SR_SERVER_NAM    STRING,
   SR_SOURCE_ID    INT,
   SR_SOURCE_NAM    STRING,
   SR_CONT_TYP_ID    INT,
   SR_CONT_TYP_NAM    STRING,
   SR_SP_ID    INT,
   SR_SP_NAM    STRING,
   SR_IS_FREE_BUS    STRING,
   SR_ACTION_ID    INT,
   SR_ACTION_NAM    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NET_SR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_USR_LACI_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_USR_LACI_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   TOP1_INDATE    INT,
   TOP1_LACI_NAME    STRING,
   TOP1_LACI    STRING,
   TOP1_TYPE    STRING,
   TOP2_INDATE    INT,
   TOP2_LACI_NAME    STRING,
   TOP2_LACI    STRING,
   TOP2_TYPE    STRING,
   TOP3_INDATE    INT,
   TOP3_LACI_NAME    STRING,
   TOP3_LACI    STRING,
   TOP3_TYPE    STRING,
   WK_CELL_CD    STRING,
   WK_CELL_NAM    STRING,
   WK_P_LATITUDE    STRING,
   WK_P_LONGITUDE    STRING,
   RST_CELL_CD    STRING,
   RST_CELL_NAM    STRING,
   RST_P_LATITUDE    STRING,
   RST_P_LONGITUDE    STRING,
   RST_TOP1_LACI    STRING,
   RST_TOP2_LACI    STRING,
   RST_TOP3_LACI    STRING,
   IMSI    STRING,
   STAY_LOCAL_CITY    STRING,
   STAY_LAC_ID    STRING,
   STAY_CELL_ID    STRING,
   STAY_DAYS    INT,
   WORK_LOCAL_CITY    STRING,
   WORK_LAC_ID    STRING,
   WORK_CELL_ID    STRING,
   WORK_DAYS    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_USR_LACI_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_COMMON_APP_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_COMMON_APP_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   APP_WX_USR_IND    INT,
   APP_WX_FLUX    INT,
   APP_WX_CALL_CNT    INT,
   APP_QQ_USR_IND    INT,
   APP_QQ_FLUX    INT,
   APP_QQ_CALL_CNT    INT,
   APP_JD_USR_IND    INT,
   APP_JD_FLUX    INT,
   APP_JD_CALL_CNT    INT,
   APP_TB_USR_IND    INT,
   APP_TB_FLUX    INT,
   APP_TB_CALL_CNT    INT,
   APP_ALIPAY_USR_IND    INT,
   APP_ALIPAY_FLUX    INT,
   APP_ALIPAY_CALL_CNT    INT,
   APP_BAIDUMAP_USR_IND    INT,
   APP_BAIDUMAP_FLUX    INT,
   APP_BAIDUMAP_CALL_CNT    INT,
   APP_DP_USR_IND    INT,
   APP_DP_FLUX    INT,
   APP_DP_CALL_CNT    INT,
   APP_MT_USR_IND    INT,
   APP_MT_FLUX    INT,
   APP_MT_CALL_CNT    INT,
   APP_WEIBO_USR_IND    INT,
   APP_WEIBO_FLUX    INT,
   APP_WEIBO_CALL_CNT    INT,
   APP_UC_USR_IND    INT,
   APP_UC_FLUX    INT,
   APP_UC_CALL_CNT    INT,
   APP_YK_USR_IND    INT,
   APP_YK_FLUX    INT,
   APP_YK_CALL_CNT    INT,
   APP_KG_USR_IND    INT,
   APP_KG_FLUX    INT,
   APP_KG_CALL_CNT    INT,
   COM_DAT_APP_CNT    INT,
   WIFI_MASTER_KEY_CNT    INT,
   ELEC_SHOP_APP_CNT    INT,
   MAIL_APP_CNT    INT,
   SHARE_APP_CNT    INT,
   VIDEO_APP_CNT    INT,
   MUSIC_APP_CNT    INT,
   GAME_APP_CNT    INT,
   READ_APP_CNT    INT,
   IM_APP_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_COMMON_APP_M';

DROP TABLE IF EXISTS JCFW.TW_NET_CONT_CATE_M;
CREATE EXTERNAL TABLE JCFW.TW_NET_CONT_CATE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   NET_TYP_CD    INT,
   CONT_CATE_LV1    STRING,
   CONT_CATE_LV2    STRING,
   CONT_CATE_LV3    STRING,
   CONT_CATE_LV4    STRING,
   UP_FLUX    BIGINT,
   DOWN_FLUX    BIGINT,
   CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_NET_CONT_CATE_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_ONOFF_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_ONOFF_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   ON_CNT    INT,
   OFF_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_ONOFF_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_COMMON_WEBSITE_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_COMMON_WEBSITE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   BAIDU_USR_IND    INT,
   BAIDU_FLUX    INT,
   BAIDU_CALL_CNT    INT,
   QQ_USR_IND    INT,
   QQ_FLUX    INT,
   QQ_CALL_CNT    INT,
   SOGOU_USR_IND    INT,
   SOGOU_FLUX    INT,
   SOGOU_CALL_CNT    INT,
   A360_USR_IND    INT,
   A360_FLUX    INT,
   A360_CALL_CNT    INT,
   SOHU_USR_IND    INT,
   SOHU_FLUX    INT,
   SOHU_CALL_CNT    INT,
   SINA_USR_IND    INT,
   SINA_FLUX    INT,
   SINA_CALL_CNT    INT,
   GTIMG_USR_IND    INT,
   GTIMG_FLUX    INT,
   GTIMG_CALL_CNT    INT,
   JD_USR_IND    INT,
   JD_FLUX    INT,
   JD_CALL_CNT    INT,
   ALIPAY_USR_IND    INT,
   ALIPAY_FLUX    INT,
   ALIPAY_CALL_CNT    INT,
   MYBU_USR_IND    INT,
   MYBU_FLUX    INT,
   MYBU_CALL_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='UTF-8')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_COMMON_WEBSITE_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_VOLTE_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_VOLTE_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   VOLTE_IMEI    STRING,
   VOLTE_TAC    STRING,
   VOLTE_TERM_BRND_NAM    STRING,
   VOLTE_TERM_DEVICE_NAM    STRING,
   VOLTE_1ACT_CALL_USR_IND    STRING,
   VOLTE_2ACT_CALL_USR_IND    STRING,
   VOLTE_1CALL_USR_IND    STRING,
   VOLTE_2CALL_USR_IND    STRING,
   OPEN_VOLTE_FUNC_IND    STRING,
   VOLTE_DEBET_DUR    BIGINT,
   VOLTE_ACT_DEBET_DUR    BIGINT,
   VOLTE_VID_DEBET_DUR    BIGINT,
   VOLTE_ACT_VID_DEBET_DUR    BIGINT,
   VOLTE_1ACT_NEW_USR_IND    STRING,
   N_OPEN_VOLTE_FUNC_IND    STRING,
   VOLTE_BY_DEBET_DUR    BIGINT,
   VOLTE_BY_VID_DEBET_DUR    BIGINT,
   N_VOLTE_ACT_USR_IND    STRING,
   N_VOLTE_ACT_VID_USR_IND    STRING,
   VOLTE_1ACTV_USR_IND    STRING,
   N_VOLTE_1ACTV_USR_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_VOLTE_USR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_BILL_HVOUT_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_BILL_HVOUT_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_BILL_HVOUT_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_USR_ATTR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_USR_ATTR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   NBR_TYP_CD    STRING,
   INNET_CHNL_CD    STRING,
   N_PKG_DTL_FEE_AMT    DECIMAL(16,2),
   N_V_TYP_NAM_1    STRING,
   N_BASS_PRDCT_TOTAL_FLUX    BIGINT,
   ORDER_PKG_DTL_FEE_AMT    DECIMAL(16,2),
   ORDER_V_TYP_NAM_1    STRING,
   ORDER_BASS_PRDCT_TOTAL_FLUX    BIGINT,
   SPLAN_LVL    STRING,
   PLUXPKG_CNT    INT,
   PLUXPKG_10_CNT    INT,
   PLUXPKG_20_CNT    INT,
   PLUXPKG_30_CNT    INT,
   PLUXPKG_50_CNT    INT,
   PLUXPKG_70_CNT    INT,
   PLUXPKG_100_CNT    INT,
   PLUXPKG_180_CNT    INT,
   GPRS_PLUXPKG_FEE    DECIMAL(16,2),
   OPEN_GPRS_IND    STRING,
   AVAIL_INTEGRAL_AMT    INT,
   NEW_INTEGRAL_AMT    INT,
   NEW_PSALE_INTEGRAL_AMT    INT,
   DEDUC_INTEGRAL_AMT    INT,
   CHRG_CNT    INT,
   CHRG_AMT    DECIMAL(16,2),
   MOST_TRADE_TYP    SMALLINT,
   USR_CMNCT_TYP_CD    STRING,
   USR_NET_TYP_CD    STRING,
   RLIST_IND    STRING,
   YK_USR_IND    STRING,
   BACK_USR_IND    STRING,
   CHA_INTEGRAL_IND    STRING,
   SIM_CARD_FLAG    STRING,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_USR_ATTR_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_VOC_BUSI_DTL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_VOC_BUSI_DTL_M (
   USR_NBR    STRING,
   STAT_MO    INT,
   LMO_MOB_FEE    DECIMAL(10,2),
   LMO_TOLL_FEE    DECIMAL(10,2),
   LOO_MOB_FEE    DECIMAL(10,2),
   LOO_TOLL_FEE    DECIMAL(10,2),
   LMT_FEE    DECIMAL(10,2),
   LOT_FEE    DECIMAL(10,2),
   PMO_MOB_FEE    DECIMAL(10,2),
   PMO_TOLL_FEE    DECIMAL(10,2),
   POO_MOB_FEE    DECIMAL(10,2),
   POO_TOLL_FEE    DECIMAL(10,2),
   PMT_MOB_FEE    DECIMAL(10,2),
   PMT_TOLL_FEE    DECIMAL(10,2),
   POT_MOB_FEE    DECIMAL(10,2),
   POT_TOLL_FEE    DECIMAL(10,2),
   GMO_MOB_FEE    DECIMAL(10,2),
   GMO_TOLL_FEE    DECIMAL(10,2),
   GOO_MOB_FEE    DECIMAL(10,2),
   GOO_TOLL_FEE    DECIMAL(10,2),
   GMT_MOB_FEE    DECIMAL(10,2),
   GMT_TOLL_FEE    DECIMAL(10,2),
   GOT_MOB_FEE    DECIMAL(10,2),
   GOT_TOLL_FEE    DECIMAL(10,2),
   HAA_FEE    DECIMAL(10,2),
   MAA_FEE    DECIMAL(10,2),
   TAA_FEE    DECIMAL(10,2),
   UAA_FEE    DECIMAL(10,2),
   IAA_FEE    DECIMAL(10,2),
   M17951_CG_MOB_FEE    DECIMAL(10,2),
   M17951_CG_TOLL_FEE    DECIMAL(10,2),
   M12593_CG_MOB_FEE    DECIMAL(10,2),
   M12593_CG_TOLL_FEE    DECIMAL(10,2),
   TIP_CG_MOB_FEE    DECIMAL(10,2),
   TIP_CG_TOLL_FEE    DECIMAL(10,2),
   UIP_CG_MOB_FEE    DECIMAL(10,2),
   UIP_CG_TOLL_FEE    DECIMAL(10,2),
   OIP_CG_MOB_FEE    DECIMAL(10,2),
   OIP_CG_TOLL_FEE    DECIMAL(10,2),
   M17951_CI_MOB_FEE    DECIMAL(10,2),
   M17951_CI_TOLL_FEE    DECIMAL(10,2),
   M12593_CI_MOBFEE    DECIMAL(10,2),
   M12593_CI_TOLL_FEE    DECIMAL(10,2),
   TIP_CI_MOB_FEE    DECIMAL(10,2),
   TIP_CI_TOLL_FEE    DECIMAL(10,2),
   UIP_CI_MOB_FEE    DECIMAL(10,2),
   UIP_CI_TOLL_FEE    DECIMAL(10,2),
   OIP_CI_MOB_FEE    DECIMAL(10,2),
   OIP_CI_TOLL_FEE    DECIMAL(10,2),
   PDD_MOB_FEE    DECIMAL(10,2),
   PDD_TOLL_FEE    DECIMAL(10,2),
   DDD_MOB_FEE    DECIMAL(10,2),
   DDD_TOLL_FEE    DECIMAL(10,2),
   IDD_MOB_FEE    DECIMAL(10,2),
   IDD_TOLL_FEE    DECIMAL(10,2),
   LVO_MOB_FEE    DECIMAL(10,2),
   LVO_TOLL_FEE    DECIMAL(10,2),
   LVT_FEE    DECIMAL(10,2),
   PVO_MOB_FEE    DECIMAL(10,2),
   PVO_TOLL_FEE    DECIMAL(10,2),
   PVT_MOB_FEE    DECIMAL(10,2),
   PVT_TOLL_FEE    DECIMAL(10,2),
   LMO_MOB_DUR    INT,
   LMO_TOLL_DUR    INT,
   LOO_MOB_DUR    INT,
   LOO_TOLL_DUR    INT,
   LMT_MOB_DUR    INT,
   LOT_MOB_DUR    INT,
   PMO_MOB_DUR    INT,
   PMO_TOLL_DUR    INT,
   POO_MOB_DUR    INT,
   POO_TOLL_DUR    INT,
   PMT_MOB_DUR    INT,
   PMT_TOLL_DUR    INT,
   POT_MOB_DUR    INT,
   POT_TOLL_DUR    INT,
   GMO_MOB_DUR    INT,
   GMO_TOLL_DUR    INT,
   GOO_MOB_DUR    INT,
   GOO_TOLL_DUR    INT,
   GMT_MOB_DUR    INT,
   GMT_TOLL_DUR    INT,
   GOT_MOB_DUR    INT,
   GOT_TOLL_DUR    INT,
   HAA_MOB_DUR    INT,
   MAA_MOB_DUR    INT,
   TAA_MOB_DUR    INT,
   UAA_MOB_DUR    INT,
   IAA_MOB_DUR    INT,
   M17951_CG_DUR    INT,
   M12593_CG_DUR    INT,
   TIP_CG_DUR    INT,
   UIP_CG_DUR    INT,
   OIP_CG_DUR    INT,
   M17951_CI_DUR    INT,
   M12593_CI_DUR    INT,
   TIP_CI_DUR    INT,
   UIP_CI_DUR    INT,
   OIP_CI_DUR    INT,
   PDD_DUR    INT,
   DDD_DUR    INT,
   IDD_DUR    INT,
   LVO_MOB_DUR    INT,
   LVO_TOLL_DUR    INT,
   LVT_MOB_DUR    INT,
   PVO_MOB_DUR    INT,
   PVO_TOLL_DUR    INT,
   PVT_MOB_DUR    INT,
   PVT_TOLL_DUR    INT,
   HAA_CALL_CNT    INT,
   MAA_CALL_CNT    INT,
   TAA_CALL_CNT    INT,
   IAA_CALL_CNT    INT,
   M1860_CALL_CNT    INT,
   M1861_CALL_CNT    INT,
   M12580_CALL_CNT    INT,
   M138000_CALL_CNT    INT,
   HAA_TOLL_DUR    INT,
   MAA_TOLL_DUR    INT,
   TAA_TOLL_DUR    INT,
   UAA_TOLL_DUR    INT,
   IAA_TOLL_DUR    INT,
   CMCC_BRANCH_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='&&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_VOC_BUSI_DTL_M';

DROP TABLE IF EXISTS JCFW.TW_PERS_4G_USR_TERM_D;
CREATE EXTERNAL TABLE JCFW.TW_PERS_4G_USR_TERM_D (
   STAT_DT    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_BASS_PRDCT_CD    STRING,
   BZ_BASS_PRDCT_CD    STRING,
   ZERO_EXPC_IND    STRING,
   IMEI    STRING,
   A4G_KPI_USR_IND    STRING,
   TERM_BRND_NAM    STRING,
   TERM_DEVICE_NAM    STRING,
   TERM_SALE_KIND    SMALLINT,
   A4G_MIXPKG_USR_IND    STRING,
   A4G_BZ20_USR_IND    STRING,
   A4G_DZ30_USR_IND    STRING,
   USE_USIM_IND    STRING,
   OPEN_4G_FUNC_IND    STRING,
   CHNL_CD    STRING,
   CHNL_TYP_NAM    STRING,
   A4G_NET_USE_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_4G_USR_TERM_D';

DROP TABLE IF EXISTS JCFW.TW_PERS_TOPN_APP_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_TOPN_APP_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   TOP1_APP_CD    STRING,
   TOP1_APP_NAM    STRING,
   TOP1_APP_FLUX    BIGINT,
   TOP2_APP_CD    STRING,
   TOP2_APP_NAM    STRING,
   TOP2_APP_FLUX    BIGINT,
   TOP3_APP_CD    STRING,
   TOP3_APP_NAM    STRING,
   TOP3_APP_FLUX    BIGINT,
   TOP4_APP_CD    STRING,
   TOP4_APP_NAM    STRING,
   TOP4_APP_FLUX    BIGINT,
   TOP5_APP_CD    STRING,
   TOP5_APP_NAM    STRING,
   TOP5_APP_FLUX    BIGINT,
   TOP6_APP_CD    STRING,
   TOP6_APP_NAM    STRING,
   TOP6_APP_FLUX    BIGINT,
   TOP7_APP_CD    STRING,
   TOP7_APP_NAM    STRING,
   TOP7_APP_FLUX    BIGINT,
   TOP8_APP_CD    STRING,
   TOP8_APP_NAM    STRING,
   TOP8_APP_FLUX    BIGINT,
   TOP9_APP_CD    STRING,
   TOP9_APP_NAM    STRING,
   TOP9_APP_FLUX    BIGINT,
   TOP10_APP_CD    STRING,
   TOP10_APP_NAM    STRING,
   TOP10_APP_FLUX    BIGINT,
   TOP11_APP_CD    STRING,
   TOP11_APP_NAM    STRING,
   TOP11_APP_FLUX    BIGINT,
   TOP12_APP_CD    STRING,
   TOP12_APP_NAM    STRING,
   TOP12_APP_FLUX    BIGINT,
   TOP13_APP_CD    STRING,
   TOP13_APP_NAM    STRING,
   TOP13_APP_FLUX    BIGINT,
   TOP14_APP_CD    STRING,
   TOP14_APP_NAM    STRING,
   TOP14_APP_FLUX    BIGINT,
   TOP15_APP_CD    STRING,
   TOP15_APP_NAM    STRING,
   TOP15_APP_FLUX    BIGINT,
   TOP16_APP_CD    STRING,
   TOP16_APP_NAM    STRING,
   TOP16_APP_FLUX    BIGINT,
   TOP17_APP_CD    STRING,
   TOP17_APP_NAM    STRING,
   TOP17_APP_FLUX    BIGINT,
   TOP18_APP_CD    STRING,
   TOP18_APP_NAM    STRING,
   TOP18_APP_FLUX    BIGINT,
   TOP19_APP_CD    STRING,
   TOP19_APP_NAM    STRING,
   TOP19_APP_FLUX    BIGINT,
   TOP20_APP_CD    STRING,
   TOP20_APP_NAM    STRING,
   TOP20_APP_FLUX    BIGINT,
   OTH_APP_FLUX    BIGINT,
   PAY_TOP1_APP_NAM    STRING,
   PAY_TOP1_APP_CNT    BIGINT,
   PAY_TOP2_APP_NAM    STRING,
   PAY_TOP2_APP_CNT    BIGINT,
   PAY_TOP3_APP_NAM    STRING,
   PAY_TOP3_APP_CNT    BIGINT,
   FINANCE_TOP1_APP_NAM    STRING,
   FINANCE_TOP1_APP_CNT    BIGINT,
   FINANCE_TOP2_APP_NAM    STRING,
   FINANCE_TOP2_APP_CNT    BIGINT,
   FINANCE_TOP3_APP_NAM    STRING,
   FINANCE_TOP3_APP_CNT    BIGINT,
   ELEC_SHOP_TOP1_APP_NAM    STRING,
   ELEC_SHOP_TOP1_APP_CNT    BIGINT,
   ELEC_SHOP_TOP2_APP_NAM    STRING,
   ELEC_SHOP_TOP2_APP_CNT    BIGINT,
   ELEC_SHOP_TOP3_APP_NAM    STRING,
   ELEC_SHOP_TOP3_APP_CNT    BIGINT,
   CONSUMER_TOURISM_TOP1_APP_NAM    STRING,
   CONSUMER_TOURISM_TOP1_APP_CNT    BIGINT,
   CONSUMER_TOURISM_TOP2_APP_NAM    STRING,
   CONSUMER_TOURISM_TOP2_APP_CNT    BIGINT,
   CONSUMER_TOURISM_TOP3_APP_NAM    STRING,
   CONSUMER_TOURISM_TOP3_APP_CNT    BIGINT,
   VIDEO_TOP1_APP_NAM    STRING,
   VIDEO_TOP1_APP_CNT    BIGINT,
   VIDEO_TOP2_APP_NAM    STRING,
   VIDEO_TOP2_APP_CNT    BIGINT,
   VIDEO_TOP3_APP_NAM    STRING,
   VIDEO_TOP3_APP_CNT    BIGINT,
   MUSIC_TOP1_APP_NAM    STRING,
   MUSIC_TOP1_APP_CNT    BIGINT,
   MUSIC_TOP2_APP_NAM    STRING,
   MUSIC_TOP2_APP_CNT    BIGINT,
   MUSIC_TOP3_APP_NAM    STRING,
   MUSIC_TOP3_APP_CNT    BIGINT,
   READ_TOP1_APP_NAM    STRING,
   READ_TOP1_APP_CNT    BIGINT,
   READ_TOP2_APP_NAM    STRING,
   READ_TOP2_APP_CNT    BIGINT,
   READ_TOP3_APP_NAM    STRING,
   READ_TOP3_APP_CNT    BIGINT,
   COMIC_TOP1_APP_NAM    STRING,
   COMIC_TOP1_APP_CNT    BIGINT,
   COMIC_TOP2_APP_NAM    STRING,
   COMIC_TOP2_APP_CNT    BIGINT,
   COMIC_TOP3_APP_NAM    STRING,
   COMIC_TOP3_APP_CNT    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_TOPN_APP_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_CUST_YBILL_SPLT_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_CUST_YBILL_SPLT_M (
   EBOX_ID    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   BILL_ACCT_CD    STRING,
   BILL_CYC_CD    INT,
   SPLT_BILL_CYC_CD    INT,
   EBOX_BRND_CD    SMALLINT,
   CMCC_BRANCH_CD    STRING,
   SPLT_REC_FEE    DECIMAL(16,2),
   SPLT_ACT_FEE    DECIMAL(16,2),
   BILL_STS_CD    SMALLINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_CUST_YBILL_SPLT_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_OWE_DTL_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_OWE_DTL_M (
   STAT_MO    INT,
   USR_ID    STRING,
   PAY_EBOX_ID    STRING,
   BILL_ACCT_CD    STRING,
   BILL_CYC_CD    INT,
   USR_TYP_CD    SMALLINT,
   GPAY_TYP_CD    SMALLINT,
   GFEE_TYP_CD    SMALLINT,
   VOC_FEE_IND    STRING,
   USR_NBR    STRING,
   PAY_GROUP_ID    STRING,
   PAY_CUST_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   OWE_FEE    DECIMAL(14,2),
   GUSR_ID    STRING,
   GROUP_ID    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   PRDCT_FEE    DECIMAL(14,2),
   MBR_FEE    DECIMAL(14,2),
   PRDCT_TAX_RT    DECIMAL(10,4),
   TAXED_OWE_FEE    DECIMAL(20,8),
   TAXED_PRDCT_FEE    DECIMAL(20,8),
   TAXED_MBR_FEE    DECIMAL(20,8)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_OWE_DTL_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_PRDCT_OWE_DTL_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_PRDCT_OWE_DTL_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   GUSR_ID    STRING,
   GROUP_ID    STRING,
   BILL_CYC_CD    INT,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   PRDCT_FEE    DECIMAL(14,2),
   MBR_FEE    DECIMAL(14,2),
   GPAY_MBR_FEE    DECIMAL(14,2),
   CI_PRDCT_FEE    DECIMAL(14,2),
   CI_MBR_FEE    DECIMAL(14,2),
   TAXED_PRDCT_FEE    DECIMAL(20,8),
   TAXED_MBR_FEE    DECIMAL(20,8),
   TAXED_GPAY_MBR_FEE    DECIMAL(20,8),
   TAXED_CI_PRDCT_FEE    DECIMAL(20,8),
   TAXED_CI_MBR_FEE    DECIMAL(20,8)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_PRDCT_OWE_DTL_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_BILL_BBOSS_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_BILL_BBOSS_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   BBOSS_GUSR_ID    STRING,
   BBOSS_PRDCT_CD    STRING,
   BBOSS_GCUST_ID    STRING,
   BBOSS_ACCT_CD    STRING,
   DATA_TYP_CD    SMALLINT,
   UUSE_TAG    STRING,
   SUB_PRDCT_CD    STRING,
   MBR_PROV_CD    STRING,
   MBR_CMCC_BRANCH_CD    STRING,
   GUSR_ID    STRING,
   CORP_PRDCT_NBR    STRING,
   GROUP_ID    STRING,
   BASS_PRDCT_CD    STRING,
   CORP_PRDCT_CODE    STRING,
   YJ_PRD_CODE    STRING,
   SGN_TYP_CD    SMALLINT,
   SGN_HST_CD    STRING,
   BUS_MDE_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   REC_FEE    DECIMAL(16,4),
   PRDCT_TAX_RT    DECIMAL(10,4),
   TAXED_REC_FEE    DECIMAL(20,8)
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_BILL_BBOSS_M';

DROP TABLE IF EXISTS JCFW.TW_PRDCT_RES_USE_M;
CREATE EXTERNAL TABLE JCFW.TW_PRDCT_RES_USE_M (
   USR_ID    STRING,
   BASS_PRDCT_CD    STRING,
   PKG_FLUX    BIGINT,
   USE_PKG_FLUX    BIGINT,
   PKG_DUR    BIGINT,
   USE_PKG_DUR    BIGINT,
   SMMS_CNT    BIGINT,
   USE_SMMS_CNT    BIGINT,
   WLAN_DUR    BIGINT,
   USE_WLAN_DUR    BIGINT,
   JZ_FLUX    BIGINT,
   USE_JZ_FLUX    BIGINT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='\001','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PRDCT_RES_USE_M';

DROP TABLE IF EXISTS JCFW.TM_BASE_BILL_M;
CREATE EXTERNAL TABLE JCFW.TM_BASE_BILL_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ITEM_CD    STRING,
   ITEM_VALUE    DECIMAL(26,6)
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_BASE_BILL_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_PERS_FAVORITE_CHNL_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_FAVORITE_CHNL_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   CMCC_BRANCH_CD    STRING,
   CM_CHNL1_CD    STRING,
   CM_CHNL1_CNT    INT,
   CM_CHNL2_CD    STRING,
   CM_CHNL2_CNT    INT,
   CM_CHNL3_CD    STRING,
   CM_CHNL3_CNT    INT,
   BM_CHNL1_CD    STRING,
   BM_CHNL1_CNT    INT,
   BM_CHNL2_CD    STRING,
   BM_CHNL2_CNT    INT,
   BM_CHNL3_CD    STRING,
   BM_CHNL3_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_FAVORITE_CHNL_M';

DROP TABLE IF EXISTS JCFW.TM_FREE_CHNL_OTH_M;
CREATE EXTERNAL TABLE JCFW.TM_FREE_CHNL_OTH_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   FREE_DIM_CD1    STRING,
   ITEM_CD    STRING,
   ITEM_VALUE1    DECIMAL(26,6),
   ITEM_VALUE2    DECIMAL(26,6),
   APPLY_IND    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='&','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_FREE_CHNL_OTH_M';

DROP TABLE IF EXISTS JCFW.TW_CUST_VALUE_MINING_M;
CREATE EXTERNAL TABLE JCFW.TW_CUST_VALUE_MINING_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   USR_ID    STRING,
   CUST_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   OWE_CHNL_CD    STRING,
   START_DT    INT,
   NET_TYP    STRING,
   PAY_TYP_CD    STRING,
   INNET_MO_CNT    SMALLINT,
   OWE_STOP_IND    STRING,
   FORCE_STOP_IND    STRING,
   HIGH_STOP_IND    STRING,
   APPLY_STOP_IND    STRING,
   LOST_STOP_IND    STRING,
   EFF_STOP_IND    STRING,
   MOB_USE_TYP_CD    STRING,
   USR_STS_CD    STRING,
   VIP_LVL_CD    SMALLINT,
   USR_STS_DT    INT,
   USR_STS_TIM    STRING,
   VIP_CHG_DT    INT,
   USR_OUTNET_DT    INT,
   CUST_CHG_DT    INT,
   PREOUTNET_STOP_DT    INT,
   INNET_USR_IND    STRING,
   QUALIFYRSN_CD    SMALLINT,
   VPMN_USR_IND    STRING,
   PKG_CD    SMALLINT,
   PKG_DTL_CD    INT,
   MON_NEW_USR_IND    STRING,
   IMEI    STRING,
   IMSI    STRING,
   SIM_CD    STRING,
   ORDER_BRND_CD    SMALLINT,
   ORDER_PKG_CD    SMALLINT,
   ORDER_PKG_DTL_CD    INT,
   N_BASS_PRDCT_CD    STRING,
   ORDER_BASS_PRDCT_CD    STRING,
   SETL_DT    INT,
   START_TIM    STRING,
   REG_DT    INT,
   DBL_STOP_CNT    INT,
   SBL_STOP_CNT    INT,
   DBL_STOP_DAYCNT    INT,
   SBL_STOP_DAYCNT    INT,
   N_BASS_PRDCT_EFF_DT    INT,
   N_BASS_PRDCT_END_DT    INT,
   ORDER_BASS_PRDCT_EFF_DT    INT,
   ORDER_BASS_PRDCT_END_DT    INT,
   A4G_USR_IN    STRING,
   COMMON_IMEI    STRING,
   TERM_TYP_CD    SMALLINT,
   A4G_BRND_PRDCT_CD    STRING,
   A4G_PRDCT_CD    STRING,
   LTE_4G_TERM_IND    SMALLINT,
   LTE_4G_NET_IND    SMALLINT,
   USE_USIM_IND    STRING,
   OPEN_4G_FUNC_IND    STRING,
   A4G_PKG_USR_IND    STRING,
   A4G_POTENTIAL_USR_IND    STRING,
   A4G_PHONE_PKG_USR_IND    STRING,
   A4G_KPI_USR_IND    STRING,
   A4G_MNEW_PKG_USR_IND    STRING,
   TERM_KIND    SMALLINT,
   EFF_DT    INT,
   ORDR_N_USR_IND    STRING,
   ORDR_N_BASS_PRDCT_CD    STRING,
   ORDR_N_NEW_CHNL_CD    STRING,
   USIM_CHNL_CD    STRING,
   TOT_FEE    DECIMAL(10,2),
   TOT_COST    DECIMAL(20,12),
   DEBET_MOB_DUR    INT,
   ORDR_PKG_CNT    INT,
   GCUST_IND    STRING,
   INTELL_USR_IND    STRING,
   INNET_CHNL_CD    STRING,
   CUST_IND    STRING,
   CUST_ATTR_CD    STRING,
   AREA_TYP_CD    STRING,
   AGE_LAYER_CD    STRING,
   NET_TYP_CD    STRING,
   TERM_SUBSY_IND    STRING,
   DIS_SUBSY_IND    STRING,
   EQ_SUBSY_IND    STRING,
   ENTITY_SUBSY_IND    STRING,
   CNTY    STRING,
   PKG_DTL_NAM    STRING,
   USR_LVL_CD    SMALLINT,
   ORG_FEE    DECIMAL(20,12),
   AD_FEE    DECIMAL(20,12),
   BUSI_PRGD_FEE    DECIMAL(20,12),
   EXT_FEE    DECIMAL(20,12),
   BASE_SRV_FEE    DECIMAL(20,12),
   VALUE_ADDED_FEE    DECIMAL(20,12),
   OTHR_CUST_SRV_FEE    DECIMAL(20,12),
   GFT_TERM_FEE    DECIMAL(12,2),
   DIV_TERM_FEE    DECIMAL(12,2),
   OTHR_ENTITY_FEE    DECIMAL(20,12),
   SIM_CARD_COST    DECIMAL(20,12),
   SELL_TERM_COST    DECIMAL(12,2),
   BILL_FEE    DECIMAL(10,2),
   TERM_SELL_FEE    DECIMAL(12,2),
   INNER_AOASETL_FEE    DECIMAL(20,12),
   SIM_CAR_FEE    DECIMAL(10,2),
   CUST_INC    DECIMAL(10,2),
   DL100_IND    STRING,
   CORP_MEMBER_ATR    STRING,
   DTGRP_AB_CD    STRING,
   PRVCGRP_TYP_CD    SMALLINT,
   PRDCT_MBR_IND    STRING,
   AB_MBR_IND    STRING,
   NEW_MBR_IND    STRING,
   IOT_MBR_IND    STRING,
   VPMN_MBR_IND    STRING,
   SHORT_MBR_IND    STRING,
   CRING_MBR_IND    STRING,
   CALL_VPN_IND    STRING,
   CALL_VPMN_IND    STRING,
   CALL_CVPMN_IND    STRING,
   CALL_HOME_IND    STRING,
   INF_PM_IND    STRING,
   INF_BB_IND    STRING,
   INF_ECARD_IND    STRING,
   INF_GPRS_IND    STRING,
   VFELLOW_IND    STRING,
   USR_ACT2_IND    STRING,
   USR_ACT_IND    STRING,
   VUSR_ACT2_IND    STRING,
   VUSR_ACT_IND    STRING,
   HC_MBR_IND    STRING,
   DL01_MBR_IND    STRING,
   DL02_MBR_IND    STRING,
   DL03_MBR_IND    STRING,
   GT_MBR_IND    STRING,
   GC_MBR_IND    STRING,
   GB_MBR_IND    STRING,
   MACH_IND    STRING,
   MAIL_APN_IND    STRING,
   TD_USR_IND    STRING,
   LTE_USR_IND    STRING,
   MIFI_USR_IND    STRING,
   INDAPPLY_XXT_IND    STRING,
   INDAPPLY_YXT_IND    STRING,
   INDAPPLY_NXT_IND    STRING,
   CRM_MBR_IND    STRING,
   KEY_MBR_IND    STRING,
   CNCT_MBR_IND    STRING,
   MH_CUST_IND    STRING,
   VIP_CUST_IND    STRING,
   HIGH_WARN_IND    STRING,
   MARK_YCZS_IND    STRING,
   MARK_CNXF_IND    STRING,
   MARK_YXSX_IND    STRING,
   MARK_ZDYH_IND    STRING,
   SERV_DF_IND    STRING,
   SERV_DG_IND    STRING,
   SERV_YE_IND    STRING,
   MARK_BIND_IND    STRING,
   FINC_BIND_IND    STRING,
   SRVC_BIND_IND    STRING,
   BILL_NYE_IND    STRING,
   BIND_IND    STRING,
   BIND_END_DT    INT,
   MIN_CON_FEE    DECIMAL(14,2),
   NEFF_ACCT_AMT    DECIMAL(14,2),
   AVG_FEE    DECIMAL(14,2),
   GROUP_ID    STRING,
   GROUP_NAM    STRING,
   CORP_GPFLUX_IND    STRING,
   BASE_ACCT_AMT    DECIMAL(16,2),
   GIFT_ACCT_AMT    DECIMAL(16,2),
   AVL_TOT_ACCT_AMT    DECIMAL(16,2),
   PRE_NEFF_ACCT_AMT    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT    DECIMAL(16,2),
   TOT_ACCT_AMT    DECIMAL(16,2),
   MO_RTN_AMT    DECIMAL(16,2),
   MO_GIFT_AMT    DECIMAL(16,2),
   OSS_NAM    STRING,
   NEFF_GIFT_BAL_MAX_RTN_DT    INT,
   NEFF_BASE_BAL_MAX_RTN_DT    INT,
   BASE_NEFF_ACCT_AMT1    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT2    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT3    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT4    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT5    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT6    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT7    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT8    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT9    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT10    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT11    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT12    DECIMAL(16,2),
   BASE_NEFF_ACCT_AMT_UP12    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT1    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT2    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT3    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT4    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT5    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT6    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT7    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT8    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT9    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT10    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT11    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT12    DECIMAL(16,2),
   GIFT_NEFF_ACCT_AMT_UP12    DECIMAL(16,2),
   BASE_CASH_ACCT_AMT    DECIMAL(16,2),
   BASE_CARD_ACCT_AMT    DECIMAL(16,2),
   BASE_PRINCIPAL_ACCT_AMT    DECIMAL(16,2),
   BASE_OFFSET_ACCT_AMT    DECIMAL(16,2),
   BASE_BOND_ACCT_AMT    DECIMAL(16,2),
   GIFT_GENERAL_ACCT_AMT    DECIMAL(16,2),
   GIFT_NB_ACCT_AMT    DECIMAL(16,2),
   GIFT_LABOR_ACCT_AMT    DECIMAL(16,2),
   IN_CASH_AMT    DECIMAL(16,2),
   IN_RESERVE_AMT    DECIMAL(16,2),
   IN_CARD_AMT    DECIMAL(16,2),
   IN_DISCOUNT_AMT    DECIMAL(16,2),
   IN_REDUCE_AMT    DECIMAL(16,2),
   IN_ASSURE_AMT    DECIMAL(16,2),
   IN_PRESENT_AMT    DECIMAL(16,2),
   IN_OTH_AMT    DECIMAL(16,2),
   CASH_AMT    DECIMAL(16,2),
   RESERVE_AMT    DECIMAL(16,2),
   CARD_AMT    DECIMAL(16,2),
   DISCOUNT_AMT    DECIMAL(16,2),
   REDUCE_AMT    DECIMAL(16,2),
   ASSURE_AMT    DECIMAL(16,2),
   PRESENT_AMT    DECIMAL(16,2),
   OTH_AMT    DECIMAL(16,2),
   ACCOUNT_AMT    DECIMAL(16,2),
   VOC_CDR_FEE    DECIMAL(10,2),
   NORM_VOC_CDR_FEE    DECIMAL(10,2),
   ACTVCALL_FEE    DECIMAL(10,2),
   FWD_ACTVCALL_FEE    DECIMAL(10,2),
   ACTV_CALL_NFWD_FEE    DECIMAL(10,2),
   BYCALL_FEE    DECIMAL(10,2),
   FWD_BYCALL_FEE    DECIMAL(10,2),
   BYCALL_NFWD_FEE    DECIMAL(10,2),
   INNER_CALL_FEE    DECIMAL(10,2),
   EXTNL_CALL_FEE    DECIMAL(10,2),
   CITY_CALL_FEE    DECIMAL(10,2),
   PROV_TOLL_FEE    DECIMAL(10,2),
   CNTRY_TOLL_FEE    DECIMAL(10,2),
   HMT_TOLL_FEE    DECIMAL(10,2),
   INTNTL_TOLL_FEE    DECIMAL(10,2),
   LCL_TOLL_FEE    DECIMAL(10,2),
   PROV_ROAM_FEE    DECIMAL(10,2),
   OUTPROV_ROAM_FEE    DECIMAL(10,2),
   HMT_ROAM_FEE    DECIMAL(10,2),
   INTNTL_ROAM_FEE    DECIMAL(10,2),
   DEBET_DUR    INT,
   ACTVCALL_DUR    INT,
   FWD_ACTVCALL_DUR    INT,
   ACTV_CALL_NFWD_DUR    INT,
   BYCALL_DUR    INT,
   FWD_BYCALL_DUR    INT,
   BYCALL_NFWD_DUR    INT,
   INNER_DEBET_DUR    INT,
   EXTNL_DEBET_DUR    INT,
   UNICOM_DEBET_DUR    INT,
   TELCOM_DEBET_DUR    INT,
   OTHR_DEBET_DUR    INT,
   CITY_CALL_DUR    INT,
   PROV_TOLL_DUR    INT,
   CNTRY_TOLL_DUR    INT,
   HMT_TOLL_DUR    INT,
   INTNTL_TOLL_DUR    INT,
   LCL_TOLL_DUR    INT,
   PROV_ROAM_DUR    INT,
   OUTPROV_ROAM_DUR    INT,
   HMT_ROAM_DUR    INT,
   INTNTL_ROAM_DUR    INT,
   INVNET_DEBET_DUR    INT,
   OUTVNET_DEBET_DUR    INT,
   CALL_CNT    INT,
   ACTV_CALL_CNT    INT,
   ACTV_CALL_NFWD_CNT    INT,
   BYCALL_CNT    INT,
   FWD_BYCALL_CNT    INT,
   BYCALL_NFWD_CNT    INT,
   INNER_CALL_CNT    INT,
   EXTNL_CALL_CNT    INT,
   UNICOM_CALL_CNT    INT,
   TELCOM_CALL_CNT    INT,
   OTHR_CALL_CNT    INT,
   CITY_CALL_CNT    INT,
   PROV_TOLL_CNT    INT,
   CNTRY_TOLL_CNT    INT,
   HMT_TOLL_CNT    INT,
   INTNTL_TOLL_CNT    INT,
   LCL_TOLL_CNT    INT,
   PROV_ROAM_CNT    INT,
   OUTPROV_ROAM_CNT    INT,
   HMT_ROAM_CNT    INT,
   INTNTL_ROAM_CNT    INT,
   INVNET_CALL_CNT    INT,
   OUTVNET_CALL_CNT    INT,
   FWD_CMPT_CNT    INT,
   IN_LOCAL_ACT_DUR    INT,
   IN_PRVC_ACT_DUR    INT,
   IN_NAT_ACT_DUR    INT,
   IN_NAT_PSV_DUR    INT,
   OUT_LL_ACT_DUR    INT,
   OUT_LO_ACT_DUR    INT,
   OUT_PRVC_ACT_DUR    INT,
   OUT_NAT_ACT_DUR    INT,
   OUT_NAT_PSV_DUR    INT,
   OUT_HKWZ_ACT_DUR    INT,
   OUT_HKWZ_PSV_DUR    INT,
   PRVC_PSV_DUR    INT,
   LRVC_PSV_DUR    INT,
   LOCAL_ACT_SPECNBR_DUR    INT,
   PRVC_ACT_SPECNBR_DUR    INT,
   NAT_ACT_SPECNBR_DUR    INT,
   NAT_PSV_SPECNBR_DUR    INT,
   IN_LL_ACT_DUR    INT,
   IN_LL_PSV_DUR    INT,
   OUT_LL_PSV_DUR    INT,
   IN_LO_ACT_DUR    INT,
   IN_LO_PSV_DUR    INT,
   OUT_LO_PSV_DUR    INT,
   IN_PRVC_PSV_DUR    INT,
   OUT_PRVC_PSV_DUR    INT,
   OUT_LL_ACT_FEE    DECIMAL(10,2),
   OUT_LL_PSV_FEE    DECIMAL(10,2),
   OUT_LO_ACT_FEE    DECIMAL(10,2),
   OUT_LO_PSV_FEE    DECIMAL(10,2),
   OUT_PRVC_ACT_FEE    DECIMAL(10,2),
   OUT_PRVC_PSV_FEE    DECIMAL(10,2),
   OUT_NAT_ACT_FEE    DECIMAL(10,2),
   OUT_NAT_PSV_FEE    DECIMAL(10,2),
   GSM_ACTV_MOB_DUR    INT,
   GSM_BYCALL_MOB_DUR    INT,
   T_ACTV_MOB_DUR    INT,
   T_BYCALL_MOB_DUR    INT,
   INVNET_CALL_FEE    DECIMAL(14,2),
   INVNET_LCL_DUR    INT,
   INVNET_PRVC_DUR    INT,
   INVNET_ACTCALL_DUR    INT,
   INVNET_ACTCALL_CNT    INT,
   INTNTL_DAY_CNT    INT,
   CNTRY_DAY_CNT    INT,
   GPRS_ACTV_USR_IND    STRING,
   GPRS_NEW_USR_IND    STRING,
   GPRS_USE_USR_IND    STRING,
   GPRS_PAY_USR_IND    STRING,
   GPRS_UP_FLUX    BIGINT,
   GPRS_DOWN_FLUX    BIGINT,
   GPRS_TD_FLUX    BIGINT,
   TDLTE_GPRS_FLUX    BIGINT,
   GPRS_NTD_FLUX    BIGINT,
   LOC_FLUX    BIGINT,
   IPRVC_FLUX    BIGINT,
   OPRVC_FLUX    BIGINT,
   NON_OVERRUN_FLUX    BIGINT,
   OVERRUN_FLUX    BIGINT,
   GPRS_PKG_FEE    DECIMAL(14,2),
   GPRS_FEE    DECIMAL(14,2),
   GPRS_FLUX    BIGINT,
   GPRS_MO_PKG_FEE    DECIMAL(14,2),
   GPRS_MOB_FEE    DECIMAL(14,2),
   OUTPRVC_ROAM_FLUX    BIGINT,
   OUTPRVC_ROAM_T_FLUX    BIGINT,
   OVERRUN_FLUX_FEE    DECIMAL(14,2),
   FLUX_BHD    DECIMAL(20,6),
   MIX_PKG_IN_FLUX    BIGINT,
   STD_PKG_IN_FLUX    BIGINT,
   SWYH_PKG_IN_FLUX    BIGINT,
   SWYH_STDPKG_IN_FLUX    BIGINT,
   PLUSPKG_IN_FLUX    BIGINT,
   OTH_PKG_IN_FLUX    BIGINT,
   MAIN_PKG_IN_FLUX    BIGINT,
   EFF_STD_PKG_CD    STRING,
   ORDR_STD_PKG_CD    STRING,
   INTNTL_ROAM_GPRS_USR_IND    STRING,
   INTNTL_ROAM_GPRS_FLUX    BIGINT,
   INTNTL_ROAM_GPRS_FEE    DECIMAL(14,2),
   EFF_IDLE_PKG_CD    STRING,
   GPRS_CALL_CNT    INT,
   GPRS_DAY_CNT    INT,
   TDLTE_GPRS_DAY_CNT    INT,
   REDU_MH_CUST_IND    STRING,
   REAL_NAME_DEC    STRING,
   UPDT_DT    INT,
   REAL_NAME_CD    STRING,
   GDR_TYP_CD    SMALLINT,
   AGE_CNT    INT,
   ZODIAC_NAM    STRING,
   ID_HOME_PROV    STRING,
   ID_HOME_CITY    STRING,
   LB_FEE    DECIMAL(10,2),
   LB_DDD    DECIMAL(10,2),
   LB_IDD    DECIMAL(10,2),
   PB_FEE    DECIMAL(10,2),
   PB_DDD    DECIMAL(10,2),
   PB_IDD    DECIMAL(10,2),
   GB_FEE    DECIMAL(10,2),
   GB_DDD    DECIMAL(10,2),
   GB_IDD    DECIMAL(10,2),
   M_IP_FEE    DECIMAL(10,2),
   M_IP_DDD    DECIMAL(10,2),
   M_IP_IDD    DECIMAL(10,2),
   IB_FEE    DECIMAL(10,2),
   T_IP_FEE    DECIMAL(10,2),
   N_IP_FEE    DECIMAL(10,2),
   MW_SMS_FEE    DECIMAL(10,2),
   LB_GPRS_FEE    DECIMAL(10,2),
   ZJFF_FEE    DECIMAL(10,2),
   BJFF_FEE    DECIMAL(10,2),
   SMS_FEE    DECIMAL(10,2),
   MMS_FEE    DECIMAL(10,2),
   WAP_FEE    DECIMAL(10,2),
   WLAN_FEE    DECIMAL(10,2),
   LBT_TEL_FEE    DECIMAL(10,2),
   IPZT_FEE    DECIMAL(10,2),
   IPZT_DDD    DECIMAL(10,2),
   IPZT_IDD    DECIMAL(10,2),
   IB_GPRS_FEE    DECIMAL(10,2),
   OTH_TEL_FEE    DECIMAL(10,2),
   BASE_MONTH_FEE    DECIMAL(10,2),
   TAOCAN_MONTH_FEE    DECIMAL(10,2),
   VPMN_MONTH_FEE    DECIMAL(10,2),
   BYCALL_MONTH_FEE    DECIMAL(10,2),
   SMS_MONTH_FEE    DECIMAL(10,2),
   G_CALL_MONTH_FEE    DECIMAL(10,2),
   GPRS_MONTH_FEE    DECIMAL(10,2),
   MW_MONTH_FEE    DECIMAL(10,2),
   DVOICE_GPS_FEE    DECIMAL(10,2),
   CORP_SMS_FEE    DECIMAL(10,2),
   IDLE_MONTH_FEE    DECIMAL(10,2),
   LBT_MONTH_FEE    DECIMAL(10,2),
   SUB_NBR_FEE    DECIMAL(10,2),
   SVOICE_GPS_FEE    DECIMAL(10,2),
   NVOICE_GPS_FEE    DECIMAL(10,2),
   WIRELESS_POS_FEE    DECIMAL(10,2),
   LINE_MONTH_FEE    DECIMAL(10,2),
   IP_ADDR_FEE    DECIMAL(10,2),
   IP_VPN_FEE    DECIMAL(10,2),
   NET_USE_FEE    DECIMAL(10,2),
   OTH_MONTH_FEE    DECIMAL(10,2),
   NEW_FUNC_FEE    DECIMAL(10,2),
   ICP_INFO_FEE    DECIMAL(10,2),
   GPRS_INFO_FEE    DECIMAL(10,2),
   WAP_INFO_FEE    DECIMAL(10,2),
   LBT_INFO_FEE    DECIMAL(10,2),
   OTH_INFO_FEE    DECIMAL(10,2),
   DOFOR_FEE    DECIMAL(10,2),
   OTH_FEE    DECIMAL(10,2),
   BREACH_FEE    DECIMAL(10,2),
   MEND_FEE    DECIMAL(10,2),
   DISCOUNT_FEE    DECIMAL(10,2),
   REDUCE_FEE    DECIMAL(10,2),
   MO_AMT_FEE    DECIMAL(10,2),
   DT_AVG_FEE    DECIMAL(10,2),
   MMS_PKG_FEE    DECIMAL(10,2),
   M12593_MONTH_FEE    DECIMAL(10,2),
   MONFIX_FEE    DECIMAL(16,2),
   MONFIX2_FEE    DECIMAL(10,2),
   G3NB_TAOCAN_FEE    DECIMAL(10,2),
   G3NB_OUT_TAOCAN_FEE    DECIMAL(10,2),
   STAR_USR_IND    STRING,
   ARPU    DECIMAL(14,2),
   CONTR_BIND_CNT    INT,
   BIND_PAY_IND    STRING,
   TERM_CONTR_BIND_IND    STRING,
   BUSI_CONTR_BIND_IND    STRING,
   CORP_DG_IND    STRING,
   T_DBL_STOP_CNT    INT,
   L1_DBL_STOP_CNT    INT,
   L2_DBL_STOP_CNT    INT,
   L3_DBL_STOP_CNT    INT,
   CNSUMMIN_WILLEXCE30_IND    STRING,
   TOP1_INDATE    INT,
   TOP1_LACI_NAME    STRING,
   TOP1_LACI    STRING,
   TOP1_TYPE    STRING,
   TOP2_INDATE    INT,
   TOP2_LACI_NAME    STRING,
   TOP2_LACI    STRING,
   TOP2_TYPE    STRING,
   TOP3_INDATE    INT,
   TOP3_LACI_NAME    STRING,
   TOP3_LACI    STRING,
   TOP3_TYPE    STRING,
   WK_CELL_CD    STRING,
   WK_CELL_NAM    STRING,
   WK_P_LATITUDE    STRING,
   WK_P_LONGITUDE    STRING,
   RST_CELL_CD    STRING,
   RST_CELL_NAM    STRING,
   RST_P_LATITUDE    STRING,
   RST_P_LONGITUDE    STRING,
   RST_TOP1_LACI    STRING,
   RST_TOP2_LACI    STRING,
   RST_TOP3_LACI    STRING
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CUST_VALUE_MINING_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_AIR_TRAVEL_STBY_VOC_M;
CREATE EXTERNAL TABLE JCFW.TM_AIR_TRAVEL_STBY_VOC_M (
   DATA_DT    INT,
   CITY_ID    STRING,
   DIST_NAME    STRING,
   SEX_LAB    STRING,
   AGE_LAB    STRING,
   ARPU_LAB    STRING,
   DEPOINT_TIME    STRING,
   DEPART_CITY    STRING,
   ARRIVAL_CITY    STRING,
   USR_CNT    INT,
   TRIP_MODE    INT,
   TRIP_TYP_CD    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_AIR_TRAVEL_STBY_VOC_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_AIR_TRAVEL_STBY_FLUX_M;
CREATE EXTERNAL TABLE JCFW.TM_AIR_TRAVEL_STBY_FLUX_M (
   DATA_DT    INT,
   CITY_ID    STRING,
   DIST_NAME    STRING,
   SEX_LAB    STRING,
   AGE_LAB    STRING,
   ARPU_LAB    STRING,
   DEPOINT_TIME    STRING,
   DEPART_CITY    STRING,
   ARRIVAL_CITY    STRING,
   USR_CNT    INT,
   TRIP_MODE    INT,
   TRIP_TYP_CD    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_AIR_TRAVEL_STBY_FLUX_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_NONAERO_TRANSPOR_STBY_VOC_M;
CREATE EXTERNAL TABLE JCFW.TM_NONAERO_TRANSPOR_STBY_VOC_M (
   DATA_DT    INT,
   CITY_ID    STRING,
   DIST_NAM    STRING,
   TRIP_MODE    INT,
   DEPART_CITY    STRING,
   ARRIVAL_CITY    STRING,
   USR_CNT    INT,
   TRIP_TYP_CD    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_NONAERO_TRANSPOR_STBY_VOC_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_NONAERO_TRANSPOR_STBY_FLUX_M;
CREATE EXTERNAL TABLE JCFW.TM_NONAERO_TRANSPOR_STBY_FLUX_M (
   DATA_DT    INT,
   CITY_ID    STRING,
   DIST_NAM    STRING,
   TRIP_MODE    INT,
   DEPART_CITY    STRING,
   ARRIVAL_CITY    STRING,
   USR_CNT    INT,
   TRIP_TYP_CD    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_NONAERO_TRANSPOR_STBY_FLUX_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_DESTINA_STAY_STBY_VOC_M;
CREATE EXTERNAL TABLE JCFW.TM_DESTINA_STAY_STBY_VOC_M (
   DATA_DT    INT,
   ARRIVAL_CITY    STRING,
   STAY_DUR    STRING,
   USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_DESTINA_STAY_STBY_VOC_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_DESTINA_STAY_STBY_FLUX_M;
CREATE EXTERNAL TABLE JCFW.TM_DESTINA_STAY_STBY_FLUX_M (
   DATA_DT    INT,
   ARRIVAL_CITY    STRING,
   STAY_DUR    STRING,
   USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_DESTINA_STAY_STBY_FLUX_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_DIVERTED_STAY_STBY_VOC_M;
CREATE EXTERNAL TABLE JCFW.TM_DIVERTED_STAY_STBY_VOC_M (
   DATA_DT    INT,
   DEPARTURE_CITY    STRING,
   STAY_DUR    STRING,
   USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_DIVERTED_STAY_STBY_VOC_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_DIVERTED_STAY_STBY_FLUX_M;
CREATE EXTERNAL TABLE JCFW.TM_DIVERTED_STAY_STBY_FLUX_M (
   DATA_DT    INT,
   DEPARTURE_CITY    STRING,
   STAY_DUR    STRING,
   USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_DIVERTED_STAY_STBY_FLUX_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_AIRLINE_PREFER_M;
CREATE EXTERNAL TABLE JCFW.TM_AIRLINE_PREFER_M (
   DATA_DT    INT,
   DEPART_CITY    STRING,
   ARRIVAL_CITY    STRING,
   AIR_COMPANY    STRING,
   USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_AIRLINE_PREFER_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_FLIGHT_PREFER_M;
CREATE EXTERNAL TABLE JCFW.TM_FLIGHT_PREFER_M (
   DATA_DT    INT,
   DEPART_CITY    STRING,
   ARRIVAL_CITY    STRING,
   FLIGHT_NO    STRING,
   USR_CNT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_FLIGHT_PREFER_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TM_CHNL_MNTR_KPI_M;
CREATE EXTERNAL TABLE JCFW.TM_CHNL_MNTR_KPI_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   DIST_ID    STRING,
   MICRODIST_ID    STRING,
   BUSI_USR_NBR    STRING,
   CHNL_STAR_LVL3_IND    STRING,
   CHNL_CD    STRING,
   CHNL_STS_CD    STRING,
   ITEM_CD    STRING,
   ITEM_VALUE    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_CHNL_MNTR_KPI_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_CORP_ECPN_CHRG_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_ECPN_CHRG_M (
   EBOX_CHG_LOG_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   EBOX_ID    STRING,
   EBOX_UNIT_CD    STRING,
   ECPN_TYP_CD    STRING,
   USR_NBR    STRING,
   GROUP_ID    STRING,
   CORP_PRDCT_NBR    STRING,
   CHRG_AMT    DECIMAL(14,2),
   EBOX_CHG_RSN_CD    STRING,
   LVL2_CHG_RSN    STRING,
   CHG_DT    INT,
   CHG_TIM    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_ECPN_CHRG_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_ECPN_WOFF_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_ECPN_WOFF_M (
   EBOX_CHG_LOG_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   EBOX_ID    STRING,
   EBOX_UNIT_CD    STRING,
   ECPN_TYP_CD    STRING,
   USR_NBR    STRING,
   GROUP_ID    STRING,
   CORP_PRDCT_NBR    STRING,
   WOFF_AMT    DECIMAL(14,2),
   EBOX_CHG_RSN_CD    STRING,
   LVL2_CHG_RSN    STRING,
   CHG_DT    INT,
   CHG_TIM    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_ECPN_WOFF_M';

DROP TABLE IF EXISTS JCFW.TW_CORP_ECPN_BAL_M;
CREATE EXTERNAL TABLE JCFW.TW_CORP_ECPN_BAL_M (
   EBOX_CHG_LOG_ID    STRING,
   CMCC_BRANCH_CD    STRING,
   EBOX_ID    STRING,
   EBOX_UNIT_CD    STRING,
   ECPN_TYP_CD    STRING,
   USR_NBR    STRING,
   GROUP_ID    STRING,
   CORP_PRDCT_NBR    STRING,
   BAL_AMT    DECIMAL(14,2),
   EBOX_CHG_RSN_CD    STRING,
   LVL2_CHG_RSN    STRING,
   CHG_DT    INT,
   CHG_TIM    STRING
)
PARTITIONED BY (branch STRING,month INT)
ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.MultiDelimitSerDe'
WITH SERDEPROPERTIES ('field.delim'='@#$','serialization.null.format' ='NVL','serialization.encoding' ='GBK')
STORED AS TEXTFILE
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_CORP_ECPN_BAL_M';

DROP TABLE IF EXISTS JCFW.TM_OTH_M;
CREATE EXTERNAL TABLE JCFW.TM_OTH_M (
   STAT_MO    INT,
   CMCC_BRANCH_CD    STRING,
   BRND_CD    SMALLINT,
   ITEM_CD    STRING,
   ITEM_VALUE    DECIMAL(26,6)
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/DM/TM_OTH_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_PERS_USR_RESIDENCE_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_USR_RESIDENCE_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   IMSI    STRING,
   IMEI    STRING,
   INDATE_CNT    BIGINT,
   INDATE_DAYCNT    INT,
   ROAM_TYPE    STRING,
   CNTRY_CD    STRING,
   PROV_CD    STRING,
   CITY_CD    STRING,
   DT_FIRST_DT    INT,
   DT_LAST_DT    INT
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_USR_RESIDENCE_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');

DROP TABLE IF EXISTS JCFW.TW_PERS_LAB2_USR_M;
CREATE EXTERNAL TABLE JCFW.TW_PERS_LAB2_USR_M (
   STAT_MO    INT,
   USR_NBR    STRING,
   LAB_CD    STRING,
   CMCC_BRANCH_CD    STRING,
   LAB_SRC_CD    STRING
)
PARTITIONED BY (branch STRING,month INT)
STORED AS PARQUET
LOCATION '/tenant/BIGDATA/JCFW/BZMX/MON/EDS/TW_PERS_LAB2_USR_M'
TBLPROPERTIES ('serialization.null.format' ='NVL','serialization.encoding' ='GBK');


